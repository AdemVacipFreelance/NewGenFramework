æ
HE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\App_Start\FilterConfig.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	App_Start %
{ 
public 
class	 
FilterConfig 
{ 
public 

static 
void !
RegisterGlobalFilters ,
(, -"
GlobalFilterCollection- C
filtersD K
)K L
{ 
filters		 
.		 
Add		 
(		 
new		  
HandleErrorAttribute		 *
(		* +
)		+ ,
)		, -
;		- .
} 
} 
} ˆ
GE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\App_Start\RouteConfig.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
{		 
public

 

class

 
RouteConfig

 
{ 
public 
static 
void 
RegisterRoutes )
() *
RouteCollection* 9
routes: @
)@ A
{ 	
routes 
. 
IgnoreRoute 
( 
$str ;
); <
;< =
routes 
. 
MapRoute 
( 
name 
: 
$str 
,  
url 
: 
$str 1
,1 2
defaults 
: 
new 
{ 

controller  *
=+ ,
$str- 6
,6 7
action8 >
=? @
$strA I
,I J
idK M
=N O
UrlParameterP \
.\ ]
Optional] e
}f g
) 
; 
} 	
} 
} ø∏
OE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\AccountController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
public 
class	 
AccountController  
:! "
BaseController# 1
{ 
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
IUserTypeService %
_userTypeService& 6
;6 7
private 
readonly  
IQueryableRepository )
<) *
User* .
>. / 
_queryableRepository0 D
;D E
private   
readonly    
IQueryableRepository   )
<  ) *
Seller  * 0
>  0 1&
_sellerQueryableRepository  2 L
;  L M
private!! 
readonly!!  
IQueryableRepository!! )
<!!) *
vwRP_StockCount!!* 9
>!!9 : 
_totalRowsRepository!!; O
;!!O P
public%% 

AccountController%% 
(%% 
IUserService%% )
userService%%* 5
,%%5 6
IUserTypeService%%7 G
userTypeService%%H W
,%%W X 
IQueryableRepository%%Y m
<%%m n
User%%n r
>%%r s 
queryableRepository	%%t á
,
%%á à"
IQueryableRepository
%%â ù
<
%%ù û
vwRP_StockCount
%%û ≠
>
%%≠ Æ!
totalRowsRepository
%%Ø ¬
,
%%¬ √"
IQueryableRepository
%%ƒ ÿ
<
%%ÿ Ÿ
Seller
%%Ÿ ﬂ
>
%%ﬂ ‡'
sellerQueryableRepository
%%· ˙
)&&+ ,
{'' 
_userService(( 
=(( 
userService((  
;((  !
_userTypeService)) 
=)) 
userTypeService)) (
;))( ) 
_queryableRepository** 
=** 
queryableRepository** 0
;**0 1 
_totalRowsRepository++ 
=++ 
totalRowsRepository++ 0
;++0 1&
_sellerQueryableRepository,,  
=,,! "%
sellerQueryableRepository,,# <
;,,< =
}.. 
public00 

int00 
PageSize00 
=00 
$num00 
;00 
[11 
SecuredOperation11 
(11 
Roles11 
=11 
$str11 1
)111 2
]112 3
[22 
AuthorizationFilter22 
]22 
public33 


ViewResult33 
Index33 
(33 
Int3233 !
?33! "
page33# '
,33' (
Int3233) .
?33. /
rows330 4
)334 5
{44 
IGrid55 
<55 
User55 
>55 
col55 
=55 
new55 
Grid55  
<55  !
User55! %
>55% &
(55& ' 
_queryableRepository55' ;
.55; <
Table55< A
.55A B
Include55B I
(55I J
$str55J R
)55R S
.55S T
Where55T Y
(55Y Z
x55Z [
=>55\ ^
x55_ `
.55` a
State55a f
==55g i
false55j o
)55o p
.55p q
OrderByDescending	55q Ç
(
55Ç É
x
55É Ñ
=>
55Ö á
x
55à â
.
55â ä
UserId
55ä ê
)
55ê ë
.
55ë í
Skip
55í ñ
(
55ñ ó
(
55ó ò
page
55ò ú
-
55ù û
$num
55ü †
??
55° £
$num
55§ •
)
55• ¶
*
55ß ®
(
55© ™
rows
55™ Æ
??
55Ø ±
$num
55≤ ¥
)
55¥ µ
)
55µ ∂
.
55∂ ∑
Take
55∑ ª
(
55ª º
rows
55º ¿
??
55¡ √
$num
55ƒ ∆
)
55∆ «
.
55« »
AsNoTracking
55» ‘
(
55‘ ’
)
55’ ÷
)
55÷ ◊
;
55◊ ÿ
col66 	
.66	 

Query66
 
=66 
new66 
NameValueCollection66 )
(66) *
Request66* 1
.661 2
QueryString662 =
)66= >
;66> ?
if88 
(88	 

col88
 
.88 
Query88 
!=88 
null88 
)88 
{99 
col:: 
=:: 
new:: 
Grid:: 
<:: 
User:: 
>:: 
(::  
_queryableRepository:: 1
.::1 2
Table::2 7
.::7 8
Include::8 ?
(::? @
$str::@ H
)::H I
.::I J
Where::J O
(::O P
x::P Q
=>::R T
x::U V
.::V W
State::W \
==::] _
false::` e
)::e f
.::f g
OrderByDescending::g x
(::x y
x::y z
=>::{ }
x::~ 
.	:: Ä
UserId
::Ä Ü
)
::Ü á
.
::á à
AsNoTracking
::à î
(
::î ï
)
::ï ñ
)
::ñ ó
;
::ó ò
};; 
col<< 	
.<<	 

Columns<<
 
.<< 
Add<< 
(<< 
x<< 
=><< 
$str<< ~
+	<< Ä
x
<<Å Ç
.
<<Ç É
UserId
<<É â
+
<<ä ã
$str
<<å ï
+
<<ñ ó
$str== ~
+	== Ä
x
==Å Ç
.
==Ç É
UserId
==É â
+
==ä ã
$str
==å ï
)
==ï ñ
.>> 	
Encoded>>	 
(>> 
false>> 
)>> 
.>> 
Titled>> 
(>> 
$str>> )
)>>) *
.>>* +

Filterable>>+ 5
(>>5 6
false>>6 ;
)>>; <
;>>< =
col?? 	
.??	 

Columns??
 
.?? 
Add?? 
(?? 
x?? 
=>?? 
x?? 
.?? 
	FirstName?? &
)??& '
.??' (
Titled??( .
(??. /
$str??/ 4
)??4 5
.??5 6
MultiFilterable??6 E
(??E F
true??F J
)??J K
;??K L
col@@ 	
.@@	 

Columns@@
 
.@@ 
Add@@ 
(@@ 
x@@ 
=>@@ 
x@@ 
.@@ 
LastName@@ %
)@@% &
.@@& '
Titled@@' -
(@@- .
$str@@. 6
)@@6 7
;@@7 8
colAA 	
.AA	 

ColumnsAA
 
.AA 
AddAA 
(AA 
xAA 
=>AA 
xAA 
.AA 
MobilePhoneAA (
)AA( )
.AA) *
TitledAA* 0
(AA0 1
$strAA1 9
)AA9 :
;AA: ;
colBB 	
.BB	 

ColumnsBB
 
.BB 
AddBB 
(BB 
xBB 
=>BB 
xBB 
.BB 
EmailBB "
)BB" #
.BB# $
TitledBB$ *
(BB* +
$strBB+ 3
)BB3 4
;BB4 5
colCC 	
.CC	 

ColumnsCC
 
.CC 
AddCC 
(CC 
xCC 
=>CC 
xCC 
.CC 
StateCC "
)CC" #
.CC# $
TitledCC$ *
(CC* +
$strCC+ 6
)CC6 7
;CC7 8
colDD 	
.DD	 

ColumnsDD
 
.DD 
AddDD 
(DD 
xDD 
=>DD 
xDD 
.DD 
SellerDD #
.DD# $

SellerNameDD$ .
)DD. /
.DD/ 0
TitledDD0 6
(DD6 7
$strDD7 H
)DDH I
;DDI J
colFF 	
.FF	 

PagerFF
 
=FF 
newFF 
	GridPagerFF 
<FF  
UserFF  $
>FF$ %
(FF% &
colFF& )
)FF) *
;FF* +
colGG 	
.GG	 


ProcessorsGG
 
.GG 
AddGG 
(GG 
colGG 
.GG 
PagerGG "
)GG" #
;GG# $
colHH 	
.HH	 

PagerHH
 
.HH 
RowsPerPageHH 
=HH 
$numHH  
;HH  !
colII 	
.II	 

	EmptyTextII
 
=II 
$strII 1
;II1 2
foreachJJ 
(JJ 
IGridColumnJJ 
columnJJ !
inJJ" $
colJJ% (
.JJ( )
ColumnsJJ) 0
)JJ0 1
{KK 
columnLL 
.LL 
IsFilterableLL 
=LL 
trueLL "
;LL" #
columnMM 
.MM 

IsSortableMM 
=MM 
trueMM  
;MM  !
}NN 
varOO 	
totalOO
 
=OO  
_totalRowsRepositoryOO &
.OO& '
TableOO' ,
.OO, -
IncludeOO- 4
(OO4 5
$strOO5 =
)OO= >
.OO> ?
WhereOO? D
(OOD E
xOOE F
=>OOG I
xOOJ K
.OOK L
	TableNameOOL U
==OOV X
$strOOY `
)OO` a
.OOa b
SelectOOb h
(OOh i
xOOi j
=>OOk m
xOOn o
.OOo p
	TableRowsOOp y
)OOy z
.OOz {
First	OO{ Ä
(
OOÄ Å
)
OOÅ Ç
;
OOÇ É
ViewBagPP 
.PP 
	totalRowsPP 
=PP 
ConvertPP !
.PP! "
ToInt32PP" )
(PP) *
totalPP* /
)PP/ 0
;PP0 1
returnQQ 
ViewQQ 
(QQ 
colQQ 
)QQ 
;QQ 
}RR 
[SS 
SecuredOperationSS 
(SS 
RolesSS 
=SS 
$strSS 1
)SS1 2
]SS2 3
[TT 
AuthorizationFilterTT 
]TT 
publicUU 

ActionResultUU 
	UserIndexUU !
(UU! "
Int32UU" '
?UU' (
pageUU) -
,UU- .
Int32UU/ 4
?UU4 5
rowsUU6 :
)UU: ;
{VV 
IGridWW 
<WW 
UserWW 
>WW 
colWW 
=WW 
newWW 
GridWW  
<WW  !
UserWW! %
>WW% &
(WW& ' 
_queryableRepositoryWW' ;
.WW; <
TableWW< A
.WWA B
OrderByDescendingWWB S
(WWS T
xWWT U
=>WWV X
xWWY Z
.WWZ [
UserIdWW[ a
)WWa b
.WWb c
SkipWWc g
(WWg h
(WWh i
pageWWi m
-WWn o
$numWWp q
??WWr t
$numWWu v
)WWv w
*WWx y
(WWz {
rowsWW{ 
??
WWÄ Ç
$num
WWÉ Ö
)
WWÖ Ü
)
WWÜ á
.
WWá à
Take
WWà å
(
WWå ç
rows
WWç ë
??
WWí î
$num
WWï ó
)
WWó ò
.
WWò ô
AsNoTracking
WWô •
(
WW• ¶
)
WW¶ ß
)
WWß ®
;
WW® ©
colXX 	
.XX	 

QueryXX
 
=XX 
newXX 
NameValueCollectionXX )
(XX) *
RequestXX* 1
.XX1 2
QueryStringXX2 =
)XX= >
;XX> ?
ifZZ 
(ZZ	 

colZZ
 
.ZZ 
QueryZZ 
!=ZZ 
nullZZ 
)ZZ 
{[[ 
col\\ 
=\\ 
new\\ 
Grid\\ 
<\\ 
User\\ 
>\\ 
(\\  
_queryableRepository\\ 1
.\\1 2
Table\\2 7
.\\7 8
Include\\8 ?
(\\? @
$str\\@ H
)\\H I
.\\I J
OrderByDescending\\J [
(\\[ \
x\\\ ]
=>\\^ `
x\\a b
.\\b c
UserId\\c i
)\\i j
.\\j k
AsNoTracking\\k w
(\\w x
)\\x y
)\\y z
;\\z {
}]] 
col^^ 	
.^^	 

Columns^^
 
.^^ 
Add^^ 
(^^ 
x^^ 
=>^^ 
$str^^ h
+^^i j
x^^k l
.^^l m
UserId^^m s
+^^t u
$str^^v 
+
^^Ä Å
$str__ p
+__q r
x__s t
.__t u
UserId__u {
+__| }
$str	__~ á
)
__á à
.``
 
Encoded`` 
(`` 
false`` 
)`` 
.`` 
Titled``  
(``  !
$str``! +
)``+ ,
.``, -

Filterable``- 7
(``7 8
false``8 =
)``= >
;``> ?
colaa 	
.aa	 

Columnsaa
 
.aa 
Addaa 
(aa 
xaa 
=>aa 
xaa 
.aa 
	FirstNameaa &
)aa& '
.aa' (
Titledaa( .
(aa. /
$straa/ 4
)aa4 5
.aa5 6
MultiFilterableaa6 E
(aaE F
trueaaF J
)aaJ K
;aaK L
colbb 	
.bb	 

Columnsbb
 
.bb 
Addbb 
(bb 
xbb 
=>bb 
xbb 
.bb 
LastNamebb %
)bb% &
.bb& '
Titledbb' -
(bb- .
$strbb. 6
)bb6 7
;bb7 8
colcc 	
.cc	 

Columnscc
 
.cc 
Addcc 
(cc 
xcc 
=>cc 
xcc 
.cc 
MobilePhonecc (
)cc( )
.cc) *
Titledcc* 0
(cc0 1
$strcc1 9
)cc9 :
;cc: ;
coldd 	
.dd	 

Columnsdd
 
.dd 
Adddd 
(dd 
xdd 
=>dd 
xdd 
.dd 
Emaildd "
)dd" #
.dd# $
Titleddd$ *
(dd* +
$strdd+ 3
)dd3 4
;dd4 5
colee 	
.ee	 

Columnsee
 
.ee 
Addee 
(ee 
xee 
=>ee 
xee 
.ee 
Stateee "
)ee" #
.ee# $
Titledee$ *
(ee* +
$stree+ 6
)ee6 7
;ee7 8
colff 	
.ff	 

Columnsff
 
.ff 
Addff 
(ff 
xff 
=>ff 
xff 
.ff 
Sellerff #
.ff# $

SellerNameff$ .
)ff. /
.ff/ 0
Titledff0 6
(ff6 7
$strff7 H
)ffH I
;ffI J
colhh 	
.hh	 

Pagerhh
 
=hh 
newhh 
	GridPagerhh 
<hh  
Userhh  $
>hh$ %
(hh% &
colhh& )
)hh) *
;hh* +
colii 	
.ii	 


Processorsii
 
.ii 
Addii 
(ii 
colii 
.ii 
Pagerii "
)ii" #
;ii# $
coljj 	
.jj	 

Pagerjj
 
.jj 
RowsPerPagejj 
=jj 
$numjj  
;jj  !
colkk 	
.kk	 

	EmptyTextkk
 
=kk 
$strkk 1
;kk1 2
foreachll 
(ll 
IGridColumnll 
columnll !
inll" $
colll% (
.ll( )
Columnsll) 0
)ll0 1
{mm 
columnnn 
.nn 
IsFilterablenn 
=nn 
truenn "
;nn" #
columnoo 
.oo 

IsSortableoo 
=oo 
trueoo  
;oo  !
}pp 
varqq 	
totalqq
 
=qq  
_totalRowsRepositoryqq &
.qq& '
Tableqq' ,
.qq, -
Whereqq- 2
(qq2 3
xqq3 4
=>qq5 7
xqq8 9
.qq9 :
	TableNameqq: C
==qqD F
$strqqG N
)qqN O
.qqO P
SelectqqP V
(qqV W
xqqW X
=>qqY [
xqq\ ]
.qq] ^
	TableRowsqq^ g
)qqg h
.qqh i
Firstqqi n
(qqn o
)qqo p
;qqp q
ViewBagrr 
.rr 
	totalRowsrr 
=rr 
Convertrr !
.rr! "
ToInt32rr" )
(rr) *
totalrr* /
)rr/ 0
;rr0 1
returnss 
Viewss 
(ss 
colss 
)ss 
;ss 
}tt 
[uu 
SecuredOperationuu 
(uu 
Rolesuu 
=uu 
$struu 1
)uu1 2
]uu2 3
[vv 
AuthorizationFiltervv 
]vv 
publicww 

ActionResultww 
Editww 
(ww 
intww  
idww! #
)ww# $
{xx 
varyy 	
datayy
 
=yy 
AutoMapperHelperyy !
.yy! "
MapToSameViewModelyy" 4
<yy4 5
Useryy5 9
,yy9 :
UserViewModelyy; H
>yyH I
(yyI J
_userServiceyyJ V
.yyV W
GetByIdyyW ^
(yy^ _
idyy_ a
)yya b
)yyb c
;yyc d
returnzz 
Viewzz 
(zz 
datazz 
.zz 
ToVMzz 
(zz 
)zz 
)zz 
;zz 
}{{ 
[~~ 
HttpPost~~ 
]~~ 
public 

ActionResult 
Edit 
( 
User !
user" &
)& '
{
ÄÄ 
var
ÅÅ 	
uPwd
ÅÅ
 
=
ÅÅ 
_userService
ÅÅ 
.
ÅÅ 
GetById
ÅÅ %
(
ÅÅ% &
user
ÅÅ& *
.
ÅÅ* +
UserId
ÅÅ+ 1
)
ÅÅ1 2
;
ÅÅ2 3
try
ÇÇ 	
{
ÉÉ 
_userService
ÖÖ 
.
ÖÖ 
Update
ÖÖ 
(
ÖÖ 
new
ÖÖ 
User
ÖÖ  $
{
ÜÜ 	
	Agreement
áá
 
=
áá 
user
áá 
.
áá 
	Agreement
áá $
,
áá$ %
	BirthDate
àà
 
=
àà 
user
àà 
.
àà 
	BirthDate
àà $
,
àà$ %
Email
ââ
 
=
ââ 
user
ââ 
.
ââ 
Email
ââ 
,
ââ 
	FirstName
ää
 
=
ää 
user
ää 
.
ää 
	FirstName
ää $
,
ää$ %
LastName
ãã
 
=
ãã 
user
ãã 
.
ãã 
LastName
ãã "
,
ãã" #
MobilePhone
åå
 
=
åå 
user
åå 
.
åå 
MobilePhone
åå (
,
åå( )
State
çç
 
=
çç 
user
çç 
.
çç 
State
çç 
,
çç 
UserName
éé
 
=
éé 
user
éé 
.
éé 
UserName
éé "
,
éé" #

UserTypeId
èè
 
=
èè 
user
èè 
.
èè 

UserTypeId
èè &
,
èè& '
UserId
êê
 
=
êê 
user
êê 
.
êê 
UserId
êê 
,
êê 
Password
ëë
 
=
ëë 
uPwd
ëë 
.
ëë 
Password
ëë "
,
ëë" #
SellerId
íí
 
=
íí 
user
íí 
.
íí 
SellerId
íí "
,
íí" #
Contact
ìì
 
=
ìì 
user
ìì 
.
ìì 
Contact
ìì  
}
îî 	
)
îî	 

;
îî
 !
SuccessNotification
ïï 
(
ïï 
$str
ïï /
)
ïï/ 0
;
ïï0 1
return
ññ 
RedirectToAction
ññ 
(
ññ  
$str
ññ  +
)
ññ+ ,
;
ññ, -
}
óó 
catch
òò 
{
ôô 
return
öö 
View
öö 
(
öö 
)
öö 
;
öö 
}
õõ 
}
úú 
public
ùù 

ActionResult
ùù 
SignIn
ùù 
(
ùù 
)
ùù  
{
ûû 
return
üü 
View
üü 
(
üü 
)
üü 
;
üü 
}
†† 
[
°° 
HttpPost
°° 
]
°° 
public
££ 

ActionResult
££ 
SignIn
££ 
(
££ 
string
££ %
userName
££& .
,
££. /
string
££0 6
password
££7 ?
)
££? @
{
§§ 
var
¶¶ 	
user
¶¶
 
=
¶¶ 
_userService
¶¶ 
.
¶¶ &
GetByUserNameAndPassword
¶¶ 6
(
¶¶6 7
userName
¶¶7 ?
,
¶¶? @
password
¶¶A I
)
¶¶I J
;
¶¶J K
if
®® 
(
®®	 

user
®®
 
!=
®® 
null
®® 
&&
®® 
user
®® 
.
®® 
	Agreement
®® (
==
®®) +
true
®®, 0
)
®®0 1
{
©© 
Session
™™ 
[
™™ 
$str
™™ 
]
™™ 
=
™™ 
Session
™™ %
[
™™% &
$str
™™& 0
]
™™0 1
==
™™2 4
null
™™5 9
?
™™: ;
user
™™< @
.
™™@ A
	FirstName
™™A J
+
™™K L
$str
™™M P
+
™™Q R
user
™™S W
.
™™W X
LastName
™™X `
:
™™a b
$str
™™c e
;
™™e f
if
´´ 

(
´´ 
TempData
´´ 
!=
´´ 
null
´´ 
)
´´ 
{
¨¨ 	
TempData
≠≠
 
[
≠≠ 
$str
≠≠ 
]
≠≠ 
=
≠≠  
userName
≠≠! )
;
≠≠) *
TempData
ÆÆ
 
[
ÆÆ 
$str
ÆÆ 
]
ÆÆ 
=
ÆÆ  
password
ÆÆ! )
;
ÆÆ) *
return
ØØ
 
RedirectToAction
ØØ !
(
ØØ! "
$str
ØØ" )
)
ØØ) *
;
ØØ* +
}
∞∞ 	
return
±± 
RedirectToAction
±± 
(
±±  
$str
±±  '
)
±±' (
;
±±( )
}
≤≤ 
TempData
≥≥ 
[
≥≥ 
$str
≥≥ 
]
≥≥ 
=
≥≥ 
$str
≥≥ ?
+
≥≥@ A
$str
≥≥B S
+
≥≥T U
$str
≥≥V x
;
≥≥x y
return
¥¥ 
View
¥¥ 
(
¥¥ 
$str
¥¥ 
)
¥¥ 
;
¥¥ 
}
µµ 
public
∑∑ 

ActionResult
∑∑ 
Login
∑∑ 
(
∑∑ 
string
∑∑ $
userName
∑∑% -
,
∑∑- .
string
∑∑/ 5
password
∑∑6 >
)
∑∑> ?
{
∏∏ 
var
ππ 	
user
ππ
 
=
ππ 
_userService
ππ 
.
ππ &
GetByUserNameAndPassword
ππ 6
(
ππ6 7
TempData
ππ7 ?
[
ππ? @
$str
ππ@ J
]
ππJ K
.
ππK L
ToString
ππL T
(
ππT U
)
ππU V
,
ππV W
TempData
∫∫
 
[
∫∫ 
$str
∫∫ 
]
∫∫ 
.
∫∫ 
ToString
∫∫ '
(
∫∫' (
)
∫∫( )
)
∫∫) *
;
∫∫* +
if
ªª 
(
ªª	 

user
ªª
 
!=
ªª 
null
ªª 
&&
ªª 
user
ªª 
.
ªª 
	Agreement
ªª (
==
ªª) +
true
ªª, 0
)
ªª0 1
{
ºº "
AuthenticationHelper
ΩΩ 
.
ΩΩ 
CreateAuthCookie
ΩΩ -
(
ΩΩ- .
new
ææ 
Guid
ææ 
(
ææ 
)
ææ 
,
ææ 
user
øø 
.
øø 
UserName
øø 
,
øø 
user
¿¿ 
.
¿¿ 
Email
¿¿ 
,
¿¿ 
DateTime
¡¡ 
.
¡¡ 
Now
¡¡ 
.
¡¡ 
AddDays
¡¡  
(
¡¡  !
$num
¡¡! "
)
¡¡" #
,
¡¡# $
_userService
¬¬ 
.
¬¬ 
GetUserRoles
¬¬ %
(
¬¬% &
user
¬¬& *
)
¬¬* +
.
¬¬+ ,
Select
¬¬, 2
(
¬¬2 3
u
¬¬3 4
=>
¬¬5 7
u
¬¬8 9
.
¬¬9 :
RoleName
¬¬: B
)
¬¬B C
.
¬¬C D
ToArray
¬¬D K
(
¬¬K L
)
¬¬L M
,
¬¬M N
false
√√ 
,
√√ 
user
ƒƒ 
.
ƒƒ 
	FirstName
ƒƒ 
,
ƒƒ 
user
≈≈ 
.
≈≈ 
LastName
≈≈ 
)
≈≈ 
;
≈≈ 
return
∆∆ 
RedirectToAction
∆∆ 
(
∆∆  
$str
∆∆  '
,
∆∆' (
$str
∆∆) 3
,
∆∆3 4
new
∆∆5 8
{
∆∆9 :
id
∆∆; =
=
∆∆> ?
user
∆∆@ D
.
∆∆D E
UserId
∆∆E K
}
∆∆L M
)
∆∆M N
;
∆∆N O
}
«« 
return
»» 
Redirect
»» 
(
»» 
$str
»» (
)
»»( )
;
»») *
}
…… 
public
ÀÀ 

ActionResult
ÀÀ 
SignOut
ÀÀ 
(
ÀÀ  
)
ÀÀ  !
{
ÃÃ 
Session
ÕÕ 
.
ÕÕ 
Clear
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ !
FormsAuthentication
ŒŒ 
.
ŒŒ 
SignOut
ŒŒ !
(
ŒŒ! "
)
ŒŒ" #
;
ŒŒ# $
Response
œœ 
.
œœ 
Cache
œœ 
.
œœ 

SetExpires
œœ 
(
œœ  
DateTime
œœ  (
.
œœ( )
UtcNow
œœ) /
.
œœ/ 0

AddMinutes
œœ0 :
(
œœ: ;
-
œœ; <
$num
œœ< =
)
œœ= >
)
œœ> ?
;
œœ? @
Response
–– 
.
–– 
Cache
–– 
.
–– 
SetCacheability
–– $
(
––$ %
System
––% +
.
––+ ,
Web
––, /
.
––/ 0
HttpCacheability
––0 @
.
––@ A
NoCache
––A H
)
––H I
;
––I J
Response
—— 
.
—— 
Cache
—— 
.
—— 

SetNoStore
—— 
(
——  
)
——  !
;
——! "
Session
““ 
.
““ 
Abandon
““ 
(
““ 
)
““ 
;
““ 
return
”” 
RedirectToAction
”” 
(
”” 
$str
”” &
,
””& '
$str
””( 1
,
””1 2
null
””3 7
)
””7 8
;
””8 9
}
‘‘ 
public
÷÷ 

ActionResult
÷÷ 
NewUser
÷÷ 
(
÷÷  
UserViewModel
÷÷  -
user
÷÷. 2
)
÷÷2 3
{
◊◊ 
var
ÿÿ 	
userType
ÿÿ
 
=
ÿÿ 
_userTypeService
ÿÿ %
.
ÿÿ% &
GetAll
ÿÿ& ,
(
ÿÿ, -
)
ÿÿ- .
;
ÿÿ. /
var
ŸŸ 	

sellerList
ŸŸ
 
=
ŸŸ (
_sellerQueryableRepository
ŸŸ 1
.
ŸŸ1 2
Table
ŸŸ2 7
.
ŸŸ7 8
ToList
ŸŸ8 >
(
ŸŸ> ?
)
ŸŸ? @
;
ŸŸ@ A
ViewData
⁄⁄ 
[
⁄⁄ 
$str
⁄⁄ 
]
⁄⁄ 
=
⁄⁄  
userType
⁄⁄! )
.
⁄⁄) *
Select
⁄⁄* 0
(
⁄⁄0 1
u
⁄⁄1 2
=>
⁄⁄3 5
new
⁄⁄6 9
SelectListItem
⁄⁄: H
{
⁄⁄I J
Value
⁄⁄K P
=
⁄⁄Q R
u
⁄⁄S T
.
⁄⁄T U

UserTypeId
⁄⁄U _
.
⁄⁄_ `
ToString
⁄⁄` h
(
⁄⁄h i
)
⁄⁄i j
,
⁄⁄j k
Text
⁄⁄l p
=
⁄⁄q r
u
⁄⁄s t
.
⁄⁄t u
UserTypeName⁄⁄u Å
.⁄⁄Å Ç
ToString⁄⁄Ç ä
(⁄⁄ä ã
)⁄⁄ã å
}⁄⁄ç é
)⁄⁄é è
;⁄⁄è ê
ViewData
€€ 
[
€€ 
$str
€€ 
]
€€ 
=
€€ 

sellerList
€€ )
.
€€) *
Select
€€* 0
(
€€0 1
s
€€1 2
=>
€€3 5
new
€€6 9
SelectListItem
€€: H
{
€€I J
Value
€€K P
=
€€Q R
s
€€S T
.
€€T U
SellerId
€€U ]
.
€€] ^
ToString
€€^ f
(
€€f g
)
€€g h
,
€€h i
Text
€€j n
=
€€o p
s
€€q r
.
€€r s

SellerName
€€s }
.
€€} ~
ToString€€~ Ü
(€€Ü á
)€€á à
}€€â ä
)€€ä ã
;€€ã å
;€€ç é
return
‹‹ 
View
‹‹ 
(
‹‹ 
)
‹‹ 
;
‹‹ 
}
›› 
[
ﬂﬂ 
HttpPost
ﬂﬂ 
]
ﬂﬂ 
public
‡‡ 

ActionResult
‡‡ 
NewUser
‡‡ 
(
‡‡  
UserViewModel
‡‡  -
user
‡‡. 2
,
‡‡2 3
string
‡‡4 :
username
‡‡; C
,
‡‡C D
string
‡‡E K
email
‡‡L Q
,
‡‡Q R
int
‡‡S V

usertypeid
‡‡W a
)
‡‡a b
{
·· 
var
‚‚ 	
userType
‚‚
 
=
‚‚ 
_userTypeService
‚‚ %
.
‚‚% &
GetAll
‚‚& ,
(
‚‚, -
)
‚‚- .
;
‚‚. /
ViewData
„„ 
[
„„ 
$str
„„ 
]
„„ 
=
„„  
userType
„„! )
.
„„) *
Select
„„* 0
(
„„0 1
u
„„1 2
=>
„„3 5
new
„„6 9
SelectListItem
„„: H
{
„„I J
Value
„„K P
=
„„Q R
u
„„S T
.
„„T U

UserTypeId
„„U _
.
„„_ `
ToString
„„` h
(
„„h i
)
„„i j
,
„„j k
Text
„„l p
=
„„q r
u
„„s t
.
„„t u
UserTypeName„„u Å
.„„Å Ç
ToString„„Ç ä
(„„ä ã
)„„ã å
}„„ç é
)„„é è
;„„è ê
var
‰‰ 	

sellerList
‰‰
 
=
‰‰ (
_sellerQueryableRepository
‰‰ 1
.
‰‰1 2
Table
‰‰2 7
.
‰‰7 8
ToList
‰‰8 >
(
‰‰> ?
)
‰‰? @
;
‰‰@ A
var
ÂÂ 	
seller
ÂÂ
 
=
ÂÂ 

sellerList
ÂÂ 
.
ÂÂ 
Select
ÂÂ $
(
ÂÂ$ %
s
ÂÂ% &
=>
ÂÂ' )
new
ÂÂ* -
SelectListItem
ÂÂ. <
{
ÂÂ= >
Value
ÂÂ? D
=
ÂÂE F
s
ÂÂG H
.
ÂÂH I
SellerId
ÂÂI Q
.
ÂÂQ R
ToString
ÂÂR Z
(
ÂÂZ [
)
ÂÂ[ \
,
ÂÂ\ ]
Text
ÂÂ^ b
=
ÂÂc d
s
ÂÂe f
.
ÂÂf g

SellerName
ÂÂg q
.
ÂÂq r
ToString
ÂÂr z
(
ÂÂz {
)
ÂÂ{ |
}
ÂÂ} ~
)
ÂÂ~ 
;ÂÂ Ä
ViewData
ÊÊ 
[
ÊÊ 
$str
ÊÊ 
]
ÊÊ 
=
ÊÊ 
seller
ÊÊ %
;
ÊÊ% &
if
ÁÁ 
(
ÁÁ	 

!
ÁÁ
 

ModelState
ÁÁ 
.
ÁÁ 
IsValid
ÁÁ 
)
ÁÁ 
{
ËË 
ErrorNotification
ÈÈ 
(
ÈÈ 
$str
ÈÈ ,
)
ÈÈ, -
;
ÈÈ- .
return
ÍÍ 
View
ÍÍ 
(
ÍÍ 
)
ÍÍ 
;
ÍÍ 
}
ÎÎ 
var
ÏÏ 	
addUser
ÏÏ
 
=
ÏÏ 
_userService
ÏÏ  
.
ÏÏ  !
Add
ÏÏ! $
(
ÏÏ$ %
new
ÌÌ 
User
ÌÌ 
{
ÓÓ 
UserName
ÔÔ 
=
ÔÔ 
user
ÔÔ  
.
ÔÔ  !
UserName
ÔÔ! )
,
ÔÔ) *
	BirthDate
 
=
 
user
 !
.
! "
	BirthDate
" +
,
+ ,
Contact
ÒÒ 
=
ÒÒ 
user
ÒÒ 
.
ÒÒ  
Contact
ÒÒ  '
,
ÒÒ' (
SellerId
ÚÚ 
=
ÚÚ 
user
ÚÚ  
.
ÚÚ  !
SellerId
ÚÚ! )
,
ÚÚ) *
Email
ÛÛ 
=
ÛÛ 
user
ÛÛ 
.
ÛÛ 
Email
ÛÛ #
,
ÛÛ# $
	FirstName
ÙÙ 
=
ÙÙ 
user
ÙÙ !
.
ÙÙ! "
	FirstName
ÙÙ" +
,
ÙÙ+ ,
LastName
ıı 
=
ıı 
user
ıı  
.
ıı  !
LastName
ıı! )
,
ıı) *
MobilePhone
ˆˆ 
=
ˆˆ 
user
ˆˆ #
.
ˆˆ# $
MobilePhone
ˆˆ$ /
,
ˆˆ/ 0
Password
˜˜ 
=
˜˜ 
Crypto
˜˜ "
.
˜˜" #
SHA256
˜˜# )
(
˜˜) *
$str
˜˜* 1
)
˜˜1 2
,
˜˜2 3
State
¯¯ 
=
¯¯ 
false
¯¯ 
,
¯¯ 

UserTypeId
˘˘ 
=
˘˘ 

usertypeid
˘˘ (
,
˘˘( )
	Agreement
˙˙ 
=
˙˙ 
user
˙˙ !
.
˙˙! "
	Agreement
˙˙" +
}
˚˚ 
)
˚˚ 
;
˚˚ 
TempData
¸¸ 
[
¸¸ 
$str
¸¸ 
]
¸¸ 
=
¸¸ 
$str
¸¸ l
;
¸¸l m
return
˝˝ 
View
˝˝ 
(
˝˝ 
$str
˝˝ 
)
˝˝ 
;
˝˝ 
}
˛˛ 
[
ˇˇ 
SecuredOperation
ˇˇ 
(
ˇˇ 
Roles
ˇˇ 
=
ˇˇ 
$str
ˇˇ +
)
ˇˇ+ ,
]
ˇˇ, -
[
ÄÄ !
AuthorizationFilter
ÄÄ 
]
ÄÄ 
public
ÅÅ 

string
ÅÅ 
Add
ÅÅ 
(
ÅÅ 
)
ÅÅ 
{
ÇÇ 
_userService
ÉÉ 
.
ÉÉ 
Add
ÉÉ 
(
ÉÉ 
new
ÉÉ 
User
ÉÉ 
{
ÑÑ 
	BirthDate
ÖÖ 
=
ÖÖ 
DateTime
ÖÖ 
.
ÖÖ 
Now
ÖÖ  
,
ÖÖ  !
Email
ÜÜ 
=
ÜÜ 
$str
ÜÜ %
,
ÜÜ% &
	FirstName
áá 
=
áá 
$str
áá 
,
áá 
LastName
àà 
=
àà 
$str
àà 
,
àà 
Password
ââ 
=
ââ 
Crypto
ââ 
.
ââ 
SHA256
ââ  
(
ââ  !
$str
ââ! (
)
ââ( )
,
ââ) *
UserName
ää 
=
ää 
$str
ää 
,
ää 
MobilePhone
ãã 
=
ãã 
$str
ãã 
,
ãã  

UserTypeId
åå 
=
åå 
$num
åå 
,
åå 
State
éé 
=
éé 
false
éé 
,
éé 
	UserImage
èè 
=
èè 
null
èè 
,
èè 
UserId
êê 
=
êê 
$num
êê 
}
íí 
)
íí 
;
íí 	
return
ìì 
$str
ìì 
;
ìì 
}
îî 
[
ïï 
SecuredOperation
ïï 
(
ïï 
Roles
ïï 
=
ïï 
$str
ïï +
)
ïï+ ,
]
ïï, -
[
ññ !
AuthorizationFilter
ññ 
]
ññ 
public
óó 

ActionResult
óó 
UpdateActivation
óó (
(
óó( )
int
óó) ,
id
óó- /
)
óó/ 0
{
òò 
var
ôô 	
model
ôô
 
=
ôô 
_userService
ôô 
.
ôô 
GetById
ôô &
(
ôô& '
id
ôô' )
)
ôô) *
;
ôô* +
model
öö 
.
öö 
State
öö 
=
öö 
true
öö 
;
öö 
_userService
õõ 
.
õõ 
Update
õõ 
(
õõ 
model
õõ 
)
õõ  
;
õõ  !!
SuccessNotification
ßß 
(
ßß 
$str
ßß 0
)
ßß0 1
;
ßß1 2
return
®® 
RedirectToAction
®® 
(
®® 
$str
®® %
,
®®% &
$str
®®' 0
)
®®0 1
;
®®1 2
}
©© 
[
™™ 
SecuredOperation
™™ 
(
™™ 
Roles
™™ 
=
™™ 
$str
™™ +
)
™™+ ,
]
™™, -
[
´´ !
AuthorizationFilter
´´ 
]
´´ 
public
¨¨ 

ActionResult
¨¨ 
Delete
¨¨ 
(
¨¨ 
int
¨¨ "
id
¨¨# %
)
¨¨% &
{
≠≠ 
_userService
ÆÆ 
.
ÆÆ 
Delete
ÆÆ 
(
ÆÆ 
_userService
ÆÆ &
.
ÆÆ& '
GetById
ÆÆ' .
(
ÆÆ. /
id
ÆÆ/ 1
)
ÆÆ1 2
)
ÆÆ2 3
;
ÆÆ3 4!
SuccessNotification
ØØ 
(
ØØ 
$str
ØØ @
)
ØØ@ A
;
ØØA B
return
∞∞ 
RedirectToAction
∞∞ 
(
∞∞ 
$str
∞∞ %
,
∞∞% &
$str
∞∞' 0
)
∞∞0 1
;
∞∞1 2
}
±± 
[
≤≤ !
AuthorizationFilter
≤≤ 
]
≤≤ 
public
≥≥ 

ActionResult
≥≥ 
ChangePassword
≥≥ &
(
≥≥& '
)
≥≥' (
{
¥¥ 
return
µµ 
View
µµ 
(
µµ 
)
µµ 
;
µµ 
}
∂∂ 
[
∑∑ 
HttpPost
∑∑ 
]
∑∑ 
public
∏∏ 

ActionResult
∏∏ 
ChangePassword
∏∏ &
(
∏∏& '
string
∏∏' -
userName
∏∏. 6
,
∏∏6 7
string
∏∏8 >
password
∏∏? G
)
∏∏G H
{
ππ 
var
∫∫ 	
user
∫∫
 
=
∫∫ 
_userService
∫∫ 
.
∫∫ 
GetById
∫∫ %
(
∫∫% &
Convert
∫∫& -
.
∫∫- .
ToInt32
∫∫. 5
(
∫∫5 6
GeneralHelpers
∫∫6 D
.
∫∫D E
	GetUserId
∫∫E N
(
∫∫N O
)
∫∫O P
)
∫∫P Q
)
∫∫Q R
;
∫∫R S
_userService
ªª 
.
ªª 
Update
ªª 
(
ªª 
new
ªª 
User
ªª "
{
ºº 
	Agreement
ΩΩ 
=
ΩΩ 
user
ΩΩ 
.
ΩΩ 
	Agreement
ΩΩ "
,
ΩΩ" #
	BirthDate
ææ 
=
ææ 
user
ææ 
.
ææ 
	BirthDate
ææ "
,
ææ" #
Email
øø 
=
øø 
user
øø 
.
øø 
Email
øø 
,
øø 
	FirstName
¿¿ 
=
¿¿ 
user
¿¿ 
.
¿¿ 
	FirstName
¿¿ "
,
¿¿" #
LastName
¡¡ 
=
¡¡ 
user
¡¡ 
.
¡¡ 
LastName
¡¡  
,
¡¡  !
MobilePhone
¬¬ 
=
¬¬ 
user
¬¬ 
.
¬¬ 
MobilePhone
¬¬ &
,
¬¬& '
State
√√ 
=
√√ 
user
√√ 
.
√√ 
State
√√ 
,
√√ 
	UserImage
ƒƒ 
=
ƒƒ 
user
ƒƒ 
.
ƒƒ 
	UserImage
ƒƒ "
,
ƒƒ" #
UserName
≈≈ 
=
≈≈ 
user
≈≈ 
.
≈≈ 
UserName
≈≈  
,
≈≈  !

UserTypeId
∆∆ 
=
∆∆ 
user
∆∆ 
.
∆∆ 

UserTypeId
∆∆ $
,
∆∆$ %
Password
«« 
=
«« 
Crypto
«« 
.
«« 
SHA256
««  
(
««  !
password
««! )
)
««) *
,
««* +
SellerId
»» 
=
»» 
user
»» 
.
»» 
SellerId
»»  
,
»»  !
UserId
…… 
=
…… 
user
…… 
.
…… 
UserId
…… 
}
   
)
   
;
   	!
SuccessNotification
ÀÀ 
(
ÀÀ 
$str
ÀÀ U
)
ÀÀU V
;
ÀÀV W
return
ÃÃ 
RedirectToAction
ÃÃ 
(
ÃÃ 
$str
ÃÃ '
,
ÃÃ' (
$str
ÃÃ) 2
)
ÃÃ2 3
;
ÃÃ3 4
}
ÕÕ 
}
ŒŒ 
}œœ „[
NE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\AnswerController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class 
AnswerController !
:" #
BaseController$ 2
{ 
private 
readonly 
IAnswerService '
_answerService( 6
;6 7
private 
readonly  
IQueryableRepository -
<- .
Answer. 4
>4 5 
_queryableRepository6 J
;J K
private 
readonly  
IQueryableRepository -
<- .
vwRP_StockCount. =
>= > 
_totalRowsRepository? S
;S T
public 
AnswerController 
(  
IAnswerService  .
answerService/ <
,< = 
IQueryableRepository> R
<R S
AnswerS Y
>Y Z
queryableRepository[ n
,n o!
IQueryableRepository	p Ñ
<
Ñ Ö
vwRP_StockCount
Ö î
>
î ï!
totalRowsRepository
ñ ©
)
© ™
{ 	
_answerService 
= 
answerService *
;* + 
_queryableRepository  
=! "
queryableRepository# 6
;6 7 
_totalRowsRepository  
=! "
totalRowsRepository# 6
;6 7
} 	
[   	
SecuredOperation  	 
(   
Roles   
=    !
$str  " /
)  / 0
]  0 1
public!! 
ActionResult!! 
AnswerIndex!! '
(!!' (
Int32!!( -
?!!- .
page!!/ 3
,!!3 4
Int32!!5 :
?!!: ;
rows!!< @
)!!@ A
{"" 	
IGrid## 
<## 
Answer## 
>## 
col## 
=## 
new##  #
Grid##$ (
<##( )
Answer##) /
>##/ 0
(##0 1 
_queryableRepository##1 E
.##E F
Table##F K
.##K L
OrderByDescending##L ]
(##] ^
x##^ _
=>##` b
x##c d
.##d e
AnswerId##e m
)##m n
.##n o
Skip##o s
(##s t
(##t u
page##u y
-##z {
$num##| }
??	##~ Ä
$num
##Å Ç
)
##Ç É
*
##Ñ Ö
(
##Ü á
rows
##á ã
??
##å é
$num
##è ë
)
##ë í
)
##í ì
.
##ì î
Take
##î ò
(
##ò ô
rows
##ô ù
??
##û †
$num
##° £
)
##£ §
)
##§ •
;
##• ¶
col$$ 
.$$ 
Query$$ 
=$$ 
new$$ 
NameValueCollection$$ /
($$/ 0
Request$$0 7
.$$7 8
QueryString$$8 C
)$$C D
;$$D E
if&& 
(&& 
col&& 
.&& 
Query&& 
!=&& 
null&& !
)&&! "
{'' 
col(( 
=(( 
new(( 
Grid(( 
<(( 
Answer(( %
>((% &
(((& ' 
_queryableRepository((' ;
.((; <
Table((< A
.((A B
OrderByDescending((B S
(((S T
x((T U
=>((V X
x((Y Z
.((Z [
AnswerId(([ c
)((c d
)((d e
;((e f
})) 
col** 
.** 
Columns** 
.** 
Add** 
(** 
x** 
=>**  
$str**! n
+**o p
x**q r
.**r s
AnswerId**s {
+**| }
$str	**~ á
+
**à â
$str++! v
+++w x
x++y z
.++z {
AnswerId	++{ É
+
++Ñ Ö
$str
++Ü è
)
++è ê
.,, 
Encoded,, 
(,, 
false,, 
),, 
.,,  
Titled,,  &
(,,& '
$str,,' 1
),,1 2
.,,2 3

Filterable,,3 =
(,,= >
false,,> C
),,C D
;,,D E
col.. 
... 
Columns.. 
... 
Add.. 
(.. 
x.. 
=>..  
x..! "
..." #
AnswerId..# +
)..+ ,
..., -
Titled..- 3
(..3 4
$str..4 >
)..> ?
...? @
MultiFilterable..@ O
(..O P
true..P T
)..T U
;..U V
col00 
.00 
Pager00 
=00 
new00 
	GridPager00 %
<00% &
Answer00& ,
>00, -
(00- .
col00. 1
)001 2
;002 3
col11 
.11 

Processors11 
.11 
Add11 
(11 
col11 "
.11" #
Pager11# (
)11( )
;11) *
col22 
.22 
Pager22 
.22 
RowsPerPage22 !
=22" #
$num22$ &
;22& '
col33 
.33 
	EmptyText33 
=33 
$str33 7
;337 8
foreach44 
(44 
IGridColumn44  
column44! '
in44( *
col44+ .
.44. /
Columns44/ 6
)446 7
{55 
column66 
.66 
IsFilterable66 #
=66$ %
true66& *
;66* +
column77 
.77 

IsSortable77 !
=77" #
true77$ (
;77( )
}88 
var99 
total99 
=99  
_totalRowsRepository99 ,
.99, -
Table99- 2
.992 3
Where993 8
(998 9
x999 :
=>99; =
x99> ?
.99? @
	TableName99@ I
==99J L
$str99M V
)99V W
.99W X
Select99X ^
(99^ _
x99_ `
=>99a c
x99d e
.99e f
	TableRows99f o
)99o p
.99p q
First99q v
(99v w
)99w x
;99x y
ViewBag:: 
.:: 
	totalRows:: 
=:: 
Convert::  '
.::' (
ToInt32::( /
(::/ 0
total::0 5
)::5 6
;::6 7
return;; 
View;; 
(;; 
col;; 
);; 
;;; 
}<< 	
[>> 	
SecuredOperation>>	 
(>> 
Roles>> 
=>>  !
$str>>" /
)>>/ 0
]>>0 1
public?? 
ActionResult?? 
Create?? "
(??" #
)??# $
{@@ 	
varAA 
emptyAA 
=AA 
newAA 
AnswerViewModelAA +
(AA+ ,
)AA, -
;AA- .
varBB 
dataBB 
=BB 
emptyBB 
.BB 
ToVMBB !
(BB! "
)BB" #
;BB# $
returnCC 
ViewCC 
(CC 
dataCC 
)CC 
;CC 
}DD 	
[FF 	
HttpPostFF	 
]FF 
publicGG 
ActionResultGG 
CreateGG "
(GG" #
AnswerViewModelGG# 2
answerGG3 9
)GG9 :
{HH 	
ifII 
(II 
!II 

ModelStateII 
.II 
IsValidII #
)II# $
{JJ 
ErrorNotificationKK !
(KK! "
$strKK" 5
)KK5 6
;KK6 7
returnLL 
RedirectToActionLL '
(LL' (
$strLL( 0
)LL0 1
;LL1 2
}MM 
_answerServiceNN 
.NN 
AddNN 
(NN 
newNN "
AnswerNN# )
{OO 
}SS 
)SS 
;SS 
SuccessNotificationTT 
(TT  
$strTT  0
)TT0 1
;TT1 2
returnUU 
RedirectToActionUU #
(UU# $
$strUU$ 1
)UU1 2
;UU2 3
}VV 	
[XX 	
SecuredOperationXX	 
(XX 
RolesXX 
=XX  !
$strXX" /
)XX/ 0
]XX0 1
publicYY 
ActionResultYY 
EditYY  
(YY  !
intYY! $
idYY% '
)YY' (
{ZZ 	
var[[ 
data[[ 
=[[ 
AutoMapperHelper[[ '
.[[' (
MapToSameViewModel[[( :
<[[: ;
Answer[[; A
,[[A B
AnswerViewModel[[C R
>[[R S
([[S T
_answerService[[T b
.[[b c
GetById[[c j
([[j k
id[[k m
)[[m n
)[[n o
;[[o p
return\\ 
View\\ 
(\\ 
data\\ 
.\\ 
ToVM\\ !
(\\! "
)\\" #
)\\# $
;\\$ %
}]] 	
[__ 	
HttpPost__	 
]__ 
public`` 
ActionResult`` 
Edit``  
(``  !
Answer``" (
answer``) /
)``/ 0
{aa 	
trybb 
{cc 
_answerServicedd 
.dd 
Updatedd %
(dd% &
newdd& )
Answerdd+ 1
{ee 
AnswerIdii 
=ii 
answerii #
.ii# $
AnswerIdii$ ,
}jj 
)jj 
;jj 
SuccessNotificationkk #
(kk# $
$strkk$ 7
)kk7 8
;kk8 9
returnll 
RedirectToActionll '
(ll' (
$strll( 5
)ll5 6
;ll6 7
}mm 
catchnn 
{oo 
returnpp 
Viewpp 
(pp 
)pp 
;pp 
}qq 
}rr 	
[tt 	
SecuredOperationtt	 
(tt 
Rolestt 
=tt  !
$strtt" /
)tt/ 0
]tt0 1
publicuu 
ActionResultuu 
Deleteuu "
(uu" #
intuu# &
iduu' )
,uu) *
Answeruu+ 1
answeruu2 8
)uu8 9
{vv 	
varww 
dataww 
=ww 
AutoMapperHelperww '
.ww' (
MapToSameViewModelww( :
<ww: ;
Answerww; A
,wwA B
AnswerViewModelwwC R
>wwR S
(wwS T
_answerServicewwT b
.wwb c
GetByIdwwc j
(wwj k
idwwk m
)wwm n
)wwn o
;wwo p
returnxx 
Viewxx 
(xx 
dataxx 
.xx 
ToVMxx !
(xx! "
)xx" #
)xx# $
;xx$ %
}yy 	
[{{ 	
HttpPost{{	 
]{{ 
public|| 
ActionResult|| 
Delete|| "
(||" #
int||# &
id||' )
)||) *
{}} 	
try~~ 
{ 
_answerService
ÄÄ 
.
ÄÄ 
Delete
ÄÄ %
(
ÄÄ% &
_answerService
ÄÄ& 4
.
ÄÄ4 5
GetById
ÄÄ5 <
(
ÄÄ< =
id
ÄÄ= ?
)
ÄÄ? @
)
ÄÄ@ A
;
ÄÄA B!
SuccessNotification
ÅÅ #
(
ÅÅ# $
$str
ÅÅ$ 3
)
ÅÅ3 4
;
ÅÅ4 5
return
ÇÇ 
RedirectToAction
ÇÇ '
(
ÇÇ' (
$str
ÇÇ( 5
)
ÇÇ5 6
;
ÇÇ6 7
}
ÉÉ 
catch
ÑÑ 
{
ÖÖ 
return
ÜÜ 
View
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
áá 
}
àà 	
}
ââ 
}ää Ól
ME:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\BrandController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
BrandController 
:  
BaseController! /
{ 
private 
readonly 
IBrandService "
_brandService# 0
;0 1
private 
readonly  
IQueryableRepository )
<) *
Brand* /
>/ 0 
_queryableRepository1 E
;E F
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

BrandController 
( 
IBrandService (
brandService) 5
,5 6 
IQueryableRepository7 K
<K L
BrandL Q
>Q R
queryableRepositoryS f
,f g 
IQueryableRepositoryh |
<| }
vwRP_StockCount	} å
>
å ç!
totalRowsRepository
é °
)
° ¢
{ 
_brandService 
= 
brandService "
;" # 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
} 
[!! 
SecuredOperation!! 
(!! 
Roles!! 
=!! 
$str!! 1
)!!1 2
]!!2 3
public"" 

ActionResult"" 

BrandIndex"" "
(""" #
Int32""# (
?""( )
page""* .
,"". /
Int32""0 5
?""5 6
rows""7 ;
)""; <
{## 
IGrid&& 
<&& 
Brand&& 
>&& 
col&& 
=&& 
new&& 
Grid&& !
<&&! "
Brand&&" '
>&&' (
(&&( ) 
_queryableRepository&&) =
.&&= >
Table&&> C
.&&C D
AsNoTracking&&D P
(&&P Q
)&&Q R
.&&R S
OrderByDescending&&S d
(&&d e
x&&e f
=>&&g i
x&&j k
.&&k l
BrandId&&l s
)&&s t
.&&t u
Skip&&u y
(&&y z
(&&z {
page&&{ 
-
&&Ä Å
$num
&&Ç É
??
&&Ñ Ü
$num
&&á à
)
&&à â
*
&&ä ã
(
&&å ç
rows
&&ç ë
??
&&í î
$num
&&ï ó
)
&&ó ò
)
&&ò ô
.
&&ô ö
Take
&&ö û
(
&&û ü
rows
&&ü £
??
&&§ ¶
$num
&&ß ©
)
&&© ™
)
&&™ ´
;
&&´ ¨
col'' 	
.''	 

Query''
 
='' 
new'' 
NameValueCollection'' )
('') *
Request''* 1
.''1 2
QueryString''2 =
)''= >
;''> ?
if)) 
())	 

col))
 
.)) 
Query)) 
!=)) 
null)) 
))) 
{** 
col++ 
=++ 
new++ 
Grid++ 
<++ 
Brand++ 
>++ 
(++  
_queryableRepository++ 2
.++2 3
Table++3 8
.++8 9
OrderByDescending++9 J
(++J K
x++K L
=>++M O
x++P Q
.++Q R
BrandId++R Y
)++Y Z
.++Z [
AsNoTracking++[ g
(++g h
)++h i
)++i j
;++j k
},, 
col-- 	
.--	 

Columns--
 
.-- 
Add-- 
(-- 
x-- 
=>-- 
$str-- h
+--i j
x--k l
.--l m
BrandId--m t
+--u v
$str	--w Ä
+
--Å Ç
$str.. p
+..q r
x..s t
...t u
BrandId..u |
+..} ~
$str	.. à
)
..à â
.//
 
Encoded// 
(// 
false// 
)// 
.// 
Titled//  
(//  !
$str//! +
)//+ ,
.//, -

Filterable//- 7
(//7 8
false//8 =
)//= >
;//> ?
col22 	
.22	 

Columns22
 
.22 
Add22 
(22 
x22 
=>22 
x22 
.22 
BrandId22 $
)22$ %
.22% &
Titled22& ,
(22, -
$str22- 7
)227 8
.228 9
MultiFilterable229 H
(22H I
true22I M
)22M N
;22N O
col33 	
.33	 

Columns33
 
.33 
Add33 
(33 
x33 
=>33 
x33 
.33 
	BrandName33 &
)33& '
.33' (
Titled33( .
(33. /
$str33/ :
)33: ;
.33; <
MultiFilterable33< K
(33K L
true33L P
)33P Q
;33Q R
col44 	
.44	 

Columns44
 
.44 
Add44 
(44 
x44 
=>44 
x44 
.44 

BrandImage44 '
)44' (
.44( )
Titled44) /
(44/ 0
$str440 <
)44< =
.44= >
Encoded44> E
(44E F
false44F K
)44K L
.44L M

RenderedAs44M W
(44W X
x44X Y
=>44Z \
x44\ ]
.44] ^

BrandImage44^ h
!=44h j
null44j n
?44n o
$str44p |
+44| }
String	44} É
.
44É Ñ
Format
44Ñ ä
(
44ä ã
$str
44ã ¶
,
44¶ ß
Convert
44® Ø
.
44Ø ∞
ToBase64String
44∞ æ
(
44æ ø
x
44ø ¿
.
44¿ ¡

BrandImage
44¡ À
)
44À Ã
)
44Ã Õ
+
44Õ Œ
$str
44œ 
:
44 Ò
$str
44Ú á
)
44á à
;
44â ä
col66 	
.66	 

Pager66
 
=66 
new66 
	GridPager66 
<66  
Brand66  %
>66% &
(66& '
col66' *
)66* +
;66+ ,
col77 	
.77	 


Processors77
 
.77 
Add77 
(77 
col77 
.77 
Pager77 "
)77" #
;77# $
col88 	
.88	 

Pager88
 
.88 
RowsPerPage88 
=88 
$num88  
;88  !
col99 	
.99	 

	EmptyText99
 
=99 
$str99 1
;991 2
foreach:: 
(:: 
IGridColumn:: 
column:: !
in::" $
col::% (
.::( )
Columns::) 0
)::0 1
{;; 
column<< 
.<< 
IsFilterable<< 
=<< 
true<< "
;<<" #
column== 
.== 

IsSortable== 
=== 
true==  
;==  !
}>> 
var?? 	
total??
 
=??  
_totalRowsRepository?? &
.??& '
Table??' ,
.??, -
AsNoTracking??- 9
(??9 :
)??: ;
.??; <
Where??< A
(??A B
x??B C
=>??D F
x??G H
.??H I
	TableName??I R
==??S U
$str??V ^
)??^ _
.??_ `
Select??` f
(??f g
x??g h
=>??i k
x??l m
.??m n
	TableRows??n w
)??w x
.??x y
First??y ~
(??~ 
)	?? Ä
;
??Ä Å
ViewBag@@ 
.@@ 
	totalRows@@ 
=@@ 
Convert@@ !
.@@! "
ToInt32@@" )
(@@) *
total@@* /
)@@/ 0
;@@0 1
returnAA 
ViewAA 
(AA 
colAA 
)AA 
;AA 
}BB 
[DD 
SecuredOperationDD 
(DD 
RolesDD 
=DD 
$strDD 1
)DD1 2
]DD2 3
publicEE 

ActionResultEE 
CreateEE 
(EE 
)EE  
{FF 
varGG 	
emptyGG
 
=GG 
newGG 
BrandViewModelGG $
(GG$ %
)GG% &
;GG& '
varHH 	
dataHH
 
=HH 
emptyHH 
.HH 
ToVMHH 
(HH 
)HH 
;HH 
returnII 
ViewII 
(II 
dataII 
)II 
;II 
}JJ 
[LL 
HttpPostLL 
]LL 
publicMM 

ActionResultMM 
CreateMM 
(MM 
BrandViewModelMM -
brandMM. 3
)MM3 4
{NN 
ifOO 
(OO	 

!OO
 

ModelStateOO 
.OO 
IsValidOO 
)OO 
{PP 
ErrorNotificationQQ 
(QQ 
$strQQ -
)QQ- .
;QQ. /
returnRR 
RedirectToActionRR 
(RR  
$strRR  (
)RR( )
;RR) *
}SS 
_brandServiceTT 
.TT 
AddTT 
(TT 
newTT 
BrandTT !
{UU 
	BrandNameVV 
=VV 
brandVV 
.VV 
	BrandNameVV #
,VV# $

BrandImageWW 
=WW 
brandWW 
.WW 

BrandImageWW %
,WW% &
BrandImageExtXX 
=XX 
$strXX 
}ZZ 
)ZZ 
;ZZ 	
SuccessNotification[[ 
([[ 
$str[[ *
)[[* +
;[[+ ,
return\\ 
RedirectToAction\\ 
(\\ 
$str\\ *
)\\* +
;\\+ ,
}]] 
[__ 
SecuredOperation__ 
(__ 
Roles__ 
=__ 
$str__ 1
)__1 2
]__2 3
public`` 

ActionResult`` 
Edit`` 
(`` 
int``  
id``! #
)``# $
{aa 
varbb 	
databb
 
=bb 
AutoMapperHelperbb !
.bb! "
MapToSameViewModelbb" 4
<bb4 5
Brandbb5 :
,bb: ;
BrandViewModelbb< J
>bbJ K
(bbK L
_brandServicebbL Y
.bbY Z
GetByIdbbZ a
(bba b
idbbb d
)bbd e
)bbe f
;bbf g
returncc 
Viewcc 
(cc 
datacc 
.cc 
ToVMcc 
(cc 
)cc 
)cc 
;cc 
}dd 
[ff 
HttpPostff 
]ff 
publicgg 

ActionResultgg 
Editgg 
(gg 
BrandViewModelgg +
brandgg, 1
)gg1 2
{hh 
tryii 	
{jj 
_brandServicell 
.ll 
Updatell 
(ll 
newll  
Brandll! &
{mm 	
	BrandNamenn
 
=nn 
brandnn 
.nn 
	BrandNamenn %
,nn% &

BrandImageoo
 
=oo 
brandoo 
.oo 

BrandImageoo '
,oo' (
BrandImageExtpp
 
=pp 
$strpp  
,pp  !
BrandIdqq
 
=qq 
brandqq 
.qq 
BrandIdqq !
}rr 	
)rr	 

;rr
 
SuccessNotificationss 
(ss 
$strss /
)ss/ 0
;ss0 1
returntt 
RedirectToActiontt 
(tt  
$strtt  ,
)tt, -
;tt- .
}uu 
catchvv 
{ww 
returnxx 
Viewxx 
(xx 
)xx 
;xx 
}yy 
}zz 
[|| 
SecuredOperation|| 
(|| 
Roles|| 
=|| 
$str|| +
)||+ ,
]||, -
public}} 

ActionResult}} 
Delete}} 
(}} 
int}} "
id}}# %
,}}% &
Brand}}' ,
brand}}- 2
)}}2 3
{~~ 
var 	
data
 
= 
AutoMapperHelper !
.! "
MapToSameViewModel" 4
<4 5
Brand5 :
,: ;
BrandViewModel< J
>J K
(K L
_brandServiceL Y
.Y Z
GetByIdZ a
(a b
idb d
)d e
)e f
;f g
return
ÄÄ 
View
ÄÄ 
(
ÄÄ 
data
ÄÄ 
.
ÄÄ 
ToVM
ÄÄ 
(
ÄÄ 
)
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
[
ÉÉ 
HttpPost
ÉÉ 
]
ÉÉ 
public
ÑÑ 

ActionResult
ÑÑ 
Delete
ÑÑ 
(
ÑÑ 
int
ÑÑ "
id
ÑÑ# %
)
ÑÑ% &
{
ÖÖ 
try
ÜÜ 	
{
áá 
_brandService
àà 
.
àà 
Delete
àà 
(
àà 
_brandService
àà *
.
àà* +
GetById
àà+ 2
(
àà2 3
id
àà3 5
)
àà5 6
)
àà6 7
;
àà7 8!
SuccessNotification
ââ 
(
ââ 
$str
ââ +
)
ââ+ ,
;
ââ, -
return
ää 
RedirectToAction
ää 
(
ää  
$str
ää  ,
)
ää, -
;
ää- .
}
ãã 
catch
åå 
{
çç 
return
éé 
View
éé 
(
éé 
)
éé 
;
éé 
}
èè 
}
êê 
}
ëë 
}íí Ωå
KE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\BuyController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
BuyController 
: 
BaseController -
{ 
private 
readonly 
IBuyService  
_buyService! ,
;, -
private 
readonly  
IQueryableRepository )
<) *
Buy* -
>- . 
_queryableRepository/ C
;C D
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
private 
readonly  
IQueryableRepository )
<) *
Gift* .
>. /$
_giftQueryableRepository0 H
;H I
private 
readonly  
IQueryableRepository )
<) *
User* .
>. /$
_userQueryableRepository0 H
;H I
public 

BuyController 
( 
IBuyService $

buyService% /
,/ 0 
IQueryableRepository1 E
<E F
BuyF I
>I J
queryableRepositoryK ^
,^ _ 
IQueryableRepository` t
<t u
vwRP_StockCount	u Ñ
>
Ñ Ö!
totalRowsRepository
Ü ô
,
ô ö"
IQueryableRepository
õ Ø
<
Ø ∞
Gift
∞ ¥
>
¥ µ%
giftQueryableRepository
∂ Õ
,
Õ Œ"
IQueryableRepository
œ „
<
„ ‰
User
‰ Ë
>
Ë È%
userQueryableRepository
Í Å
)
Å Ç
{   
_buyService!! 
=!! 

buyService!! 
;!!  
_queryableRepository"" 
="" 
queryableRepository"" 0
;""0 1 
_totalRowsRepository## 
=## 
totalRowsRepository## 0
;##0 1$
_giftQueryableRepository$$ 
=$$  #
giftQueryableRepository$$! 8
;$$8 9$
_userQueryableRepository%% 
=%%  #
userQueryableRepository%%! 8
;%%8 9
}&& 
[(( 
SecuredOperation(( 
((( 
Roles(( 
=(( 
$str(( 6
)((6 7
]((7 8
public)) 

ActionResult)) 
BuyIndex))  
())  !
Int32))! &
?))& '
page))( ,
,)), -
Int32)). 3
?))3 4
rows))5 9
)))9 :
{** 
var++ 	
	getUserId++
 
=++ 
Convert++ 
.++ 
ToInt32++ $
(++$ %
GeneralHelpers++% 3
.++3 4
	GetUserId++4 =
(++= >
)++> ?
)++? @
;++@ A
IGrid,, 
<,, 
Buy,, 
>,, 
col,, 
=,, 
new,, 
Grid,, 
<,,  
Buy,,  #
>,,# $
(,,$ % 
_queryableRepository,,% 9
.,,9 :
Table,,: ?
.,,? @
Include,,@ G
(,,G H
$str,,H N
),,N O
.,,O P
Include,,P W
(,,W X
$str,,X ^
),,^ _
.,,_ `
Include,,` g
(,,g h
$str,,h o
),,o p
.,,p q
Where,,q v
(,,v w
x,,w x
=>,,x z
x,,z {
.,,{ |
UserId	,,| Ç
==
,,Ç Ñ
	getUserId
,,Ñ ç
)
,,ç é
.
,,é è
OrderByDescending
,,è †
(
,,† °
x
,,° ¢
=>
,,£ •
x
,,¶ ß
.
,,ß ®
BuyId
,,® ≠
)
,,≠ Æ
.
,,Æ Ø
Skip
,,Ø ≥
(
,,≥ ¥
(
,,¥ µ
page
,,µ π
-
,,∫ ª
$num
,,º Ω
??
,,æ ¿
$num
,,¡ ¬
)
,,¬ √
*
,,ƒ ≈
(
,,∆ «
rows
,,« À
??
,,Ã Œ
$num
,,œ —
)
,,— “
)
,,“ ”
.
,,” ‘
Take
,,‘ ÿ
(
,,ÿ Ÿ
rows
,,Ÿ ›
??
,,ﬁ ‡
$num
,,· „
)
,,„ ‰
.
,,‰ Â
AsNoTracking
,,Â Ò
(
,,Ò Ú
)
,,Ú Û
)
,,Û Ù
;
,,Ù ı
col-- 	
.--	 

Query--
 
=-- 
new-- 
NameValueCollection-- )
(--) *
Request--* 1
.--1 2
QueryString--2 =
)--= >
;--> ?
if.. 
(..	 

col..
 
... 
Query.. 
!=.. 
null.. 
).. 
{// 
col00 
=00 
new00 
Grid00 
<00 
Buy00 
>00 
(00  
_queryableRepository00 0
.000 1
Table001 6
.006 7
Include007 >
(00> ?
$str00? E
)00E F
.00F G
Include00G N
(00N O
$str00O U
)00U V
.00V W
Include00W ^
(00^ _
$str00_ f
)00f g
.00g h
Where00h m
(00m n
x00n o
=>00p r
x00s t
.00t u
UserId00u {
==00| ~
	getUserId	00 à
)
00à â
.
00â ä
OrderByDescending
00ä õ
(
00õ ú
x
00ú ù
=>
00û †
x
00° ¢
.
00¢ £
BuyId
00£ ®
)
00® ©
.
00© ™
AsNoTracking
00™ ∂
(
00∂ ∑
)
00∑ ∏
)
00∏ π
;
00π ∫
}11 
col66 	
.66	 

Columns66
 
.66 
Add66 
(66 
x66 
=>66 
x66 
.66 
Brand66 "
.66" #
	BrandName66# ,
)66, -
.66- .
Titled66. 4
(664 5
$str665 <
)66< =
;66= >
col77 	
.77	 

Columns77
 
.77 
Add77 
(77 
x77 
=>77 
x77 
.77 
Gift77 !
.77! "
Description77" -
)77- .
.77. /
Titled77/ 5
(775 6
$str776 >
)77> ?
;77? @
col88 	
.88	 

Columns88
 
.88 
Add88 
(88 
x88 
=>88 
x88 
.88 
UserId88 #
)88# $
.88$ %

RenderedAs88% /
(88/ 0
x880 1
=>882 4
x885 6
.886 7
User887 ;
.88; <
	FirstName88< E
+88F G
$str88H K
+88L M
x88N O
.88O P
User88P T
.88T U
LastName88U ]
)88] ^
.88^ _
Titled88_ e
(88e f
$str88f q
)88q r
;88r s
col99 	
.99	 

Columns99
 
.99 
Add99 
(99 
x99 
=>99 
x99 
.99 
	BuyAmount99 &
)99& '
.99' (
Titled99( .
(99. /
$str99/ >
)99> ?
;99? @
col:: 	
.::	 

Columns::
 
.:: 
Add:: 
(:: 
x:: 
=>:: 
x:: 
.:: 
BuyDate:: $
)::$ %
.::% &
Titled::& ,
(::, -
$str::- ;
)::; <
;::< =
col;; 	
.;;	 

Columns;;
 
.;; 
Add;; 
(;; 
x;; 
=>;; 
x;; 
.;; 

IsApproved;; '
);;' (
.;;( )
Titled;;) /
(;;/ 0
$str;;0 8
);;8 9
.;;9 :

RenderedAs;;: D
(;;D E
x;;E F
=>;;G I
x;;J K
.;;K L

IsApproved;;L V
==;;W Y
true;;Z ^
?;;_ `
$str;;a p
:;;q r
$str	;;s à
)
;;à â
;
;;â ä
col<< 	
.<<	 

Columns<<
 
.<< 
Add<< 
(<< 
x<< 
=><< 
x<< 
.<< 
BuyState<< %
)<<% &
.<<& '
Titled<<' -
(<<- .
$str<<. =
)<<= >
.<<> ?

RenderedAs<<? I
(<<I J
x<<J K
=><<L N
x<<O P
.<<P Q
BuyState<<Q Y
==<<Z \
BuyState<<] e
.<<e f
IncelemeBekliyor<<f v
?<<w x
$str	<<y å
:
<<ç é
x
<<è ê
.
<<ê ë
BuyState
<<ë ô
==
<<ö ú
BuyState
<<ù •
.
<<• ¶'
OnaylandiGonderimBekliyor
<<¶ ø
?
<<¿ ¡
$str
<<¬ „
:
<<‰ Â
x
<<Â Ê
.
<<Ê Á
BuyState
<<Á Ô
==
<<Ô Ò
BuyState
<<Ò ˘
.
<<˘ ˙"
HediyeKarsilanamiyor
<<˙ é
?
<<é è
$str
<<ê ∞
:
<<± ≤
$str
<<≥ ¿
)
<<¿ ¡
;
<<¡ ¬
col?? 	
.??	 

Pager??
 
=?? 
new?? 
	GridPager?? 
<??  
Buy??  #
>??# $
(??$ %
col??% (
)??( )
;??) *
col@@ 	
.@@	 


Processors@@
 
.@@ 
Add@@ 
(@@ 
col@@ 
.@@ 
Pager@@ "
)@@" #
;@@# $
colAA 	
.AA	 

PagerAA
 
.AA 
RowsPerPageAA 
=AA 
$numAA  
;AA  !
colBB 	
.BB	 

	EmptyTextBB
 
=BB 
$strBB 1
;BB1 2
foreachCC 
(CC 
IGridColumnCC 
columnCC !
inCC" $
colCC% (
.CC( )
ColumnsCC) 0
)CC0 1
{DD 
columnEE 
.EE 
IsFilterableEE 
=EE 
trueEE "
;EE" #
columnFF 
.FF 

IsSortableFF 
=FF 
trueFF  
;FF  !
}GG 
varHH 	
totalHH
 
=HH  
_totalRowsRepositoryHH &
.HH& '
TableHH' ,
.HH, -
WhereHH- 2
(HH2 3
xHH3 4
=>HH5 7
xHH8 9
.HH9 :
	TableNameHH: C
==HHD F
$strHHG M
)HHM N
.HHN O
AsNoTrackingHHO [
(HH[ \
)HH\ ]
.HH] ^
SelectHH^ d
(HHd e
xHHe f
=>HHg i
xHHj k
.HHk l
	TableRowsHHl u
)HHu v
.HHv w
FirstHHw |
(HH| }
)HH} ~
;HH~ 
ViewBagII 
.II 
	totalRowsII 
=II 
ConvertII !
.II! "
ToInt32II" )
(II) *
totalII* /
)II/ 0
;II0 1
returnJJ 
ViewJJ 
(JJ 
colJJ 
)JJ 
;JJ 
}KK 
[MM 
SecuredOperationMM 
(MM 
RolesMM 
=MM 
$strMM 1
)MM1 2
]MM2 3
publicNN 

ActionResultNN 
ApprovedBuyIndexNN (
(NN( )
Int32NN) .
?NN. /
pageNN0 4
,NN4 5
Int32NN6 ;
?NN; <
rowsNN= A
)NNA B
{OO 
IGridPP 
<PP 
BuyPP 
>PP 
colPP 
=PP 
newPP 
GridPP 
<PP  
BuyPP  #
>PP# $
(PP$ % 
_queryableRepositoryPP% 9
.PP9 :
TablePP: ?
.PP? @
IncludePP@ G
(PPG H
$strPPH N
)PPN O
.PPO P
IncludePPP W
(PPW X
$strPPX ^
)PP^ _
.PP_ `
IncludePP` g
(PPg h
$strPPh o
)PPo p
.PPp q
AsNoTrackingPPq }
(PP} ~
)PP~ 
.	PP Ä
Where
PPÄ Ö
(
PPÖ Ü
x
PPÜ á
=>
PPà ä
x
PPã å
.
PPå ç
BuyState
PPç ï
!=
PPñ ò
BuyState
PPô °
.
PP° ¢

Gonderildi
PP¢ ¨
&&
PP≠ Ø
x
PP∞ ±
.
PP± ≤
BuyState
PP≤ ∫
!=
PP∫ º
BuyState
PPº ƒ
.
PPƒ ≈"
HediyeKarsilanamiyor
PP≈ Ÿ
)
PPŸ ⁄
.
PP⁄ €
OrderByDescending
PP€ Ï
(
PPÏ Ì
x
PPÌ Ó
=>
PPÔ Ò
x
PPÚ Û
.
PPÛ Ù
BuyId
PPÙ ˘
)
PP˘ ˙
.
PP˙ ˚
Skip
PP˚ ˇ
(
PPˇ Ä
(
PPÄ Å
page
PPÅ Ö
-
PPÜ á
$num
PPà â
??
PPä å
$num
PPç é
)
PPé è
*
PPê ë
(
PPí ì
rows
PPì ó
??
PPò ö
$num
PPõ ù
)
PPù û
)
PPû ü
.
PPü †
Take
PP† §
(
PP§ •
rows
PP• ©
??
PP™ ¨
$num
PP≠ Ø
)
PPØ ∞
)
PP∞ ±
;
PP± ≤
colQQ 	
.QQ	 

QueryQQ
 
=QQ 
newQQ 
NameValueCollectionQQ )
(QQ) *
RequestQQ* 1
.QQ1 2
QueryStringQQ2 =
)QQ= >
;QQ> ?
ifSS 
(SS	 

colSS
 
.SS 
QuerySS 
!=SS 
nullSS 
)SS 
{TT 
colUU 
=UU 
newUU 
GridUU 
<UU 
BuyUU 
>UU 
(UU  
_queryableRepositoryUU 0
.UU0 1
TableUU1 6
.UU6 7
IncludeUU7 >
(UU> ?
$strUU? E
)UUE F
.UUF G
IncludeUUG N
(UUN O
$strUUO U
)UUU V
.UUV W
IncludeUUW ^
(UU^ _
$strUU_ f
)UUf g
.UUg h
AsNoTrackingUUh t
(UUt u
)UUu v
.UUv w
WhereUUw |
(UU| }
xUU} ~
=>	UU Å
x
UUÇ É
.
UUÉ Ñ
BuyState
UUÑ å
!=
UUç è
BuyState
UUê ò
.
UUò ô

Gonderildi
UUô £
&&
UU§ ¶
x
UUß ®
.
UU® ©
BuyState
UU© ±
!=
UU≤ ¥
BuyState
UUµ Ω
.
UUΩ æ"
HediyeKarsilanamiyor
UUæ “
)
UU“ ”
.
UU” ‘
OrderByDescending
UU‘ Â
(
UUÂ Ê
x
UUÊ Á
=>
UUË Í
x
UUÎ Ï
.
UUÏ Ì
BuyId
UUÌ Ú
)
UUÚ Û
)
UUÛ Ù
;
UUÙ ı
}VV 
colWW 	
.WW	 

ColumnsWW
 
.WW 
AddWW 
(WW 
xWW 
=>WW 
$strWW h
+WWi j
xWWk l
.WWl m
BuyIdWWm r
+WWs t
$strWWu ~
)WW~ 
.YY 	
EncodedYY	 
(YY 
falseYY 
)YY 
.YY 
TitledYY 
(YY 
$strYY )
)YY) *
.YY* +

FilterableYY+ 5
(YY5 6
falseYY6 ;
)YY; <
;YY< =
col\\ 	
.\\	 

Columns\\
 
.\\ 
Add\\ 
(\\ 
x\\ 
=>\\ 
x\\ 
.\\ 
Brand\\ "
.\\" #
	BrandName\\# ,
)\\, -
.\\- .
Titled\\. 4
(\\4 5
$str\\5 <
)\\< =
;\\= >
col]] 	
.]]	 

Columns]]
 
.]] 
Add]] 
(]] 
x]] 
=>]] 
x]] 
.]] 
Gift]] !
.]]! "
Description]]" -
)]]- .
.]]. /
Titled]]/ 5
(]]5 6
$str]]6 >
)]]> ?
;]]? @
col^^ 	
.^^	 

Columns^^
 
.^^ 
Add^^ 
(^^ 
x^^ 
=>^^ 
x^^ 
.^^ 
UserId^^ #
)^^# $
.^^$ %

RenderedAs^^% /
(^^/ 0
x^^0 1
=>^^2 4
x^^5 6
.^^6 7
User^^7 ;
.^^; <
	FirstName^^< E
+^^F G
$str^^H K
+^^L M
x^^N O
.^^O P
User^^P T
.^^T U
LastName^^U ]
)^^] ^
.^^^ _
Titled^^_ e
(^^e f
$str^^f q
)^^q r
;^^r s
col__ 	
.__	 

Columns__
 
.__ 
Add__ 
(__ 
x__ 
=>__ 
x__ 
.__ 
	BuyAmount__ &
)__& '
.__' (
Titled__( .
(__. /
$str__/ >
)__> ?
;__? @
col`` 	
.``	 

Columns``
 
.`` 
Add`` 
(`` 
x`` 
=>`` 
x`` 
.`` 
BuyDate`` $
)``$ %
.``% &
Titled``& ,
(``, -
$str``- ;
)``; <
;``< =
colaa 	
.aa	 

Columnsaa
 
.aa 
Addaa 
(aa 
xaa 
=>aa 
xaa 
.aa 

IsApprovedaa '
)aa' (
.aa( )
Titledaa) /
(aa/ 0
$straa0 8
)aa8 9
.aa9 :

RenderedAsaa: D
(aaD E
xaaE F
=>aaG I
xaaJ K
.aaK L

IsApprovedaaL V
==aaW Y
trueaaZ ^
?aa_ `
$straaa p
:aaq r
$str	aas à
)
aaà â
;
aaâ ä
colbb 	
.bb	 

Columnsbb
 
.bb 
Addbb 
(bb 
xbb 
=>bb 
xbb 
.bb 
BuyStatebb %
)bb% &
.bb& '
Titledbb' -
(bb- .
$strbb. =
)bb= >
.bb> ?

RenderedAsbb? I
(bbI J
xbbJ K
=>bbL N
xbbO P
.bbP Q
BuyStatebbQ Y
==bbZ \
BuyStatebb] e
.bbe f
IncelemeBekliyorbbf v
?bbw x
$str	bby å
:
bbç é
x
bbè ê
.
bbê ë
BuyState
bbë ô
==
bbö ú
BuyState
bbù •
.
bb• ¶'
OnaylandiGonderimBekliyor
bb¶ ø
?
bb¿ ¡
$str
bb¬ „
:
bb‰ Â
x
bbÊ Á
.
bbÁ Ë
BuyState
bbË 
==
bbÒ Û
BuyState
bbÙ ¸
.
bb¸ ˝"
HediyeKarsilanamiyor
bb˝ ë
?
bbí ì
$str
bbî ¥
:
bbµ ∂
$str
bb∑ ƒ
)
bbƒ ≈
;
bb≈ ∆
colcc 	
.cc	 

Pagercc
 
=cc 
newcc 
	GridPagercc 
<cc  
Buycc  #
>cc# $
(cc$ %
colcc% (
)cc( )
;cc) *
coldd 	
.dd	 


Processorsdd
 
.dd 
Adddd 
(dd 
coldd 
.dd 
Pagerdd "
)dd" #
;dd# $
colee 	
.ee	 

Pageree
 
.ee 
RowsPerPageee 
=ee 
$numee  
;ee  !
colff 	
.ff	 

	EmptyTextff
 
=ff 
$strff 1
;ff1 2
foreachgg 
(gg 
IGridColumngg 
columngg !
ingg" $
colgg% (
.gg( )
Columnsgg) 0
)gg0 1
{hh 
columnii 
.ii 
IsFilterableii 
=ii 
trueii "
;ii" #
columnjj 
.jj 

IsSortablejj 
=jj 
truejj  
;jj  !
}kk 
varll 	
totalll
 
=ll  
_totalRowsRepositoryll &
.ll& '
Tablell' ,
.ll, -
Wherell- 2
(ll2 3
xll3 4
=>ll5 7
xll8 9
.ll9 :
	TableNamell: C
==llD F
$strllG M
)llM N
.llN O
AsNoTrackingllO [
(ll[ \
)ll\ ]
.ll] ^
Selectll^ d
(lld e
xlle f
=>llg i
xllj k
.llk l
	TableRowslll u
)llu v
.llv w
Firstllw |
(ll| }
)ll} ~
;ll~ 
ViewBagmm 
.mm 
	totalRowsmm 
=mm 
Convertmm !
.mm! "
ToInt32mm" )
(mm) *
totalmm* /
)mm/ 0
;mm0 1
returnnn 
Viewnn 
(nn 
colnn 
)nn 
;nn 
}oo 
[qq 
SecuredOperationqq 
(qq 
Rolesqq 
=qq 
$strqq +
)qq+ ,
]qq, -
publicrr 

ActionResultrr 
Createrr 
(rr 
)rr  
{ss 
vartt 	
emptytt
 
=tt 
newtt 
BuyViewModeltt "
(tt" #
)tt# $
;tt$ %
varuu 	
datauu
 
=uu 
emptyuu 
.uu 
ToVMuu 
(uu 
)uu 
;uu 
returnvv 
Viewvv 
(vv 
datavv 
)vv 
;vv 
}ww 
[yy 
HttpPostyy 
]yy 
publiczz 

ActionResultzz 
Createzz 
(zz 
BuyViewModelzz +
buyzz, /
)zz/ 0
{{{ 
if|| 
(||	 

!||
 

ModelState|| 
.|| 
IsValid|| 
)|| 
{}} 
ErrorNotification~~ 
(~~ 
$str~~ -
)~~- .
;~~. /
return 
RedirectToAction 
(  
$str  (
)( )
;) *
}
ÄÄ 
_buyService
ÅÅ 
.
ÅÅ 
Add
ÅÅ 
(
ÅÅ 
new
ÅÅ 
Buy
ÅÅ 
{
ÇÇ 
}
ÜÜ 
)
ÜÜ 
;
ÜÜ 	!
SuccessNotification
àà 
(
àà 
$str
àà *
)
àà* +
;
àà+ ,
return
ââ 
RedirectToAction
ââ 
(
ââ 
$str
ââ (
)
ââ( )
;
ââ) *
}
ää 
[
åå 
SecuredOperation
åå 
(
åå 
Roles
åå 
=
åå 
$str
åå 1
)
åå1 2
]
åå2 3
public
çç 

ActionResult
çç 
Edit
çç 
(
çç 
int
çç  
id
çç! #
)
çç# $
{
éé 
var
èè 	
data
èè
 
=
èè 
AutoMapperHelper
èè !
.
èè! " 
MapToSameViewModel
èè" 4
<
èè4 5
Buy
èè5 8
,
èè8 9
BuyViewModel
èè: F
>
èèF G
(
èèG H
_buyService
èèH S
.
èèS T
GetById
èèT [
(
èè[ \
id
èè\ ^
)
èè^ _
)
èè_ `
;
èè` a
return
êê 
View
êê 
(
êê 
data
êê 
.
êê 
ToVM
êê 
(
êê 
)
êê 
)
êê 
;
êê 
}
ëë 
[
ìì 
HttpPost
ìì 
]
ìì 
public
îî 

ActionResult
îî 
Edit
îî 
(
îî 
BuyViewModel
îî )
buy
îî* -
)
îî- .
{
ïï 
var
ññ 	
brand
ññ
 
=
ññ &
_giftQueryableRepository
ññ *
.
ññ* +
Table
ññ+ 0
.
ññ0 1
AsNoTracking
ññ1 =
(
ññ= >
)
ññ> ?
.
ññ? @
FirstOrDefault
ññ@ N
(
ññN O
x
ññO P
=>
ññQ S
x
ññT U
.
ññU V
GiftId
ññV \
==
ññ] _
buy
ññ` c
.
ññc d
GiftId
ññd j
)
ññj k
;
ññk l
var
óó 	
userMail
óó
 
=
óó &
_userQueryableRepository
óó -
.
óó- .
Table
óó. 3
.
óó3 4
AsNoTracking
óó4 @
(
óó@ A
)
óóA B
.
óóB C
FirstOrDefault
óóC Q
(
óóQ R
x
óóR S
=>
óóT V
x
óóW X
.
óóX Y
UserId
óóY _
==
óó` b
buy
óóc f
.
óóf g
UserId
óóg m
)
óóm n
;
óón o
if
òò 
(
òò	 

!
òò
 

ModelState
òò 
.
òò 
IsValid
òò 
)
òò 
{
ôô 
ErrorNotification
öö 
(
öö 
$str
öö +
)
öö+ ,
;
öö, -
return
õõ 
RedirectToAction
õõ 
(
õõ  
$str
õõ  *
)
õõ* +
;
õõ+ ,
}
úú 
try
ùù 	
{
ûû 
if
üü 

(
üü 
buy
üü 
.
üü 
BuyState
üü 
==
üü 
BuyState
üü $
.
üü$ %
IncelemeBekliyor
üü% 5
)
üü5 6
{
†† 	
ErrorNotification
°°
 
(
°° 
$str
°° {
)
°°{ |
;
°°| }
return
¢¢
 
RedirectToAction
¢¢ !
(
¢¢! "
$str
¢¢" ,
)
¢¢, -
;
¢¢- .
}
££ 	
if
•• 

(
•• 
buy
•• 
.
•• 
BuyState
•• 
==
•• 
BuyState
•• $
.
••$ %"
HediyeKarsilanamiyor
••% 9
)
••9 :
{
¶¶ 	
_buyService
®®
 
.
®® 
Update
®® 
(
®® 
new
®®  
Buy
®®! $
{
©©
 
UserId
™™ 
=
™™ 
buy
™™ 
.
™™ 
UserId
™™ 
,
™™  
ApprovedDate
´´ 
=
´´ 
DateTime
´´ #
.
´´# $
Now
´´$ '
,
´´' (
	BuyAmount
¨¨ 
=
¨¨ 
buy
¨¨ 
.
¨¨ 
	BuyAmount
¨¨ %
,
¨¨% &
BuyDate
≠≠ 
=
≠≠ 
buy
≠≠ 
.
≠≠ 
BuyDate
≠≠ !
,
≠≠! "

EditUserId
ÆÆ 
=
ÆÆ 
Convert
ÆÆ  
.
ÆÆ  !
ToInt32
ÆÆ! (
(
ÆÆ( )
GeneralHelpers
ÆÆ) 7
.
ÆÆ7 8
	GetUserId
ÆÆ8 A
(
ÆÆA B
)
ÆÆB C
)
ÆÆC D
,
ÆÆD E
GiftId
ØØ 
=
ØØ 
buy
ØØ 
.
ØØ 
GiftId
ØØ 
,
ØØ  

IsApproved
∞∞ 
=
∞∞ 
false
∞∞ 
,
∞∞ 
BuyState
±± 
=
±± 
buy
±± 
.
±± 
BuyState
±± #
,
±±# $
NotApproved
≤≤ 
=
≤≤ 
true
≤≤ 
,
≤≤ 
NotApprovedDate
≥≥ 
=
≥≥ 
DateTime
≥≥ &
.
≥≥& '
Now
≥≥' *
,
≥≥* +
BrandId
¥¥ 
=
¥¥ 
brand
¥¥ 
.
¥¥ 
BrandId
¥¥ #
,
¥¥# $
Reason
µµ 
=
µµ 
$str
µµ Q
,
µµQ R
BuyId
∂∂ 
=
∂∂ 
buy
∂∂ 
.
∂∂ 
BuyId
∂∂ 
}
∑∑
 
)
∑∑ 
;
∑∑ 
var
ππ
 

mailEnable
ππ 
=
ππ 
System
ππ !
.
ππ! "
Configuration
ππ" /
.
ππ/ 0"
ConfigurationManager
ππ0 D
.
ππD E
AppSettings
ππE P
[
ππP Q
$str
ππQ ]
]
ππ] ^
;
ππ^ _
if
∫∫
 
(
∫∫ 

mailEnable
∫∫ 
==
∫∫ 
$str
∫∫  
)
∫∫  !
{
ªª
 
var
ºº 
mail
ºº 
=
ºº 

MailHelper
ºº !
.
ºº! "
SendMail
ºº" *
(
ºº* +
$"
ºº+ -∆
∂Hediye ƒ∞steƒüiniz Kar≈üƒ±lanamƒ±yor, Harcadƒ±ƒüƒ±nƒ±z Puanlarƒ±n ƒ∞adesi Ger√ßekle≈ütirildi.<br/>Durum i√ßin ger√ßekten √ßok √ºzg√ºn√ºz. L√ºtfen bayipuan.com √ºzerinde takip ediniz.ºº- Œ
"ººŒ œ
,ººœ –
$"ºº— ”
{ºº” ‘
userMailºº‘ ‹
.ºº‹ ›
Emailºº› ‚
}ºº‚ „
"ºº„ ‰
,ºº‰ Â
$strººÊ ô
,ººô ö
trueººõ ü
)ººü †
;ºº† °
if
ΩΩ 
(
ΩΩ 
mail
ΩΩ 
)
ΩΩ 
{
ææ !
SuccessNotification
øø !
(
øø! "
$str
øø" 3
)
øø3 4
;
øø4 5
}
¿¿ 
else
¡¡ 
{
¬¬ 
ErrorNotification
√√ 
(
√√  
$str
√√  5
)
√√5 6
;
√√6 7
}
ƒƒ 
}
≈≈
 
ErrorNotification
»»
 
(
»» 
$str»» Å
)»»Å Ç
;»»Ç É
return
……
 
RedirectToAction
…… !
(
……! "
$str
……" ,
)
……, -
;
……- .
}
   	
_buyService
ÀÀ 
.
ÀÀ 
Update
ÀÀ 
(
ÀÀ 
new
ÀÀ 
Buy
ÀÀ "
{
ÃÃ 	
UserId
ÕÕ
 
=
ÕÕ 
buy
ÕÕ 
.
ÕÕ 
UserId
ÕÕ 
,
ÕÕ 
ApprovedDate
ŒŒ
 
=
ŒŒ 
DateTime
ŒŒ !
.
ŒŒ! "
Now
ŒŒ" %
,
ŒŒ% &
	BuyAmount
œœ
 
=
œœ 
buy
œœ 
.
œœ 
	BuyAmount
œœ #
,
œœ# $
BuyDate
––
 
=
–– 
buy
–– 
.
–– 
BuyDate
–– 
,
––  

EditUserId
——
 
=
—— 
Convert
—— 
.
—— 
ToInt32
—— &
(
——& '
GeneralHelpers
——' 5
.
——5 6
	GetUserId
——6 ?
(
——? @
)
——@ A
)
——A B
,
——B C
GiftId
““
 
=
““ 
buy
““ 
.
““ 
GiftId
““ 
,
““ 

IsApproved
””
 
=
”” 
true
”” 
,
”” 
BuyState
‘‘
 
=
‘‘ 
buy
‘‘ 
.
‘‘ 
BuyState
‘‘ !
,
‘‘! "
BrandId
’’
 
=
’’ 
brand
’’ 
.
’’ 
BrandId
’’ !
,
’’! "
BuyId
÷÷
 
=
÷÷ 
buy
÷÷ 
.
÷÷ 
BuyId
÷÷ 
}
◊◊ 	
)
◊◊	 

;
◊◊
 
var
ÿÿ 
mailEnablex
ÿÿ 
=
ÿÿ 
System
ÿÿ  
.
ÿÿ  !
Configuration
ÿÿ! .
.
ÿÿ. /"
ConfigurationManager
ÿÿ/ C
.
ÿÿC D
AppSettings
ÿÿD O
[
ÿÿO P
$str
ÿÿP \
]
ÿÿ\ ]
;
ÿÿ] ^
if
ŸŸ 

(
ŸŸ 
mailEnablex
ŸŸ 
==
ŸŸ 
$str
ŸŸ !
)
ŸŸ! "
{
⁄⁄ 	
var
€€
 
Onaymail
€€ 
=
€€ 

MailHelper
‹‹ 
.
‹‹ 
SendMail
‹‹ 
(
‹‹  
$"
‹‹  "c
UTebrikler Hediye ƒ∞steƒüiniz Onaylandƒ±. L√ºtfen bayipuan.com √ºzerinde takip ediniz.
‹‹" r
"
‹‹r s
,
‹‹s t
$"
›› 
{
›› 
userMail
›› 
.
›› 
Email
›› 
}
››  
"
››  !
,
››! "
$str
››# J
,
››J K
true
››L P
)
››P Q
;
››Q R
if
ﬁﬁ
 
(
ﬁﬁ 
Onaymail
ﬁﬁ 
)
ﬁﬁ 
{
ﬂﬂ
 !
SuccessNotification
‡‡ 
(
‡‡  
$str
‡‡  1
)
‡‡1 2
;
‡‡2 3
}
··
 
else
‚‚
 
{
„„
 
ErrorNotification
‰‰ 
(
‰‰ 
$str
‰‰ 3
)
‰‰3 4
;
‰‰4 5
}
ÂÂ
 
}
ÊÊ 	!
SuccessNotification
ËË 
(
ËË 
$str
ËË 7
)
ËË7 8
;
ËË8 9
return
ÈÈ 
RedirectToAction
ÈÈ 
(
ÈÈ  
$str
ÈÈ  *
)
ÈÈ* +
;
ÈÈ+ ,
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ 
{
ÏÏ 
return
ÌÌ 
View
ÌÌ 
(
ÌÌ 
ex
ÌÌ 
.
ÌÌ 
ToString
ÌÌ 
(
ÌÌ  
)
ÌÌ  !
)
ÌÌ! "
;
ÌÌ" #
}
ÓÓ 
}
ÔÔ 
[
ÒÒ 
SecuredOperation
ÒÒ 
(
ÒÒ 
Roles
ÒÒ 
=
ÒÒ 
$str
ÒÒ +
)
ÒÒ+ ,
]
ÒÒ, -
public
ÚÚ 

ActionResult
ÚÚ 
Delete
ÚÚ 
(
ÚÚ 
int
ÚÚ "
id
ÚÚ# %
,
ÚÚ% &
Buy
ÚÚ' *
buy
ÚÚ+ .
)
ÚÚ. /
{
ÛÛ 
var
ÙÙ 	
data
ÙÙ
 
=
ÙÙ 
AutoMapperHelper
ÙÙ !
.
ÙÙ! " 
MapToSameViewModel
ÙÙ" 4
<
ÙÙ4 5
Buy
ÙÙ5 8
,
ÙÙ8 9
BuyViewModel
ÙÙ: F
>
ÙÙF G
(
ÙÙG H
_buyService
ÙÙH S
.
ÙÙS T
GetById
ÙÙT [
(
ÙÙ[ \
id
ÙÙ\ ^
)
ÙÙ^ _
)
ÙÙ_ `
;
ÙÙ` a
return
ıı 
View
ıı 
(
ıı 
data
ıı 
.
ıı 
ToVM
ıı 
(
ıı 
)
ıı 
)
ıı 
;
ıı 
}
ˆˆ 
[
¯¯ 
HttpPost
¯¯ 
]
¯¯ 
public
˘˘ 

ActionResult
˘˘ 
Delete
˘˘ 
(
˘˘ 
int
˘˘ "
id
˘˘# %
)
˘˘% &
{
˙˙ 
try
˚˚ 	
{
¸¸ 
_buyService
˝˝ 
.
˝˝ 
Delete
˝˝ 
(
˝˝ 
_buyService
˝˝ &
.
˝˝& '
GetById
˝˝' .
(
˝˝. /
id
˝˝/ 1
)
˝˝1 2
)
˝˝2 3
;
˝˝3 4!
SuccessNotification
˛˛ 
(
˛˛ 
$str
˛˛ +
)
˛˛+ ,
;
˛˛, -
return
ˇˇ 
RedirectToAction
ˇˇ 
(
ˇˇ  
$str
ˇˇ  *
)
ˇˇ* +
;
ˇˇ+ ,
}
ÄÄ 
catch
ÅÅ 
{
ÇÇ 
return
ÉÉ 
View
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÑÑ 
}
ÖÖ 
}
ÜÜ 
}áá °d
OE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\BuyUserController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
BuyUserController  
:! "
BaseController# 1
{ 
private 
readonly  
IQueryableRepository )
<) *
Gift* .
>. /$
_giftQueryableRepository0 H
;H I
private 
readonly  
IQueryableRepository )
<) *
Brand* /
>/ 0%
_brandQueryableRepository1 J
;J K
private 
readonly  
IQueryableRepository )
<) *
Category* 2
>2 3(
_categoryQueryableRepository4 P
;P Q
private 
readonly  
IQueryableRepository )
<) *
User* .
>. /$
_userQueryableRepository0 H
;H I
private 
readonly 
IGiftService !
_giftService" .
;. /
private 
readonly 
IBuyService  
_buyService! ,
;, -
public 

BuyUserController 
(  
IQueryableRepository 1
<1 2
Gift2 6
>6 7#
giftQueryableRepository8 O
,O P 
IQueryableRepositoryQ e
<e f
Brandf k
>k l%
brandQueryableRepository	m Ö
,
Ö Ü"
IQueryableRepository
á õ
<
õ ú
Category
ú §
>
§ •)
categoryQueryableRepository
¶ ¡
,
¡ ¬
IGiftService
√ œ
giftService
– €
,
€ ‹
IBuyService
› Ë

buyService
È Û
,
Û Ù"
IQueryableRepository
ı â
<
â ä
User
ä é
>
é è%
userQueryableRepository
ê ß
)
ß ®
{ $
_giftQueryableRepository 
=  #
giftQueryableRepository! 8
;8 9%
_brandQueryableRepository 
=  !$
brandQueryableRepository" :
;: ;(
_categoryQueryableRepository "
=# $'
categoryQueryableRepository% @
;@ A
_giftService 
= 
giftService  
;  !
_buyService   
=   

buyService   
;   $
_userQueryableRepository!! 
=!!  #
userQueryableRepository!!! 8
;!!8 9
}"" 
[## 
SecuredOperation## 
(## 
Roles## 
=## 
$str## 6
)##6 7
]##7 8
public%% 

ActionResult%% 
Index%% 
(%% 
int%% !
?%%! "
id%%# %
)%%% &
{&& 
var(( 	
dataList((
 
=(( $
_giftQueryableRepository(( -
.((- .
Table((. 3
.((3 4
Include((4 ;
(((; <
$str((< F
)((F G
.((G H
Include((H O
(((O P
$str((P W
)((W X
.((X Y
ToList((Y _
(((_ `
)((` a
;((a b
var** 	
list**
 
=** 
dataList** 
.** 
Where** 
(**  
x**  !
=>**" $
x**% &
.**& '
IsActive**' /
)**/ 0
.**0 1
GroupBy**1 8
(**8 9
x**9 :
=>**; =
x**> ?
.**? @
BrandId**@ G
)**G H
.**H I
OrderBy**I P
(**P Q
x**Q R
=>**S U
x**V W
.**W X
Key**X [
)**[ \
.**\ ]
ToList**] c
(**c d
)**d e
;**e f
var++ 	
listId++
 
=++ 
dataList++ 
.++ 
Where++ !
(++! "
x++" #
=>++$ &
x++' (
.++( )
IsActive++) 1
&&++2 4
x++5 6
.++6 7
BrandId++7 >
==++? A
id++B D
)++D E
.++E F
GroupBy++F M
(++M N
x++N O
=>++P R
x++S T
.++T U
BrandId++U \
)++\ ]
.++] ^
OrderBy++^ e
(++e f
x++f g
=>++h j
x++k l
.++l m
Key++m p
)++p q
.,, 	
ToList,,	 
(,, 
),, 
;,, 
if-- 
(--	 

id--
 
==-- 
null-- 
)-- 
{.. 
return// 
View// 
(// 
list// 
)// 
;// 
}00 
return11 
View11 
(11 
listId11 
)11 
;11 
}22 
public33 

ActionResult33 
CategoryIndex33 %
(33% &
int33& )
?33) *
id33+ -
)33- .
{44 
var66 	
dataList66
 
=66 $
_giftQueryableRepository66 -
.66- .
Table66. 3
.663 4
Include664 ;
(66; <
$str66< F
)66F G
.66G H
Include66H O
(66O P
$str66P W
)66W X
.66X Y
AsNoTracking66Y e
(66e f
)66f g
.66g h
ToList66h n
(66n o
)66o p
;66p q
var88 	
list88
 
=88 
dataList88 
.88 
Where88 
(88  
x88  !
=>88" $
x88% &
.88& '
IsActive88' /
)88/ 0
.880 1
GroupBy881 8
(888 9
x889 :
=>88; =
x88> ?
.88? @

CategoryId88@ J
)88J K
.88K L
OrderBy88L S
(88S T
x88T U
=>88V X
x88Y Z
.88Z [
Key88[ ^
)88^ _
.88_ `
ToList88` f
(88f g
)88g h
;88h i
var99 	
listId99
 
=99 
dataList99 
.99 
Where99 !
(99! "
x99" #
=>99$ &
x99' (
.99( )
IsActive99) 1
&&992 4
x995 6
.996 7

CategoryId997 A
==99B D
id99E G
)99G H
.99H I
GroupBy99I P
(99P Q
x99Q R
=>99S U
x99V W
.99W X
BrandId99X _
)99_ `
.99` a
OrderBy99a h
(99h i
x99i j
=>99k m
x99n o
.99o p
Key99p s
)99s t
.:: 	
ToList::	 
(:: 
):: 
;:: 
if;; 
(;;	 

id;;
 
==;; 
null;; 
);; 
{<< 
return== 
View== 
(== 
list== 
)== 
;== 
}>> 
return?? 
View?? 
(?? 
listId?? 
)?? 
;?? 
}@@ 
[AA 
HttpPostAA 
]AA 
[BB 
SecuredOperationBB 
(BB 
RolesBB 
=BB 
$strBB 6
)BB6 7
]BB7 8
publicCC 

ActionResultCC 
BuyGiftCC 
(CC  
intCC  #
idCC$ &
)CC& '
{DD 
varEE 	
loggedUserIdEE
 
=EE 
ConvertEE  
.EE  !
ToInt32EE! (
(EE( )
GeneralHelpersEE) 7
.EE7 8
	GetUserIdEE8 A
(EEA B
)EEB C
)EEC D
;EED E
varFF 	
userMailFF
 
=FF $
_userQueryableRepositoryFF -
.FF- .
TableFF. 3
.FF3 4
AsNoTrackingFF4 @
(FF@ A
)FFA B
.FFB C
FirstOrDefaultFFC Q
(FFQ R
xFFR S
=>FFT V
xFFW X
.FFX Y
UserIdFFY _
==FF` b
loggedUserIdFFc o
)FFo p
;FFp q
varGG 	

buyingGiftGG
 
=GG 
_giftServiceGG #
.GG# $
GetByIdGG$ +
(GG+ ,
idGG, .
)GG. /
;GG/ 0
varHH 	
remainingPointHH
 
=HH 
GeneralHelpersHH )
.HH) *
GetRemainingPointHH* ;
(HH; <
)HH< =
;HH= >
varJJ 	
brandJJ
 
=JJ $
_giftQueryableRepositoryJJ *
.JJ* +
TableJJ+ 0
.JJ0 1
IncludeJJ1 8
(JJ8 9
$strJJ9 @
)JJ@ A
.JJA B
AsNoTrackingJJB N
(JJN O
)JJO P
.JJP Q
FirstOrDefaultJJQ _
(JJ_ `
xJJ` a
=>JJb d
xJJe f
.JJf g
GiftIdJJg m
==JJn p
idJJq s
)JJs t
;JJt u
varKK 	
brandIdKK
 
=KK %
_brandQueryableRepositoryKK -
.KK- .
TableKK. 3
.KK3 4
FirstOrDefaultKK4 B
(KKB C
xKKC D
=>KKE G
xKKH I
.KKI J
BrandIdKKJ Q
==KKR T
brandKKU Z
.KKZ [
BrandIdKK[ b
)KKb c
;KKc d
ifLL 
(LL	 


buyingGiftLL
 
.LL 
	GiftPointLL 
>LL  
remainingPointLL! /
)LL/ 0
{MM 
ErrorNotificationNN 
(NN 
$str	NN í
)
NNí ì
;
NNì î
returnOO 
RedirectToActionOO 
(OO  
$strOO  '
,OO' (
$strOO) 2
)OO2 3
;OO3 4
}PP 
_buyServiceQQ 
.QQ 
AddQQ 
(QQ 
newQQ 
BuyQQ 
{RR 
GiftIdSS 
=SS 

buyingGiftSS 
.SS 
GiftIdSS "
,SS" #
UserIdTT 
=TT 
ConvertTT 
.TT 
ToInt32TT  
(TT  !
GeneralHelpersTT! /
.TT/ 0
	GetUserIdTT0 9
(TT9 :
)TT: ;
)TT; <
,TT< =
BuyDateUU 
=UU 
DateTimeUU 
.UU 
NowUU 
,UU 
	BuyAmountVV 
=VV 
$numVV 
,VV 
BrandIdWW 
=WW 
brandWW 
.WW 
BrandIdWW 
,WW  

IsApprovedXX 
=XX 
trueXX 
,XX 
BuyStateYY 
=YY 
BuyStateYY 
.YY 
IncelemeBekliyorYY ,
}ZZ 
)ZZ 
;ZZ 	
var[[ 	

mailEnable[[
 
=[[ 
System[[ 
.[[ 
Configuration[[ +
.[[+ , 
ConfigurationManager[[, @
.[[@ A
AppSettings[[A L
[[[L M
$str[[M Y
][[Y Z
;[[Z [
if\\ 
(\\	 


mailEnable\\
 
==\\ 
$str\\ 
)\\ 
{]] 
var^^ 
mail^^ 
=^^ 

MailHelper^^ 
.^^ 
SendMail^^ &
(^^& '
$"__
 
<strong>__ 
{__ 
userMail__ 
.__ 
	FirstName__ '
+__( )
$str__* -
+__. /
userMail__0 8
.__8 9
LastName__9 A
}__A B1
%</strong> Kullanƒ±cƒ±sƒ±nƒ±n <strong>__B c
{__c d
brandId__d k
.__k l
	BrandName__l u
+__v w
$str__x {
+__| }

buyingGift	__~ à
.
__à â
Description
__â î
}
__î ïd
V</strong> i√ßin Hediye ƒ∞steƒüi var.<br/> L√ºtfen bayipuan.com √ºzerinde takip ediniz.
__ï Ê
"
__Ê Á
,
__Á Ë
$"``
 
kerem@hemosoft.com`` 
"`` 
,``  
$str``! >
,``> ?
true``@ D
)``D E
;``E F
ifaa 

(aa 
mailaa 
)aa 
{bb 	
SuccessNotificationcc
 
(cc 
$strcc /
)cc/ 0
;cc0 1
}dd 	
elseee 
{ff 	
ErrorNotificationgg
 
(gg 
$strgg 1
)gg1 2
;gg2 3
}hh 	
}ii 
SuccessNotificationkk 
(kk 
$str	kk Ñ
)
kkÑ Ö
;
kkÖ Ü
returnll 
RedirectToActionll 
(ll 
$strll %
,ll% &
$strll' 0
)ll0 1
;ll1 2
}mm 
}nn 
}oo ¥f
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\CampaignController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
CampaignController !
:" #
BaseController$ 2
{ 
private 
readonly 
ICampaignService %
_campaignService& 6
;6 7
private 
readonly  
IQueryableRepository )
<) *
Campaign* 2
>2 3 
_queryableRepository4 H
;H I
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

CampaignController 
( 
ICampaignService .
campaignService/ >
,> ? 
IQueryableRepository@ T
<T U
CampaignU ]
>] ^
queryableRepository_ r
,r s!
IQueryableRepository	t à
<
à â
vwRP_StockCount
â ò
>
ò ô!
totalRowsRepository
ö ≠
)
≠ Æ
{ 
_campaignService 
= 
campaignService (
;( ) 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
} 
[!! 
SecuredOperation!! 
(!! 
Roles!! 
=!! 
$str!! 1
)!!1 2
]!!2 3
public"" 

ActionResult"" 
CampaignIndex"" %
(""% &
Int32""& +
?""+ ,
page""- 1
,""1 2
Int32""3 8
?""8 9
rows"": >
)""> ?
{## 
IGrid%% 
<%% 
Campaign%% 
>%% 
col%% 
=%% 
new%% 
Grid%%  $
<%%$ %
Campaign%%% -
>%%- .
(%%. / 
_queryableRepository%%/ C
.%%C D
Table%%D I
.%%I J
OrderByDescending%%J [
(%%[ \
x%%\ ]
=>%%^ `
x%%a b
.%%b c

CampaignId%%c m
)%%m n
.%%n o
Skip%%o s
(%%s t
(%%t u
page%%u y
-%%z {
$num%%| }
??	%%~ Ä
$num
%%Å Ç
)
%%Ç É
*
%%Ñ Ö
(
%%Ü á
rows
%%á ã
??
%%å é
$num
%%è ë
)
%%ë í
)
%%í ì
.
%%ì î
Take
%%î ò
(
%%ò ô
rows
%%ô ù
??
%%û †
$num
%%° £
)
%%£ §
.
%%§ •
AsNoTracking
%%• ±
(
%%± ≤
)
%%≤ ≥
)
%%≥ ¥
;
%%¥ µ
col&& 	
.&&	 

Query&&
 
=&& 
new&& 
NameValueCollection&& )
(&&) *
Request&&* 1
.&&1 2
QueryString&&2 =
)&&= >
;&&> ?
if(( 
(((	 

col((
 
.(( 
Query(( 
!=(( 
null(( 
)(( 
{)) 
col** 
=** 
new** 
Grid** 
<** 
Campaign** 
>**  
(**  ! 
_queryableRepository**! 5
.**5 6
Table**6 ;
.**; <
OrderByDescending**< M
(**M N
x**N O
=>**P R
x**S T
.**T U

CampaignId**U _
)**_ `
.**` a
AsNoTracking**a m
(**m n
)**n o
)**o p
;**p q
}++ 
col,, 	
.,,	 

Columns,,
 
.,, 
Add,, 
(,, 
x,, 
=>,, 
$str,, h
+,,i j
x,,k l
.,,l m

CampaignId,,m w
+,,x y
$str	,,z É
+
,,Ñ Ö
$str-- p
+--q r
x--s t
.--t u

CampaignId--u 
+
--Ä Å
$str
--Ç ã
)
--ã å
...
 
Encoded.. 
(.. 
false.. 
).. 
... 
Titled..  
(..  !
$str..! +
)..+ ,
..., -

Filterable..- 7
(..7 8
false..8 =
)..= >
;..> ?
col00 	
.00	 

Columns00
 
.00 
Add00 
(00 
x00 
=>00 
x00 
.00 

CampaignId00 '
)00' (
.00( )
Titled00) /
(00/ 0
$str000 =
)00= >
.00> ?
MultiFilterable00? N
(00N O
true00O S
)00S T
;00T U
col11 	
.11	 

Columns11
 
.11 
Add11 
(11 
x11 
=>11 
x11 
.11 
CampaignName11 )
)11) *
.11* +
Titled11+ 1
(111 2
$str112 @
)11@ A
.11A B
MultiFilterable11B Q
(11Q R
true11R V
)11V W
;11W X
col33 	
.33	 

Pager33
 
=33 
new33 
	GridPager33 
<33  
Campaign33  (
>33( )
(33) *
col33* -
)33- .
;33. /
col44 	
.44	 


Processors44
 
.44 
Add44 
(44 
col44 
.44 
Pager44 "
)44" #
;44# $
col55 	
.55	 

Pager55
 
.55 
RowsPerPage55 
=55 
$num55  
;55  !
col66 	
.66	 

	EmptyText66
 
=66 
$str66 1
;661 2
foreach77 
(77 
IGridColumn77 
column77 !
in77" $
col77% (
.77( )
Columns77) 0
)770 1
{88 
column99 
.99 
IsFilterable99 
=99 
true99 "
;99" #
column:: 
.:: 

IsSortable:: 
=:: 
true::  
;::  !
};; 
var<< 	
total<<
 
=<<  
_totalRowsRepository<< &
.<<& '
Table<<' ,
.<<, -
AsNoTracking<<- 9
(<<9 :
)<<: ;
.<<; <
Where<<< A
(<<A B
x<<B C
=><<D F
x<<G H
.<<H I
	TableName<<I R
==<<S U
$str<<V a
)<<a b
.<<b c
Select<<c i
(<<i j
x<<j k
=><<l n
x<<o p
.<<p q
	TableRows<<q z
)<<z {
.<<{ |
First	<<| Å
(
<<Å Ç
)
<<Ç É
;
<<É Ñ
ViewBag== 
.== 
	totalRows== 
=== 
Convert== !
.==! "
ToInt32==" )
(==) *
total==* /
)==/ 0
;==0 1
return>> 
View>> 
(>> 
col>> 
)>> 
;>> 
}?? 
[AA 
SecuredOperationAA 
(AA 
RolesAA 
=AA 
$strAA 1
)AA1 2
]AA2 3
publicBB 

ActionResultBB 
CreateBB 
(BB 
)BB  
{CC 
varDD 	
emptyDD
 
=DD 
newDD 
CampaignViewModelDD '
(DD' (
)DD( )
;DD) *
varEE 	
dataEE
 
=EE 
emptyEE 
.EE 
ToVMEE 
(EE 
)EE 
;EE 
returnFF 
ViewFF 
(FF 
dataFF 
)FF 
;FF 
}GG 
[II 
HttpPostII 
]II 
publicJJ 

ActionResultJJ 
CreateJJ 
(JJ 
CampaignViewModelJJ 0
campaignJJ1 9
)JJ9 :
{KK 
ifLL 
(LL	 

!LL
 

ModelStateLL 
.LL 
IsValidLL 
)LL 
{MM 
ErrorNotificationNN 
(NN 
$strNN -
)NN- .
;NN. /
returnOO 
RedirectToActionOO 
(OO  
$strOO  (
)OO( )
;OO) *
}PP 
_campaignServiceQQ 
.QQ 
AddQQ 
(QQ 
newQQ 
CampaignQQ '
{RR 
CampaignNameSS 
=SS 
campaignSS 
.SS  
CampaignNameSS  ,
,SS, -
CampaignImageTT 
=TT 
campaignTT  
.TT  !
CampaignImageTT! .
,TT. /
CampaignImageExtUU 
=UU 
$strUU !
}WW 
)WW 
;WW 	
SuccessNotificationXX 
(XX 
$strXX *
)XX* +
;XX+ ,
returnYY 
RedirectToActionYY 
(YY 
$strYY -
)YY- .
;YY. /
}ZZ 
[\\ 
SecuredOperation\\ 
(\\ 
Roles\\ 
=\\ 
$str\\ 1
)\\1 2
]\\2 3
public]] 

ActionResult]] 
Edit]] 
(]] 
int]]  
id]]! #
)]]# $
{^^ 
var__ 	
data__
 
=__ 
AutoMapperHelper__ !
.__! "
MapToSameViewModel__" 4
<__4 5
Campaign__5 =
,__= >
CampaignViewModel__? P
>__P Q
(__Q R
_campaignService__R b
.__b c
GetById__c j
(__j k
id__k m
)__m n
)__n o
;__o p
return`` 
View`` 
(`` 
data`` 
.`` 
ToVM`` 
(`` 
)`` 
)`` 
;`` 
}aa 
[cc 
HttpPostcc 
]cc 
publicdd 

ActionResultdd 
Editdd 
(dd 
CampaignViewModeldd .
campaigndd/ 7
)dd7 8
{ee 
tryff 	
{gg 
_campaignServiceii 
.ii 
Updateii 
(ii  
newii  #
Campaignii$ ,
{jj 	
CampaignNamekk
 
=kk 
campaignkk !
.kk! "
CampaignNamekk" .
,kk. /
CampaignImagell
 
=ll 
campaignll "
.ll" #
CampaignImagell# 0
,ll0 1
CampaignImageExtmm
 
=mm 
$strmm #
,mm# $

CampaignIdnn
 
=nn 
campaignnn 
.nn  

CampaignIdnn  *
}oo 	
)oo	 

;oo
 
SuccessNotificationpp 
(pp 
$strpp /
)pp/ 0
;pp0 1
returnqq 
RedirectToActionqq 
(qq  
$strqq  /
)qq/ 0
;qq0 1
}rr 
catchss 
{tt 
returnuu 
Viewuu 
(uu 
)uu 
;uu 
}vv 
}ww 
[yy 
SecuredOperationyy 
(yy 
Rolesyy 
=yy 
$stryy +
)yy+ ,
]yy, -
publiczz 

ActionResultzz 
Deletezz 
(zz 
intzz "
idzz# %
,zz% &
Campaignzz' /
campaignzz0 8
)zz8 9
{{{ 
var|| 	
data||
 
=|| 
AutoMapperHelper|| !
.||! "
MapToSameViewModel||" 4
<||4 5
Campaign||5 =
,||= >
CampaignViewModel||? P
>||P Q
(||Q R
_campaignService||R b
.||b c
GetById||c j
(||j k
id||k m
)||m n
)||n o
;||o p
return}} 
View}} 
(}} 
data}} 
.}} 
ToVM}} 
(}} 
)}} 
)}} 
;}} 
}~~ 
[
ÄÄ 
HttpPost
ÄÄ 
]
ÄÄ 
public
ÅÅ 

ActionResult
ÅÅ 
Delete
ÅÅ 
(
ÅÅ 
int
ÅÅ "
id
ÅÅ# %
)
ÅÅ% &
{
ÇÇ 
try
ÉÉ 	
{
ÑÑ 
_campaignService
ÖÖ 
.
ÖÖ 
Delete
ÖÖ 
(
ÖÖ  
_campaignService
ÖÖ  0
.
ÖÖ0 1
GetById
ÖÖ1 8
(
ÖÖ8 9
id
ÖÖ9 ;
)
ÖÖ; <
)
ÖÖ< =
;
ÖÖ= >!
SuccessNotification
ÜÜ 
(
ÜÜ 
$str
ÜÜ +
)
ÜÜ+ ,
;
ÜÜ, -
return
áá 
RedirectToAction
áá 
(
áá  
$str
áá  /
)
áá/ 0
;
áá0 1
}
àà 
catch
ââ 
{
ää 
return
ãã 
View
ãã 
(
ãã 
)
ãã 
;
ãã 
}
åå 
}
çç 
}
éé 
}èè Éc
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\CategoryController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
CategoryController !
:" #
BaseController$ 2
{ 
private 
readonly 
ICategoryService %
_categoryService& 6
;6 7
private 
readonly  
IQueryableRepository )
<) *
Category* 2
>2 3 
_queryableRepository4 H
;H I
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

CategoryController 
( 
ICategoryService .
categoryService/ >
,> ? 
IQueryableRepository@ T
<T U
CategoryU ]
>] ^
queryableRepository_ r
,r s!
IQueryableRepository	t à
<
à â
vwRP_StockCount
â ò
>
ò ô!
totalRowsRepository
ö ≠
)
≠ Æ
{ 
_categoryService 
= 
categoryService (
;( ) 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
} 
[!! 
SecuredOperation!! 
(!! 
Roles!! 
=!! 
$str!! 1
)!!1 2
]!!2 3
public"" 

ActionResult"" 
CategoryIndex"" %
(""% &
Int32""& +
?""+ ,
page""- 1
,""1 2
Int32""3 8
?""8 9
rows"": >
)""> ?
{## 
IGrid$$ 
<$$ 
Category$$ 
>$$ 
col$$ 
=$$ 
new$$ 
Grid$$  $
<$$$ %
Category$$% -
>$$- .
($$. / 
_queryableRepository$$/ C
.$$C D
Table$$D I
.$$I J
OrderByDescending$$J [
($$[ \
x$$\ ]
=>$$^ `
x$$a b
.$$b c

CategoryId$$c m
)$$m n
.$$n o
Skip$$o s
($$s t
($$t u
page$$u y
-$$z {
$num$$| }
??	$$~ Ä
$num
$$Å Ç
)
$$Ç É
*
$$Ñ Ö
(
$$Ü á
rows
$$á ã
??
$$å é
$num
$$è ë
)
$$ë í
)
$$í ì
.
$$ì î
Take
$$î ò
(
$$ò ô
rows
$$ô ù
??
$$û †
$num
$$° £
)
$$£ §
.
$$§ •
AsNoTracking
$$• ±
(
$$± ≤
)
$$≤ ≥
)
$$≥ ¥
;
$$¥ µ
col%% 	
.%%	 

Query%%
 
=%% 
new%% 
NameValueCollection%% )
(%%) *
Request%%* 1
.%%1 2
QueryString%%2 =
)%%= >
;%%> ?
if'' 
(''	 

col''
 
.'' 
Query'' 
!='' 
null'' 
)'' 
{(( 
col)) 
=)) 
new)) 
Grid)) 
<)) 
Category)) 
>))  
())  ! 
_queryableRepository))! 5
.))5 6
Table))6 ;
.)); <
OrderByDescending))< M
())M N
x))N O
=>))P R
x))S T
.))T U

CategoryId))U _
)))_ `
.))` a
AsNoTracking))a m
())m n
)))n o
)))o p
;))p q
}** 
col++ 	
.++	 

Columns++
 
.++ 
Add++ 
(++ 
x++ 
=>++ 
$str++ h
+++i j
x++k l
.++l m

CategoryId++m w
+++x y
$str	++z É
+
++Ñ Ö
$str,, p
+,,q r
x,,s t
.,,t u

CategoryId,,u 
+
,,Ä Å
$str
,,Ç ã
)
,,ã å
.--
 
Encoded-- 
(-- 
false-- 
)-- 
.-- 
Titled--  
(--  !
$str--! +
)--+ ,
.--, -

Filterable--- 7
(--7 8
false--8 =
)--= >
;--> ?
col// 	
.//	 

Columns//
 
.// 
Add// 
(// 
x// 
=>// 
x// 
.// 

CategoryId// '
)//' (
.//( )
Titled//) /
(/// 0
$str//0 =
)//= >
.//> ?
MultiFilterable//? N
(//N O
true//O S
)//S T
;//T U
col00 	
.00	 

Columns00
 
.00 
Add00 
(00 
x00 
=>00 
x00 
.00 
CategoryName00 )
)00) *
.00* +
Titled00+ 1
(001 2
$str002 A
)00A B
.00B C
MultiFilterable00C R
(00R S
true00S W
)00W X
;00X Y
col22 	
.22	 

Pager22
 
=22 
new22 
	GridPager22 
<22  
Category22  (
>22( )
(22) *
col22* -
)22- .
;22. /
col33 	
.33	 


Processors33
 
.33 
Add33 
(33 
col33 
.33 
Pager33 "
)33" #
;33# $
col44 	
.44	 

Pager44
 
.44 
RowsPerPage44 
=44 
$num44  
;44  !
col55 	
.55	 

	EmptyText55
 
=55 
$str55 1
;551 2
foreach66 
(66 
IGridColumn66 
column66 !
in66" $
col66% (
.66( )
Columns66) 0
)660 1
{77 
column88 
.88 
IsFilterable88 
=88 
true88 "
;88" #
column99 
.99 

IsSortable99 
=99 
true99  
;99  !
}:: 
var;; 	
total;;
 
=;;  
_totalRowsRepository;; &
.;;& '
Table;;' ,
.;;, -
AsNoTracking;;- 9
(;;9 :
);;: ;
.;;; <
Where;;< A
(;;A B
x;;B C
=>;;D F
x;;G H
.;;H I
	TableName;;I R
==;;S U
$str;;V b
);;b c
.;;c d
Select;;d j
(;;j k
x;;k l
=>;;m o
x;;p q
.;;q r
	TableRows;;r {
);;{ |
.;;| }
First	;;} Ç
(
;;Ç É
)
;;É Ñ
;
;;Ñ Ö
ViewBag<< 
.<< 
	totalRows<< 
=<< 
Convert<< !
.<<! "
ToInt32<<" )
(<<) *
total<<* /
)<</ 0
;<<0 1
return== 
View== 
(== 
col== 
)== 
;== 
}>> 
[@@ 
SecuredOperation@@ 
(@@ 
Roles@@ 
=@@ 
$str@@ 1
)@@1 2
]@@2 3
publicAA 

ActionResultAA 
CreateAA 
(AA 
)AA  
{BB 
varCC 	
emptyCC
 
=CC 
newCC 
CategoryViewModelCC '
(CC' (
)CC( )
;CC) *
varDD 	
dataDD
 
=DD 
emptyDD 
.DD 
ToVMDD 
(DD 
)DD 
;DD 
returnEE 
ViewEE 
(EE 
dataEE 
)EE 
;EE 
}FF 
[HH 
HttpPostHH 
]HH 
publicII 

ActionResultII 
CreateII 
(II 
CategoryViewModelII 0
categoryII1 9
)II9 :
{JJ 
ifKK 
(KK	 

!KK
 

ModelStateKK 
.KK 
IsValidKK 
)KK 
{LL 
ErrorNotificationMM 
(MM 
$strMM -
)MM- .
;MM. /
returnNN 
RedirectToActionNN 
(NN  
$strNN  (
)NN( )
;NN) *
}OO 
_categoryServicePP 
.PP 
AddPP 
(PP 
newPP 
CategoryPP '
{QQ 
CategoryNameRR 
=RR 
categoryRR 
.RR  
CategoryNameRR  ,
}TT 
)TT 
;TT 	
SuccessNotificationUU 
(UU 
$strUU *
)UU* +
;UU+ ,
returnVV 
RedirectToActionVV 
(VV 
$strVV -
)VV- .
;VV. /
}WW 
[YY 
SecuredOperationYY 
(YY 
RolesYY 
=YY 
$strYY 1
)YY1 2
]YY2 3
publicZZ 

ActionResultZZ 
EditZZ 
(ZZ 
intZZ  
idZZ! #
)ZZ# $
{[[ 
var\\ 	
data\\
 
=\\ 
AutoMapperHelper\\ !
.\\! "
MapToSameViewModel\\" 4
<\\4 5
Category\\5 =
,\\= >
CategoryViewModel\\? P
>\\P Q
(\\Q R
_categoryService\\R b
.\\b c
GetById\\c j
(\\j k
id\\k m
)\\m n
)\\n o
;\\o p
return]] 
View]] 
(]] 
data]] 
.]] 
ToVM]] 
(]] 
)]] 
)]] 
;]] 
}^^ 
[`` 
HttpPost`` 
]`` 
publicaa 

ActionResultaa 
Editaa 
(aa 
Categoryaa %
categoryaa& .
)aa. /
{bb 
trycc 	
{dd 
_categoryServiceff 
.ff 
Updateff 
(ff  
newff  #
Categoryff$ ,
{gg 	
CategoryNamehh	 
=hh 
categoryhh  
.hh  !
CategoryNamehh! -
,hh- .

CategoryIdii
 
=ii 
categoryii 
.ii  

CategoryIdii  *
}jj 	
)jj	 

;jj
 
SuccessNotificationkk 
(kk 
$strkk /
)kk/ 0
;kk0 1
returnll 
RedirectToActionll 
(ll  
$strll  /
)ll/ 0
;ll0 1
}mm 
catchnn 
{oo 
returnpp 
Viewpp 
(pp 
)pp 
;pp 
}qq 
}rr 
[tt 
SecuredOperationtt 
(tt 
Rolestt 
=tt 
$strtt 1
)tt1 2
]tt2 3
publicuu 

ActionResultuu 
Deleteuu 
(uu 
intuu "
iduu# %
,uu% &
Categoryuu' /
categoryuu0 8
)uu8 9
{vv 
varww 	
dataww
 
=ww 
AutoMapperHelperww !
.ww! "
MapToSameViewModelww" 4
<ww4 5
Categoryww5 =
,ww= >
CategoryViewModelww? P
>wwP Q
(wwQ R
_categoryServicewwR b
.wwb c
GetByIdwwc j
(wwj k
idwwk m
)wwm n
)wwn o
;wwo p
returnxx 
Viewxx 
(xx 
dataxx 
.xx 
ToVMxx 
(xx 
)xx 
)xx 
;xx 
}yy 
[{{ 
HttpPost{{ 
]{{ 
public|| 

ActionResult|| 
Delete|| 
(|| 
int|| "
id||# %
)||% &
{}} 
try~~ 	
{ 
_categoryService
ÄÄ 
.
ÄÄ 
Delete
ÄÄ 
(
ÄÄ  
_categoryService
ÄÄ  0
.
ÄÄ0 1
GetById
ÄÄ1 8
(
ÄÄ8 9
id
ÄÄ9 ;
)
ÄÄ; <
)
ÄÄ< =
;
ÄÄ= >!
SuccessNotification
ÅÅ 
(
ÅÅ 
$str
ÅÅ +
)
ÅÅ+ ,
;
ÅÅ, -
return
ÇÇ 
RedirectToAction
ÇÇ 
(
ÇÇ  
$str
ÇÇ  /
)
ÇÇ/ 0
;
ÇÇ0 1
}
ÉÉ 
catch
ÑÑ 
{
ÖÖ 
return
ÜÜ 
View
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
áá 
}
àà 
}
ââ 
}ää ù,
QE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\ChartDemoController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
public 
class	 
ChartDemoController "
:# $
BaseController% 3
{ 
public 

class 
	ChartDemo 
{ 
public 
double 
Count 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
UserName 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public 

ActionResult 
Index 
( 
) 
{ 
var 	
table
 
= 
new 
	DataTable 
(  
)  !
;! "
var 	
dt
 
= 
$str 0
;0 1
using 
( 
var 
dbx 
= 
new 
BayiPuanContext *
(* +
)+ ,
), -
{   
var!! 
cmd!! 
=!! 
dbx!! 
.!! 
Database!! 
.!! 

Connection!! )
.!!) *
CreateCommand!!* 7
(!!7 8
)!!8 9
;!!9 :
var"" 
sql"" 
="" 
dt"" 
;"" 
cmd## 
.## 
CommandText## 
=## 
sql## 
;## 
cmd$$ 
.$$ 

Connection$$ 
.$$ 
Open$$ 
($$ 
)$$ 
;$$ 
table%% 
.%% 
Load%% 
(%% 
cmd%% 
.%% 
ExecuteReader%% $
(%%$ %
)%%% &
)%%& '
;%%' (
DataSet&& 
ds&& 
=&& 
new&& 
DataSet&&  
(&&  !
)&&! "
;&&" #
ds'' 

.''
 
Tables'' 
.'' 
Add'' 
('' 
table'' 
)'' 
;'' 
DotNet)) 
.)) 

Highcharts)) 
.)) 

Highcharts)) $
chart))% *
=))+ ,
new))- 0
DotNet))1 7
.))7 8

Highcharts))8 B
.))B C

Highcharts))C M
())M N
$str))N U
)))U V
.**
 
	InitChart** 
(** 
new** 
Chart** 
{++
 
DefaultSeriesType,, 
=,, 

ChartTypes,,  *
.,,* +
Column,,+ 1
}..
 
).. 
.00
 
SetTitle00 
(00 
new00 
Title00 
{11
 
Text22 
=22 
$str22 !
}33
 
)33 
.44
 
SetXAxis44 
(44 
new44 
XAxis44 
{55
 

Categories77 
=77 
table77 
.77 
AsEnumerable77 +
(77+ ,
)77, -
.77- .
Select77. 4
(774 5
r775 6
=>777 9
r77: ;
.77; <
Field77< A
<77A B
string77B H
>77H I
(77I J
$str77J T
)77T U
.77U V
ToString77V ^
(77^ _
)77_ `
)77` a
.77a b
ToArray77b i
(77i j
)77j k
}99
 
)99 
.::
 
SetYAxis:: 
(:: 
new:: 
YAxis:: 
{;;
 
Title<< 
=<< 
new<< 

YAxisTitle<< "
{<<# $
Text<<% )
=<<* +
$str<<, B
}<<C D
,<<D E
	PlotLines== 
=== 
new== 
[== 
]== 
{>> 
new?? 
YAxisPlotLines??  
{@@ 
ValueAA 
=AA 
$numAA 
,AA 
WidthBB 
=BB 
$numBB 
,BB 
ColorCC 
=CC 
ColorTranslatorCC '
.CC' (
FromHtmlCC( 0
(CC0 1
$strCC1 :
)CC: ;
}EE 
}FF 
}GG
 
)GG 
.HH
 
	SetSeriesHH 
(HH 
newII 
SeriesII 
[II 
]II 
{II 
newJJ 
SeriesJJ 
{KK 
NameLL 
=LL 
$strLL  
,LL  !
DataLL" &
=LL' (
newLL) ,
DataLL- 1
(LL1 2
tableMM 
.MM 
AsEnumerableMM $
(MM$ %
)MM% &
.MM& '
SelectMM' -
(MM- .
rMM. /
=>MM/ 1
rMM1 2
.MM2 3
FieldMM3 8
<MM8 9
intMM9 <
>MM< =
(MM= >
$strMM> E
)MME F
)MMF G
.MMG H
CastMMH L
<MML M
objectMMM S
>MMS T
(MMT U
)MMU V
.MMV W
ToArrayMMW ^
(MM^ _
)MM_ `
)NN 
}OO 
}PP 
)QQ
 
;QQ 
ViewDataRR 
[RR 
$strRR 
]RR 
=RR 
chartRR  
.RR  !
ToHtmlStringRR! -
(RR- .
)RR. /
;RR/ 0
returnSS 
ViewSS 
(SS 
)SS 
;SS 
}TT 
}WW 
}XX 
}YY Ó_
LE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\CityController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
CityController 
: 
BaseController  .
{ 
private 
readonly 
ICityService !
_cityService" .
;. /
private 
readonly  
IQueryableRepository )
<) *
City* .
>. / 
_queryableRepository0 D
;D E
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

CityController 
( 
ICityService &
cityService' 2
,2 3 
IQueryableRepository4 H
<H I
CityI M
>M N
queryableRepositoryO b
,b c 
IQueryableRepositoryd x
<x y
vwRP_StockCount	y à
>
à â!
totalRowsRepository
ä ù
)
ù û
{ 
_cityService 
= 
cityService  
;  ! 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
} 
["" 
SecuredOperation"" 
("" 
Roles"" 
="" 
$str"" 1
)""1 2
]""2 3
public## 

ActionResult## 
	CityIndex## !
(##! "
Int32##" '
?##' (
page##) -
,##- .
Int32##/ 4
?##4 5
rows##6 :
)##: ;
{$$ 
IGrid%% 
<%% 
City%% 
>%% 
col%% 
=%% 
new%% 
Grid%%  
<%%  !
City%%! %
>%%% &
(%%& ' 
_queryableRepository%%' ;
.%%; <
Table%%< A
.%%A B
OrderByDescending%%B S
(%%S T
x%%T U
=>%%V X
x%%Y Z
.%%Z [
CityId%%[ a
)%%a b
.%%b c
Skip%%c g
(%%g h
(%%h i
page%%i m
-%%n o
$num%%p q
??%%r t
$num%%u v
)%%v w
*%%x y
(%%z {
rows%%{ 
??
%%Ä Ç
$num
%%É Ö
)
%%Ö Ü
)
%%Ü á
.
%%á à
Take
%%à å
(
%%å ç
rows
%%ç ë
??
%%í î
$num
%%ï ó
)
%%ó ò
.
%%ò ô
AsNoTracking
%%ô •
(
%%• ¶
)
%%¶ ß
)
%%ß ®
;
%%® ©
col&& 	
.&&	 

Query&&
 
=&& 
new&& 
NameValueCollection&& )
(&&) *
Request&&* 1
.&&1 2
QueryString&&2 =
)&&= >
;&&> ?
if(( 
(((	 

col((
 
.(( 
Query(( 
!=(( 
null(( 
)(( 
{)) 
col** 
=** 
new** 
Grid** 
<** 
City** 
>** 
(**  
_queryableRepository** 1
.**1 2
Table**2 7
.**7 8
OrderByDescending**8 I
(**I J
x**J K
=>**L N
x**O P
.**P Q
CityId**Q W
)**W X
.**X Y
AsNoTracking**Y e
(**e f
)**f g
)**g h
;**h i
}++ 
col,, 	
.,,	 

Columns,,
 
.,, 
Add,, 
(,, 
x,, 
=>,, 
$str,, h
+,,i j
x,,k l
.,,l m
CityId,,m s
+,,t u
$str,,v 
+
,,Ä Å
$str-- p
+--q r
x--s t
.--t u
CityId--u {
+--| }
$str	--~ á
)
--á à
...
 
Encoded.. 
(.. 
false.. 
).. 
... 
Titled..  
(..  !
$str..! +
)..+ ,
..., -

Filterable..- 7
(..7 8
false..8 =
)..= >
;..> ?
col00 	
.00	 

Columns00
 
.00 
Add00 
(00 
x00 
=>00 
x00 
.00 
CityId00 #
)00# $
.00$ %
Titled00% +
(00+ ,
$str00, 6
)006 7
;007 8
col11 	
.11	 

Columns11
 
.11 
Add11 
(11 
x11 
=>11 
x11 
.11 
CityName11 %
)11% &
.11& '
Titled11' -
(11- .
$str11. 9
)119 :
;11: ;
col33 	
.33	 

Pager33
 
=33 
new33 
	GridPager33 
<33  
City33  $
>33$ %
(33% &
col33& )
)33) *
;33* +
col44 	
.44	 


Processors44
 
.44 
Add44 
(44 
col44 
.44 
Pager44 "
)44" #
;44# $
col55 	
.55	 

Pager55
 
.55 
RowsPerPage55 
=55 
$num55  
;55  !
col66 	
.66	 

	EmptyText66
 
=66 
$str66 1
;661 2
foreach77 
(77 
IGridColumn77 
column77 !
in77" $
col77% (
.77( )
Columns77) 0
)770 1
{88 
column99 
.99 
IsFilterable99 
=99 
true99 "
;99" #
column:: 
.:: 

IsSortable:: 
=:: 
true::  
;::  !
};; 
var<< 	
total<<
 
=<<  
_totalRowsRepository<< &
.<<& '
Table<<' ,
.<<, -
AsNoTracking<<- 9
(<<9 :
)<<: ;
.<<; <
Where<<< A
(<<A B
x<<B C
=><<D F
x<<G H
.<<H I
	TableName<<I R
==<<S U
$str<<V ^
)<<^ _
.<<_ `
Select<<` f
(<<f g
x<<g h
=><<i k
x<<l m
.<<m n
	TableRows<<n w
)<<w x
.<<x y
First<<y ~
(<<~ 
)	<< Ä
;
<<Ä Å
ViewBag== 
.== 
	totalRows== 
=== 
Convert== !
.==! "
ToInt32==" )
(==) *
total==* /
)==/ 0
;==0 1
return>> 
View>> 
(>> 
col>> 
)>> 
;>> 
}?? 
[AA 
SecuredOperationAA 
(AA 
RolesAA 
=AA 
$strAA +
)AA+ ,
]AA, -
publicBB 

ActionResultBB 
CreateBB 
(BB 
)BB  
{CC 
varDD 	
emptyDD
 
=DD 
newDD 
CityViewModelDD #
(DD# $
)DD$ %
;DD% &
varEE 	
dataEE
 
=EE 
emptyEE 
.EE 
ToVMEE 
(EE 
)EE 
;EE 
returnFF 
ViewFF 
(FF 
dataFF 
)FF 
;FF 
}GG 
[II 
HttpPostII 
]II 
publicJJ 

ActionResultJJ 
CreateJJ 
(JJ 
CityViewModelJJ ,
cityJJ- 1
)JJ1 2
{KK 
ifLL 
(LL	 

!LL
 

ModelStateLL 
.LL 
IsValidLL 
)LL 
{MM 
ErrorNotificationNN 
(NN 
$strNN -
)NN- .
;NN. /
returnOO 
RedirectToActionOO 
(OO  
$strOO  (
)OO( )
;OO) *
}PP 
_cityServiceQQ 
.QQ 
AddQQ 
(QQ 
newQQ 
CityQQ 
{RR 
CityNameSS 
=SS 
citySS 
.SS 
CityNameSS  
}UU 
)UU 
;UU 	
SuccessNotificationVV 
(VV 
$strVV *
)VV* +
;VV+ ,
returnWW 
RedirectToActionWW 
(WW 
$strWW )
)WW) *
;WW* +
}XX 
[ZZ 
SecuredOperationZZ 
(ZZ 
RolesZZ 
=ZZ 
$strZZ +
)ZZ+ ,
]ZZ, -
public[[ 

ActionResult[[ 
Edit[[ 
([[ 
int[[  
id[[! #
)[[# $
{\\ 
var]] 	
data]]
 
=]] 
AutoMapperHelper]] !
.]]! "
MapToSameViewModel]]" 4
<]]4 5
City]]5 9
,]]9 :
CityViewModel]]; H
>]]H I
(]]I J
_cityService]]J V
.]]V W
GetById]]W ^
(]]^ _
id]]_ a
)]]a b
)]]b c
;]]c d
return^^ 
View^^ 
(^^ 
data^^ 
.^^ 
ToVM^^ 
(^^ 
)^^ 
)^^ 
;^^ 
}__ 
[aa 
HttpPostaa 
]aa 
publicbb 

ActionResultbb 
Editbb 
(bb 
Citybb !
citybb" &
)bb& '
{cc 
trydd 	
{ee 
_cityServicegg 
.gg 
Updategg 
(gg 
newgg 
Citygg  $
{hh 	
CityNameii
 
=ii 
cityii 
.ii 
CityNameii "
,ii" #
CityIdjj
 
=jj 
cityjj 
.jj 
CityIdjj 
}kk 	
)kk	 

;kk
 
SuccessNotificationll 
(ll 
$strll /
)ll/ 0
;ll0 1
returnmm 
RedirectToActionmm 
(mm  
$strmm  +
)mm+ ,
;mm, -
}nn 
catchoo 
{pp 
returnqq 
Viewqq 
(qq 
)qq 
;qq 
}rr 
}ss 
[uu 
SecuredOperationuu 
(uu 
Rolesuu 
=uu 
$struu +
)uu+ ,
]uu, -
publicvv 

ActionResultvv 
Deletevv 
(vv 
intvv "
idvv# %
,vv% &
Cityvv' +
cityvv, 0
)vv0 1
{ww 
varxx 	
dataxx
 
=xx 
AutoMapperHelperxx !
.xx! "
MapToSameViewModelxx" 4
<xx4 5
Cityxx5 9
,xx9 :
CityViewModelxx; H
>xxH I
(xxI J
_cityServicexxJ V
.xxV W
GetByIdxxW ^
(xx^ _
idxx_ a
)xxa b
)xxb c
;xxc d
returnyy 
Viewyy 
(yy 
datayy 
.yy 
ToVMyy 
(yy 
)yy 
)yy 
;yy 
}zz 
[|| 
HttpPost|| 
]|| 
public}} 

ActionResult}} 
Delete}} 
(}} 
int}} "
id}}# %
)}}% &
{~~ 
try 	
{
ÄÄ 
_cityService
ÅÅ 
.
ÅÅ 
Delete
ÅÅ 
(
ÅÅ 
_cityService
ÅÅ (
.
ÅÅ( )
GetById
ÅÅ) 0
(
ÅÅ0 1
id
ÅÅ1 3
)
ÅÅ3 4
)
ÅÅ4 5
;
ÅÅ5 6!
SuccessNotification
ÇÇ 
(
ÇÇ 
$str
ÇÇ +
)
ÇÇ+ ,
;
ÇÇ, -
return
ÉÉ 
RedirectToAction
ÉÉ 
(
ÉÉ  
$str
ÉÉ  +
)
ÉÉ+ ,
;
ÉÉ, -
}
ÑÑ 
catch
ÖÖ 
{
ÜÜ 
return
áá 
View
áá 
(
áá 
)
áá 
;
áá 
}
àà 
}
ââ 
}
ää 
}ãã ñà
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\CustomerController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
CustomerController !
:" #
BaseController$ 2
{ 
private 
readonly 
ICustomerService %
_customerService& 6
;6 7
private 
readonly  
IQueryableRepository )
<) *
Customer* 2
>2 3 
_queryableRepository4 H
;H I
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
private 
readonly 
IUserService !
_userService" .
;. /
public 

CustomerController 
( 
ICustomerService .
customerService/ >
,> ? 
IQueryableRepository@ T
<T U
CustomerU ]
>] ^
queryableRepository_ r
,r s!
IQueryableRepository	t à
<
à â
vwRP_StockCount
â ò
>
ò ô!
totalRowsRepository
ö ≠
,
≠ Æ
IUserService
Ø ª
userService
º «
)
« »
{ 
_customerService 
= 
customerService (
;( ) 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
_userService   
=   
userService    
;    !
}"" 
[%% 
SecuredOperation%% 
(%% 
Roles%% 
=%% 
$str%% 6
)%%6 7
]%%7 8
public&& 

ActionResult&& 
CustomerIndex&& %
(&&% &
Int32&&& +
?&&+ ,
page&&- 1
,&&1 2
Int32&&3 8
?&&8 9
rows&&: >
)&&> ?
{'' 
var(( 	
	getUserId((
 
=(( 
_userService(( "
.((" #
UniqueUserName((# 1
(((1 2
User((2 6
.((6 7
Identity((7 ?
.((? @
Name((@ D
)((D E
;((E F
IGrid)) 
<)) 
Customer)) 
>)) 
col)) 
=)) 
new)) 
Grid))  $
<))$ %
Customer))% -
>))- .
()). / 
_queryableRepository))/ C
.))C D
Table))D I
.))I J
Where))J O
())O P
x))P Q
=>))Q S
x))S T
.))T U
AddingUserId))U a
==))a c
	getUserId))c l
.))l m
UserId))m s
)))s t
.))t u
OrderByDescending	))u Ü
(
))Ü á
x
))á à
=>
))â ã
x
))å ç
.
))ç é

CustomerId
))é ò
)
))ò ô
.
))ô ö
Skip
))ö û
(
))û ü
(
))ü †
page
))† §
-
))• ¶
$num
))ß ®
??
))© ´
$num
))¨ ≠
)
))≠ Æ
*
))Ø ∞
(
))± ≤
rows
))≤ ∂
??
))∑ π
$num
))∫ º
)
))º Ω
)
))Ω æ
.
))æ ø
Take
))ø √
(
))√ ƒ
rows
))ƒ »
??
))… À
$num
))Ã Œ
)
))Œ œ
.
))œ –
AsNoTracking
))– ‹
(
))‹ ›
)
))› ﬁ
)
))ﬁ ﬂ
;
))ﬂ ‡
col** 	
.**	 

Query**
 
=** 
new** 
NameValueCollection** )
(**) *
Request*** 1
.**1 2
QueryString**2 =
)**= >
;**> ?
if,, 
(,,	 

col,,
 
.,, 
Query,, 
!=,, 
null,, 
),, 
{-- 
col.. 
=.. 
new.. 
Grid.. 
<.. 
Customer.. 
>..  
(..  ! 
_queryableRepository..! 5
...5 6
Table..6 ;
...; <
Where..< A
(..A B
x..B C
=>..D F
x..G H
...H I
AddingUserId..I U
==..V X
	getUserId..Y b
...b c
UserId..c i
)..i j
...j k
OrderByDescending..k |
(..| }
x..} ~
=>	.. Å
x
..Ç É
.
..É Ñ

CustomerId
..Ñ é
)
..é è
.
..è ê
AsNoTracking
..ê ú
(
..ú ù
)
..ù û
)
..û ü
;
..ü †
}// 
col00 	
.00	 

Columns00
 
.00 
Add00 
(00 
x00 
=>00 
$str00 h
+00i j
x00k l
.00l m

CustomerId00m w
+00x y
$str	00z É
+
00Ñ Ö
$str11 p
+11q r
x11s t
.11t u

CustomerId11u 
+
11Ä Å
$str
11Ç ã
)
11ã å
.22
 
Encoded22 
(22 
false22 
)22 
.22 
Titled22  
(22  !
$str22! +
)22+ ,
.22, -

Filterable22- 7
(227 8
false228 =
)22= >
;22> ?
col55 	
.55	 

Columns55
 
.55 
Add55 
(55 
x55 
=>55 
x55 
.55 
CustomerName55 )
)55) *
.55* +
Titled55+ 1
(551 2
$str552 ?
)55? @
.55@ A
MultiFilterable55A P
(55P Q
true55Q U
)55U V
;55V W
col66 	
.66	 

Columns66
 
.66 
Add66 
(66 
x66 
=>66 
x66 
.66 
TaxAdministration66 .
)66. /
.66/ 0
Titled660 6
(666 7
$str667 F
)66F G
;66G H
col77 	
.77	 

Columns77
 
.77 
Add77 
(77 
x77 
=>77 
x77 
.77 
TaxNo77 "
)77" #
.77# $
Titled77$ *
(77* +
$str77+ 5
)775 6
;776 7
col88 	
.88	 

Columns88
 
.88 
Add88 
(88 
x88 
=>88 
x88 
.88  
RelationalPersonName88 1
)881 2
.882 3
Titled883 9
(889 :
$str88: L
)88L M
;88M N
col99 	
.99	 

Columns99
 
.99 
Add99 
(99 
x99 
=>99 
x99 
.99 #
RelationalPersonSurname99 4
)994 5
.995 6
Titled996 <
(99< =
$str99= R
)99R S
;99S T
col:: 	
.::	 

Columns::
 
.:: 
Add:: 
(:: 
x:: 
=>:: 
x:: 
.:: 
MobilePhone:: (
)::( )
.::) *
Titled::* 0
(::0 1
$str::1 D
)::D E
;::E F
col== 	
.==	 

Pager==
 
=== 
new== 
	GridPager== 
<==  
Customer==  (
>==( )
(==) *
col==* -
)==- .
;==. /
col>> 	
.>>	 


Processors>>
 
.>> 
Add>> 
(>> 
col>> 
.>> 
Pager>> "
)>>" #
;>># $
col?? 	
.??	 

Pager??
 
.?? 
RowsPerPage?? 
=?? 
$num??  
;??  !
col@@ 	
.@@	 

	EmptyText@@
 
=@@ 
$str@@ 1
;@@1 2
foreachAA 
(AA 
IGridColumnAA 
columnAA !
inAA" $
colAA% (
.AA( )
ColumnsAA) 0
)AA0 1
{BB 
columnCC 
.CC 
IsFilterableCC 
=CC 
trueCC "
;CC" #
columnDD 
.DD 

IsSortableDD 
=DD 
trueDD  
;DD  !
}EE 
varFF 	
totalFF
 
=FF  
_totalRowsRepositoryFF &
.FF& '
TableFF' ,
.FF, -
AsNoTrackingFF- 9
(FF9 :
)FF: ;
.FF; <
WhereFF< A
(FFA B
xFFB C
=>FFD F
xFFG H
.FFH I
	TableNameFFI R
==FFS U
$strFFV a
)FFa b
.FFb c
SelectFFc i
(FFi j
xFFj k
=>FFl n
xFFo p
.FFp q
	TableRowsFFq z
)FFz {
.FF{ |
First	FF| Å
(
FFÅ Ç
)
FFÇ É
;
FFÉ Ñ
ViewBagGG 
.GG 
	totalRowsGG 
=GG 
ConvertGG !
.GG! "
ToInt32GG" )
(GG) *
totalGG* /
)GG/ 0
;GG0 1
returnHH 
ViewHH 
(HH 
colHH 
)HH 
;HH 
}II 
[KK 
SecuredOperationKK 
(KK 
RolesKK 
=KK 
$strKK 6
)KK6 7
]KK7 8
publicLL 

ActionResultLL 
CreateLL 
(LL 
)LL  
{MM 
varNN 	
emptyNN
 
=NN 
newNN 
CustomerViewModelNN '
(NN' (
)NN( )
;NN) *
varOO 	
dataOO
 
=OO 
emptyOO 
.OO 
ToVMOO 
(OO 
)OO 
;OO 
returnPP 
ViewPP 
(PP 
dataPP 
)PP 
;PP 
}QQ 
[SS 
HttpPostSS 
]SS 
publicTT 

ActionResultTT 
CreateTT 
(TT 
CustomerViewModelTT 0
customerTT1 9
)TT9 :
{UU 
varVV 	
	getUserIdVV
 
=VV 
_userServiceVV "
.VV" #
UniqueUserNameVV# 1
(VV1 2
UserVV2 6
.VV6 7
IdentityVV7 ?
.VV? @
NameVV@ D
)VVD E
;VVE F
ifWW 
(WW	 

!WW
 

ModelStateWW 
.WW 
IsValidWW 
)WW 
{XX 
ErrorNotificationYY 
(YY 
$strYY -
)YY- .
;YY. /
returnZZ 
RedirectToActionZZ 
(ZZ  
$strZZ  (
)ZZ( )
;ZZ) *
}[[ 
_customerService\\ 
.\\ 
Add\\ 
(\\ 
new\\ 
Customer\\ '
{]]  
RelationalPersonName^^ 
=^^ 
customer^^ '
.^^' ( 
RelationalPersonName^^( <
,^^< =
MobilePhone__ 
=__ 
customer__ 
.__ 
MobilePhone__ *
,__* +#
RelationalPersonSurname`` 
=``  !
customer``" *
.``* +#
RelationalPersonSurname``+ B
,``B C
CustomerNameaa 
=aa 
customeraa 
.aa  
CustomerNameaa  ,
,aa, -
TaxNobb 
=bb 
customerbb 
.bb 
TaxNobb 
,bb 
TaxAdministrationcc 
=cc 
customercc $
.cc$ %
TaxAdministrationcc% 6
,cc6 7
	DateAddeddd 
=dd 
DateTimedd 
.dd 
Nowdd  
,dd  !
Stateee 
=ee 
trueee 
,ee 
AddingUserIdff 
=ff 
	getUserIdff  
.ff  !
UserIdff! '
}ii 
)ii 
;ii 	
SuccessNotificationjj 
(jj 
$strjj *
)jj* +
;jj+ ,
returnkk 
RedirectToActionkk 
(kk 
$strkk -
)kk- .
;kk. /
}ll 
[nn 
SecuredOperationnn 
(nn 
Rolesnn 
=nn 
$strnn 6
)nn6 7
]nn7 8
publicoo 

ActionResultoo 
Editoo 
(oo 
intoo  
idoo! #
)oo# $
{pp 
varqq 	
dataqq
 
=qq 
AutoMapperHelperqq !
.qq! "
MapToSameViewModelqq" 4
<qq4 5
Customerqq5 =
,qq= >
CustomerViewModelqq? P
>qqP Q
(qqQ R
_customerServiceqqR b
.qqb c
GetByIdqqc j
(qqj k
idqqk m
)qqm n
)qqn o
;qqo p
returnrr 
Viewrr 
(rr 
datarr 
.rr 
ToVMrr 
(rr 
)rr 
)rr 
;rr 
}ss 
[uu 
HttpPostuu 
]uu 
publicvv 

ActionResultvv 
Editvv 
(vv 
Customervv %
customervv& .
)vv. /
{ww 
varxx 	
	getUserIdxx
 
=xx 
_userServicexx "
.xx" #
UniqueUserNamexx# 1
(xx1 2
Userxx2 6
.xx6 7
Identityxx7 ?
.xx? @
Namexx@ D
)xxD E
;xxE F
tryyy 	
{zz 
_customerService|| 
.|| 
Update|| 
(||  
new||  #
Customer||$ ,
{}} 	 
RelationalPersonName~~
 
=~~  
customer~~! )
.~~) * 
RelationalPersonName~~* >
,~~> ?
MobilePhone
 
= 
customer  
.  !
MobilePhone! ,
,, -%
RelationalPersonSurname
ÄÄ
 !
=
ÄÄ" #
customer
ÄÄ$ ,
.
ÄÄ, -%
RelationalPersonSurname
ÄÄ- D
,
ÄÄD E
CustomerName
ÅÅ
 
=
ÅÅ 
customer
ÅÅ !
.
ÅÅ! "
CustomerName
ÅÅ" .
,
ÅÅ. /
TaxNo
ÇÇ
 
=
ÇÇ 
customer
ÇÇ 
.
ÇÇ 
TaxNo
ÇÇ  
,
ÇÇ  !
TaxAdministration
ÉÉ
 
=
ÉÉ 
customer
ÉÉ &
.
ÉÉ& '
TaxAdministration
ÉÉ' 8
,
ÉÉ8 9
	DateAdded
ÑÑ
 
=
ÑÑ 
DateTime
ÑÑ 
.
ÑÑ 
Now
ÑÑ "
,
ÑÑ" #
State
ÖÖ
 
=
ÖÖ 
true
ÖÖ 
,
ÖÖ 
AddingUserId
ÜÜ
 
=
ÜÜ 
	getUserId
ÜÜ "
.
ÜÜ" #
UserId
ÜÜ# )
,
ÜÜ) *

CustomerId
áá
 
=
áá 
customer
áá 
.
áá  

CustomerId
áá  *
}
àà 	
)
àà	 

;
àà
 !
SuccessNotification
ââ 
(
ââ 
$str
ââ /
)
ââ/ 0
;
ââ0 1
return
ää 
RedirectToAction
ää 
(
ää  
$str
ää  /
)
ää/ 0
;
ää0 1
}
ãã 
catch
åå 
{
çç 
return
éé 
View
éé 
(
éé 
)
éé 
;
éé 
}
èè 
}
êê 
[
íí 
SecuredOperation
íí 
(
íí 
Roles
íí 
=
íí 
$str
íí 1
)
íí1 2
]
íí2 3
public
ìì 

ActionResult
ìì 
Delete
ìì 
(
ìì 
int
ìì "
id
ìì# %
,
ìì% &
Customer
ìì' /
customer
ìì0 8
)
ìì8 9
{
îî 
var
ïï 	
data
ïï
 
=
ïï 
AutoMapperHelper
ïï !
.
ïï! " 
MapToSameViewModel
ïï" 4
<
ïï4 5
Customer
ïï5 =
,
ïï= >
CustomerViewModel
ïï? P
>
ïïP Q
(
ïïQ R
_customerService
ïïR b
.
ïïb c
GetById
ïïc j
(
ïïj k
id
ïïk m
)
ïïm n
)
ïïn o
;
ïïo p
return
ññ 
View
ññ 
(
ññ 
data
ññ 
.
ññ 
ToVM
ññ 
(
ññ 
)
ññ 
)
ññ 
;
ññ 
}
óó 
[
ôô 
HttpPost
ôô 
]
ôô 
public
öö 

ActionResult
öö 
Delete
öö 
(
öö 
int
öö "
id
öö# %
)
öö% &
{
õõ 
try
úú 	
{
ùù 
_customerService
ûû 
.
ûû 
Delete
ûû 
(
ûû  
_customerService
ûû  0
.
ûû0 1
GetById
ûû1 8
(
ûû8 9
id
ûû9 ;
)
ûû; <
)
ûû< =
;
ûû= >!
SuccessNotification
üü 
(
üü 
$str
üü +
)
üü+ ,
;
üü, -
return
†† 
RedirectToAction
†† 
(
††  
$str
††  /
)
††/ 0
;
††0 1
}
°° 
catch
¢¢ 
{
££ 
return
§§ 
View
§§ 
(
§§ 
)
§§ 
;
§§ 
}
•• 
}
¶¶ 
}
ßß 
}®® Çñ
LE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\GiftController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
GiftController 
: 
BaseController  .
{ 
private 
readonly 
IGiftService !
_giftService" .
;. /
private 
readonly  
IQueryableRepository )
<) *
Gift* .
>. / 
_queryableRepository0 D
;D E
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

GiftController 
( 
IGiftService &
giftService' 2
,2 3 
IQueryableRepository4 H
<H I
GiftI M
>M N
queryableRepositoryO b
,b c 
IQueryableRepositoryd x
<x y
vwRP_StockCount	y à
>
à â!
totalRowsRepository
ä ù
)
ù û
{ 
_giftService 
= 
giftService  
;  ! 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
} 
["" 
SecuredOperation"" 
("" 
Roles"" 
="" 
$str"" 1
)""1 2
]""2 3
public## 

ActionResult## 
	GiftIndex## !
(##! "
Int32##" '
?##' (
page##) -
,##- .
Int32##/ 4
?##4 5
rows##6 :
)##: ;
{$$ 
IGrid%% 
<%% 
Gift%% 
>%% 
col%% 
=%% 
new%% 
Grid%%  
<%%  !
Gift%%! %
>%%% &
(%%& ' 
_queryableRepository%%' ;
.%%; <
Table%%< A
.%%A B
Include%%B I
(%%I J
$str%%J T
)%%T U
.%%U V
Include%%V ]
(%%] ^
$str%%^ e
)%%e f
.%%f g
OrderByDescending%%g x
(%%x y
x%%y z
=>%%{ }
x%%~ 
.	%% Ä
GiftId
%%Ä Ü
)
%%Ü á
.
%%á à
Skip
%%à å
(
%%å ç
(
%%ç é
page
%%é í
-
%%ì î
$num
%%ï ñ
??
%%ó ô
$num
%%ö õ
)
%%õ ú
*
%%ù û
(
%%ü †
rows
%%† §
??
%%• ß
$num
%%® ™
)
%%™ ´
)
%%´ ¨
.
%%¨ ≠
Take
%%≠ ±
(
%%± ≤
rows
%%≤ ∂
??
%%∑ π
$num
%%∫ º
)
%%º Ω
.
%%Ω æ
AsNoTracking
%%æ  
(
%%  À
)
%%À Ã
)
%%Ã Õ
;
%%Õ Œ
col&& 	
.&&	 

Query&&
 
=&& 
new&& 
NameValueCollection&& )
(&&) *
Request&&* 1
.&&1 2
QueryString&&2 =
)&&= >
;&&> ?
if(( 
(((	 

col((
 
.(( 
Query(( 
!=(( 
null(( 
)(( 
{)) 
col** 
=** 
new** 
Grid** 
<** 
Gift** 
>** 
(**  
_queryableRepository** 1
.**1 2
Table**2 7
.**7 8
Include**8 ?
(**? @
$str**@ J
)**J K
.**K L
Include**L S
(**S T
$str**T [
)**[ \
.**\ ]
OrderByDescending**] n
(**n o
x**o p
=>**q s
x**t u
.**u v
GiftId**v |
)**| }
.**} ~
AsNoTracking	**~ ä
(
**ä ã
)
**ã å
)
**å ç
;
**ç é
}++ 
col,, 	
.,,	 

Columns,,
 
.,, 
Add,, 
(,, 
x,, 
=>,, 
$str,, h
+,,i j
x,,k l
.,,l m
GiftId,,m s
+,,t u
$str,,v 
+
,,Ä Å
$str-- p
+--q r
x--s t
.--t u
GiftId--u {
+--| }
$str	--~ á
)
--á à
...
 
Encoded.. 
(.. 
false.. 
).. 
... 
Titled..  
(..  !
$str..! +
)..+ ,
..., -

Filterable..- 7
(..7 8
false..8 =
)..= >
;..> ?
col11 	
.11	 

Columns11
 
.11 
Add11 
(11 
x11 
=>11 
x11 
.11 
Category11 %
.11% &
CategoryName11& 2
)112 3
.113 4
Titled114 :
(11: ;
$str11; E
)11E F
;11F G
col22 	
.22	 

Columns22
 
.22 
Add22 
(22 
x22 
=>22 
x22 
.22 
Brand22 "
.22" #
	BrandName22# ,
)22, -
.22- .
Titled22. 4
(224 5
$str225 <
)22< =
;22= >
col33 	
.33	 

Columns33
 
.33 
Add33 
(33 
x33 
=>33 
x33 
.33 
Description33 (
)33( )
.33) *
Titled33* 0
(330 1
$str331 9
)339 :
;33: ;
col44 	
.44	 

Columns44
 
.44 
Add44 
(44 
x44 
=>44 
x44 
.44 
	GiftPoint44 &
)44& '
.44' (
Titled44( .
(44. /
$str44/ 5
)445 6
;446 7
col55 	
.55	 

Columns55
 
.55 
Add55 
(55 
x55 
=>55 
x55 
.55 
Usage55 "
)55" #
.55# $
Titled55$ *
(55* +
$str55+ ;
)55; <
;55< =
col66 	
.66	 

Columns66
 
.66 
Add66 
(66 
x66 
=>66 
x66 
.66 
Coverage66 %
)66% &
.66& '
Titled66' -
(66- .
$str66. 7
)667 8
;668 9
col77 	
.77	 

Columns77
 
.77 
Add77 
(77 
x77 
=>77 
x77 
.77 
ValidityPeriod77 +
)77+ ,
.77, -
Titled77- 3
(773 4
$str774 G
)77G H
;77H I
col88 	
.88	 

Columns88
 
.88 
Add88 
(88 
x88 
=>88 
x88 
.88 
Indivisible88 (
)88( )
.88) *
Titled88* 0
(880 1
$str881 B
)88B C
;88C D
col99 	
.99	 

Columns99
 
.99 
Add99 
(99 
x99 
=>99 
x99 
.99 
	Combining99 &
)99& '
.99' (
Titled99( .
(99. /
$str99/ F
)99F G
;99G H
col:: 	
.::	 

Columns::
 
.:: 
Add:: 
(:: 
x:: 
=>:: 
x:: 
.:: 
	TermOfUse:: &
)::& '
.::' (
Titled::( .
(::. /
$str::/ ?
)::? @
;::@ A
col;; 	
.;;	 

Columns;;
 
.;; 
Add;; 
(;; 
x;; 
=>;; 
x;; 
.;; 
Cancellation;; )
);;) *
.;;* +
Titled;;+ 1
(;;1 2
$str;;2 H
);;H I
;;;I J
col== 	
.==	 

Pager==
 
=== 
new== 
	GridPager== 
<==  
Gift==  $
>==$ %
(==% &
col==& )
)==) *
;==* +
col>> 	
.>>	 


Processors>>
 
.>> 
Add>> 
(>> 
col>> 
.>> 
Pager>> "
)>>" #
;>># $
col?? 	
.??	 

Pager??
 
.?? 
RowsPerPage?? 
=?? 
$num??  
;??  !
col@@ 	
.@@	 

	EmptyText@@
 
=@@ 
$str@@ 1
;@@1 2
foreachAA 
(AA 
IGridColumnAA 
columnAA !
inAA" $
colAA% (
.AA( )
ColumnsAA) 0
)AA0 1
{BB 
columnCC 
.CC 
IsFilterableCC 
=CC 
trueCC "
;CC" #
columnDD 
.DD 

IsSortableDD 
=DD 
trueDD  
;DD  !
}EE 
varFF 	
totalFF
 
=FF  
_totalRowsRepositoryFF &
.FF& '
TableFF' ,
.FF, -
AsNoTrackingFF- 9
(FF9 :
)FF: ;
.FF; <
WhereFF< A
(FFA B
xFFB C
=>FFD F
xFFG H
.FFH I
	TableNameFFI R
==FFS U
$strFFV ]
)FF] ^
.FF^ _
SelectFF_ e
(FFe f
xFFf g
=>FFh j
xFFk l
.FFl m
	TableRowsFFm v
)FFv w
.FFw x
FirstFFx }
(FF} ~
)FF~ 
;	FF Ä
ViewBagGG 
.GG 
	totalRowsGG 
=GG 
ConvertGG !
.GG! "
ToInt32GG" )
(GG) *
totalGG* /
)GG/ 0
;GG0 1
returnHH 
ViewHH 
(HH 
colHH 
)HH 
;HH 
}II 
[KK 
SecuredOperationKK 
(KK 
RolesKK 
=KK 
$strKK 1
)KK1 2
]KK2 3
publicLL 

ActionResultLL 
CreateLL 
(LL 
GiftLL #
giftLL$ (
)LL( )
{MM 
varNN 	
emptyNN
 
=NN 
newNN 
GiftViewModelNN #
(NN# $
)NN$ %
{OO 
CancellationPP 
=PP 
$strPP E
,PPE F
	CombiningQQ 
=QQ 
$strQQ 5
,QQ5 6
CoverageRR 
=RR 
$strRR .
,RR. /
IndivisibleSS 
=SS 
$strSS S
,SSS T
	TermOfUseTT 
=TT 
$strTT W
,TTW X
ValidityPeriodUU 
=UU 
$strUU [
,UU[ \
UsageVV 
=VV 
$strVV I
,VVI J
}WW 
;WW 
varXX 	
dataXX
 
=XX 
emptyXX 
.XX 
ToVMXX 
(XX 
)XX 
;XX 
returnYY 
ViewYY 
(YY 
dataYY 
)YY 
;YY 
}ZZ 
[\\ 
HttpPost\\ 
]\\ 
[]] 
ValidateInput]] 
(]] 
false]] 
)]] 
]]] 
public^^ 

ActionResult^^ 
Create^^ 
(^^ 
GiftViewModel^^ ,
gift^^- 1
)^^1 2
{__ 
if`` 
(``	 

!``
 

ModelState`` 
.`` 
IsValid`` 
)`` 
{aa 
ErrorNotificationbb 
(bb 
$strbb -
)bb- .
;bb. /
returncc 
RedirectToActioncc 
(cc  
$strcc  (
)cc( )
;cc) *
}dd 
_giftServiceee 
.ee 
Addee 
(ee 
newee 
Giftee 
{ff 

CategoryIdgg 
=gg 
giftgg 
.gg 

CategoryIdgg $
,gg$ %
BrandIdhh 
=hh 
gifthh 
.hh 
BrandIdhh 
,hh 
Cancellationii 
=ii 
giftii 
.ii 
Cancellationii (
,ii( )
	Combiningjj 
=jj 
giftjj 
.jj 
	Combiningjj "
,jj" #
Coveragekk 
=kk 
giftkk 
.kk 
Coveragekk  
,kk  !
Descriptionll 
=ll 
giftll 
.ll 
Descriptionll &
,ll& '
	GiftPointmm 
=mm 
giftmm 
.mm 
	GiftPointmm "
,mm" #
Indivisiblenn 
=nn 
giftnn 
.nn 
Indivisiblenn &
,nn& '
	TermOfUseoo 
=oo 
giftoo 
.oo 
	TermOfUseoo "
,oo" #
Usagepp 
=pp 
giftpp 
.pp 
Usagepp 
,pp 
ValidityPeriodqq 
=qq 
giftqq 
.qq 
ValidityPeriodqq ,
,qq, -
IsActiverr 
=rr 
giftrr 
.rr 
IsActiverr  
,rr  !
Detailss 
=ss 
giftss 
.ss 
Detailss 
}vv 
)vv 
;vv 	
SuccessNotificationww 
(ww 
$strww *
)ww* +
;ww+ ,
returnxx 
RedirectToActionxx 
(xx 
$strxx )
)xx) *
;xx* +
}yy 
[{{ 
SecuredOperation{{ 
({{ 
Roles{{ 
={{ 
$str{{ 1
){{1 2
]{{2 3
public|| 

ActionResult|| 
Edit|| 
(|| 
int||  
id||! #
)||# $
{}} 
var~~ 	
data~~
 
=~~ 
AutoMapperHelper~~ !
.~~! "
MapToSameViewModel~~" 4
<~~4 5
Gift~~5 9
,~~9 :
GiftViewModel~~; H
>~~H I
(~~I J
_giftService~~J V
.~~V W
GetById~~W ^
(~~^ _
id~~_ a
)~~a b
)~~b c
;~~c d
return 
View 
( 
data 
. 
ToVM 
( 
) 
) 
; 
}
ÄÄ 
[
ÇÇ 
HttpPost
ÇÇ 
]
ÇÇ 
[
ÉÉ 
ValidateInput
ÉÉ 
(
ÉÉ 
false
ÉÉ 
)
ÉÉ 
]
ÉÉ 
public
ÑÑ 

ActionResult
ÑÑ 
Edit
ÑÑ 
(
ÑÑ 
Gift
ÑÑ !
gift
ÑÑ" &
)
ÑÑ& '
{
ÖÖ 
try
ÜÜ 	
{
áá 
_giftService
ââ 
.
ââ 
Update
ââ 
(
ââ 
new
ââ 
Gift
ââ  $
{
ää 	

CategoryId
ãã
 
=
ãã 
gift
ãã 
.
ãã 

CategoryId
ãã &
,
ãã& '
BrandId
åå
 
=
åå 
gift
åå 
.
åå 
BrandId
åå  
,
åå  !
Cancellation
çç
 
=
çç 
gift
çç 
.
çç 
Cancellation
çç *
,
çç* +
	Combining
éé
 
=
éé 
gift
éé 
.
éé 
	Combining
éé $
,
éé$ %
Coverage
èè
 
=
èè 
gift
èè 
.
èè 
Coverage
èè "
,
èè" #
Description
êê
 
=
êê 
gift
êê 
.
êê 
Description
êê (
,
êê( )
	GiftPoint
ëë
 
=
ëë 
gift
ëë 
.
ëë 
	GiftPoint
ëë $
,
ëë$ %
Indivisible
íí
 
=
íí 
gift
íí 
.
íí 
Indivisible
íí (
,
íí( )
	TermOfUse
ìì
 
=
ìì 
gift
ìì 
.
ìì 
	TermOfUse
ìì $
,
ìì$ %
Usage
îî
 
=
îî 
gift
îî 
.
îî 
Usage
îî 
,
îî 
ValidityPeriod
ïï
 
=
ïï 
gift
ïï 
.
ïï  
ValidityPeriod
ïï  .
,
ïï. /
IsActive
ññ
 
=
ññ 
gift
ññ 
.
ññ 
IsActive
ññ "
,
ññ" #
Detail
óó
 
=
óó 
gift
óó 
.
óó 
Detail
óó 
,
óó 
GiftId
òò
 
=
òò 
gift
òò 
.
òò 
GiftId
òò 
}
ôô 	
)
ôô	 

;
ôô
 !
SuccessNotification
öö 
(
öö 
$str
öö /
)
öö/ 0
;
öö0 1
return
õõ 
RedirectToAction
õõ 
(
õõ  
$str
õõ  +
)
õõ+ ,
;
õõ, -
}
úú 
catch
ùù 
{
ûû 
return
üü 
View
üü 
(
üü 
)
üü 
;
üü 
}
†† 
}
°° 
[
££ 
SecuredOperation
££ 
(
££ 
Roles
££ 
=
££ 
$str
££ +
)
££+ ,
]
££, -
public
§§ 

ActionResult
§§ 
Delete
§§ 
(
§§ 
int
§§ "
id
§§# %
,
§§% &
Gift
§§' +
gift
§§, 0
)
§§0 1
{
•• 
var
¶¶ 	
data
¶¶
 
=
¶¶ 
AutoMapperHelper
¶¶ !
.
¶¶! " 
MapToSameViewModel
¶¶" 4
<
¶¶4 5
Gift
¶¶5 9
,
¶¶9 :
GiftViewModel
¶¶; H
>
¶¶H I
(
¶¶I J
_giftService
¶¶J V
.
¶¶V W
GetById
¶¶W ^
(
¶¶^ _
id
¶¶_ a
)
¶¶a b
)
¶¶b c
;
¶¶c d
return
ßß 
View
ßß 
(
ßß 
data
ßß 
.
ßß 
ToVM
ßß 
(
ßß 
)
ßß 
)
ßß 
;
ßß 
}
®® 
[
™™ 
HttpPost
™™ 
]
™™ 
public
´´ 

ActionResult
´´ 
Delete
´´ 
(
´´ 
int
´´ "
id
´´# %
)
´´% &
{
¨¨ 
try
≠≠ 	
{
ÆÆ 
_giftService
ØØ 
.
ØØ 
Delete
ØØ 
(
ØØ 
_giftService
ØØ (
.
ØØ( )
GetById
ØØ) 0
(
ØØ0 1
id
ØØ1 3
)
ØØ3 4
)
ØØ4 5
;
ØØ5 6!
SuccessNotification
∞∞ 
(
∞∞ 
$str
∞∞ +
)
∞∞+ ,
;
∞∞, -
return
±± 
RedirectToAction
±± 
(
±±  
$str
±±  +
)
±±+ ,
;
±±, -
}
≤≤ 
catch
≥≥ 
{
¥¥ 
return
µµ 
View
µµ 
(
µµ 
)
µµ 
;
µµ 
}
∂∂ 
}
∑∑ 
}
∏∏ 
}ππ ¢h
QE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\GN_ReportController.cs
	namespace 	
BayiPuan
 
. 
MVCWebUI 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
GN_ReportController "
:# $
BaseController% 3
{ 
private 
readonly 
IGN_ReportService &
_reportService' 5
;5 6
private 
readonly  
IQueryableRepository )
<) *
	GN_Report* 3
>3 4 
_queryableRepository5 I
;I J
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public   

GN_ReportController   
(   
IGN_ReportService   0
reportService  1 >
,  > ? 
IQueryableRepository  @ T
<  T U
	GN_Report  U ^
>  ^ _
queryableRepository  ` s
,  s t!
IQueryableRepository	  u â
<
  â ä
vwRP_StockCount
  ä ô
>
  ô ö!
totalRowsRepository
  õ Æ
)
  Æ Ø
{!! 
_reportService"" 
="" 
reportService"" $
;""$ % 
_queryableRepository## 
=## 
queryableRepository## 0
;##0 1 
_totalRowsRepository$$ 
=$$ 
totalRowsRepository$$ 0
;$$0 1
}%% 
public(( 

ActionResult(( 
GN_ReportIndex(( &
(((& '
Int32((' ,
?((, -
page((. 2
,((2 3
Int32((4 9
?((9 :
rows((; ?
)((? @
{)) 
IGrid** 
<** 
	GN_Report** 
>** 
col** 
=** 
new**  
Grid**! %
<**% &
	GN_Report**& /
>**/ 0
(**0 1 
_queryableRepository**1 E
.**E F
Table**F K
.**K L
OrderByDescending**L ]
(**] ^
x**^ _
=>**` b
x**c d
.**d e
ReportId**e m
)**m n
.**n o
Skip**o s
(**s t
(**t u
page**u y
-**z {
$num**| }
??	**~ Ä
$num
**Å Ç
)
**Ç É
*
**Ñ Ö
(
**Ü á
rows
**á ã
??
**å é
$num
**è ë
)
**ë í
)
**í ì
.
**ì î
Take
**î ò
(
**ò ô
rows
**ô ù
??
**û †
$num
**° £
)
**£ §
.
**§ •
AsNoTracking
**• ±
(
**± ≤
)
**≤ ≥
)
**≥ ¥
;
**¥ µ
col++ 	
.++	 

Query++
 
=++ 
new++ 
NameValueCollection++ )
(++) *
Request++* 1
.++1 2
QueryString++2 =
)++= >
;++> ?
if-- 
(--	 

col--
 
.-- 
Query-- 
!=-- 
null-- 
)-- 
{.. 
col// 
=// 
new// 
Grid// 
<// 
	GN_Report//  
>//  !
(//! " 
_queryableRepository//" 6
.//6 7
Table//7 <
.//< =
OrderByDescending//= N
(//N O
x//O P
=>//Q S
x//T U
.//U V
ReportId//V ^
)//^ _
.//_ `
AsNoTracking//` l
(//l m
)//m n
)//n o
;//o p
}00 
col11 	
.11	 

Columns11
 
.11 
Add11 
(11 
x11 
=>11 
$str11 h
+11i j
x11k l
.11l m
ReportId11m u
+11v w
$str	11x Å
+
11Ç É
$str22 q
+22r s
x22t u
.22u v
ReportId22v ~
+	22 Ä
$str
22Å ä
+
22ã å
$str	33 ê
+
33ë í
x
33ì î
.
33î ï
ReportId
33ï ù
+
33û ü
$str
33† ±
+
33≤ ≥
x
33¥ µ
.
33µ ∂
ReportFilter
33∂ ¬
+
33√ ƒ
$str
33≈ Œ
)
33Œ œ
.
33œ –
Css
33– ”
(
33” ‘
$str
33‘ ›
)
33› ﬁ
.44
 
Encoded44 
(44 
false44 
)44 
.44 
Titled44  
(44  !
$str44! +
)44+ ,
.44, -

Filterable44- 7
(447 8
false448 =
)44= >
;44> ?
col55 	
.55	 

Columns55
 
.55 
Add55 
(55 
x55 
=>55 
x55 
.55 
ReportTitle55 (
)55( )
.55) *
Titled55* 0
(550 1
$str551 9
)559 :
.55: ;
MultiFilterable55; J
(55J K
true55K O
)55O P
;55P Q
col99 	
.99	 

Pager99
 
=99 
new99 
	GridPager99 
<99  
	GN_Report99  )
>99) *
(99* +
col99+ .
)99. /
;99/ 0
col:: 	
.::	 


Processors::
 
.:: 
Add:: 
(:: 
col:: 
.:: 
Pager:: "
)::" #
;::# $
col;; 	
.;;	 

Pager;;
 
.;; 
RowsPerPage;; 
=;; 
$num;;  
;;;  !
col<< 	
.<<	 

	EmptyText<<
 
=<< 
$str<< 1
;<<1 2
foreach== 
(== 
IGridColumn== 
column== !
in==" $
col==% (
.==( )
Columns==) 0
)==0 1
{>> 
column?? 
.?? 
IsFilterable?? 
=?? 
true?? "
;??" #
column@@ 
.@@ 

IsSortable@@ 
=@@ 
true@@  
;@@  !
}AA 
varBB 	
totalBB
 
=BB  
_totalRowsRepositoryBB &
.BB& '
TableBB' ,
.BB, -
AsNoTrackingBB- 9
(BB9 :
)BB: ;
.BB; <
WhereBB< A
(BBA B
xBBB C
=>BBD F
xBBG H
.BBH I
	TableNameBBI R
==BBS U
$strBBV b
)BBb c
.BBc d
SelectBBd j
(BBj k
xBBk l
=>BBm o
xBBp q
.BBq r
	TableRowsBBr {
)BB{ |
.BB| }
First	BB} Ç
(
BBÇ É
)
BBÉ Ñ
;
BBÑ Ö
ViewBagCC 
.CC 
	totalRowsCC 
=CC 
ConvertCC !
.CC! "
ToInt32CC" )
(CC) *
totalCC* /
)CC/ 0
;CC0 1
returnDD 
ViewDD 
(DD 
colDD 
)DD 
;DD 
}EE 
[GG 
SecuredOperationGG 
(GG 
RolesGG 
=GG 
$strGG +
)GG+ ,
]GG, -
publicHH 

ActionResultHH 
CreateHH 
(HH 
)HH  
{II 
varJJ 	
emptyJJ
 
=JJ 
newJJ 
GN_ReportViewModelJJ (
(JJ( )
)JJ) *
;JJ* +
varLL 	
dataLL
 
=LL 
emptyLL 
.LL 
ToVMLL 
(LL 
)LL 
;LL 
returnNN 
ViewNN 
(NN 
dataNN 
)NN 
;NN 
}OO 
[PP 
HttpPostPP 
]PP 
publicQQ 

ActionResultQQ 
CreateQQ 
(QQ 
GN_ReportViewModelQQ 1
reportQQ2 8
)QQ8 9
{RR 
ifSS 
(SS	 

!SS
 

ModelStateSS 
.SS 
IsValidSS 
)SS 
{TT 
ErrorNotificationUU 
(UU 
$strUU -
)UU- .
;UU. /
returnVV 
RedirectToActionVV 
(VV  
$strVV  (
)VV( )
;VV) *
}WW 
_reportServiceXX 
.XX 
AddXX 
(XX 
newXX 
	GN_ReportXX &
{YY 
ReportTitleZZ 
=ZZ 
reportZZ 
.ZZ 
ReportTitleZZ (
,ZZ( )
ReportFilter[[ 
=[[ 
report[[ 
.[[ 
ReportFilter[[ *
,[[* +
	ReportSql\\ 
=\\ 
report\\ 
.\\ 
	ReportSql\\ $
,\\$ %
ReportAuthorization]] 
=]] 
$str]] ,
+]]- .
report]]/ 5
.]]5 6
ReportAuthorization]]6 I
}^^ 
)^^ 
;^^ 	
SuccessNotification__ 
(__ 
$str__ *
)__* +
;__+ ,
return`` 
RedirectToAction`` 
(`` 
$str`` .
)``. /
;``/ 0
}aa 
[bb 
SecuredOperationbb 
(bb 
Rolesbb 
=bb 
$strbb +
)bb+ ,
]bb, -
publiccc 

ActionResultcc 
Editcc 
(cc 
intcc  
idcc! #
)cc# $
{dd 
varee 	
dataee
 
=ee 
AutoMapperHelperee !
.ee! "
MapToSameViewModelee" 4
<ee4 5
	GN_Reportee5 >
,ee> ?
GN_ReportViewModelee@ R
>eeR S
(eeS T
_reportServiceeeT b
.eeb c
GetByIdeec j
(eej k
ideek m
)eem n
)een o
;eeo p
returnff 
Viewff 
(ff 
dataff 
.ff 
ToVMff 
(ff 
)ff 
)ff 
;ff 
}gg 
[ii 
HttpPostii 
]ii 
publicjj 

ActionResultjj 
Editjj 
(jj 
	GN_Reportjj &
reportjj' -
)jj- .
{kk 
tryll 	
{mm 
_reportServiceoo 
.oo 
Updateoo 
(oo 
newoo !
	GN_Reportoo" +
{pp 	
ReportTitleqq
 
=qq 
reportqq 
.qq 
ReportTitleqq *
,qq* +
ReportFilterrr
 
=rr 
reportrr 
.rr  
ReportFilterrr  ,
,rr, -
	ReportSqlss
 
=ss 
reportss 
.ss 
	ReportSqlss &
,ss& '
ReportAuthorizationtt
 
=tt 
reporttt  &
.tt& '
ReportAuthorizationtt' :
,tt: ;
ReportIduu
 
=uu 
reportuu 
.uu 
ReportIduu $
}vv 	
)vv	 

;vv
 
SuccessNotificationww 
(ww 
$strww /
)ww/ 0
;ww0 1
returnxx 
RedirectToActionxx 
(xx  
$strxx  0
)xx0 1
;xx1 2
}yy 
catchzz 
{{{ 
return|| 
View|| 
(|| 
)|| 
;|| 
}}} 
}~~ 
[
ÄÄ 
SecuredOperation
ÄÄ 
(
ÄÄ 
Roles
ÄÄ 
=
ÄÄ 
$str
ÄÄ +
)
ÄÄ+ ,
]
ÄÄ, -
public
ÅÅ 

ActionResult
ÅÅ 
Delete
ÅÅ 
(
ÅÅ 
int
ÅÅ "
id
ÅÅ# %
,
ÅÅ% &
	GN_Report
ÅÅ' 0
report
ÅÅ1 7
)
ÅÅ7 8
{
ÇÇ 
var
ÉÉ 	
data
ÉÉ
 
=
ÉÉ 
AutoMapperHelper
ÉÉ !
.
ÉÉ! " 
MapToSameViewModel
ÉÉ" 4
<
ÉÉ4 5
	GN_Report
ÉÉ5 >
,
ÉÉ> ? 
GN_ReportViewModel
ÉÉ@ R
>
ÉÉR S
(
ÉÉS T
_reportService
ÉÉT b
.
ÉÉb c
GetById
ÉÉc j
(
ÉÉj k
id
ÉÉk m
)
ÉÉm n
)
ÉÉn o
;
ÉÉo p
return
ÖÖ 
View
ÖÖ 
(
ÖÖ 
data
ÖÖ 
.
ÖÖ 
ToVM
ÖÖ 
(
ÖÖ 
)
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 
[
àà 
HttpPost
àà 
]
àà 
public
ââ 

ActionResult
ââ 
Delete
ââ 
(
ââ 
int
ââ "
id
ââ# %
)
ââ% &
{
ää 
try
ãã 	
{
åå 
_reportService
éé 
.
éé 
Delete
éé 
(
éé 
_reportService
éé ,
.
éé, -
GetById
éé- 4
(
éé4 5
id
éé5 7
)
éé7 8
)
éé8 9
;
éé9 :!
SuccessNotification
èè 
(
èè 
$str
èè +
)
èè+ ,
;
èè, -
return
ëë 
RedirectToAction
ëë 
(
ëë  
$str
ëë  0
)
ëë0 1
;
ëë1 2
}
íí 
catch
ìì 
{
îî 
return
ïï 
View
ïï 
(
ïï 
)
ïï 
;
ïï 
}
ññ 
}
óó 
}
òò 
}ôô µ
LE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\HomeController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public		 
class			 
HomeController		 
:		 
BaseController		  .
{

 
public 

ActionResult 
ChangeCulture %
(% &
string& ,
dilId- 2
,2 3
string4 :
lang; ?
,? @
stringA G
	returnUrlH Q
)Q R
{ 
Response 
. 
Cookies 
. 
Add 
( 
new 

HttpCookie )
() *
$str* 3
,3 4
lang5 9
)9 :
): ;
;; <
return 
Redirect 
( 
	returnUrl 
)  
;  !
} 
} 
} º¡
UE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\KnowledgeTestController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 #
KnowledgeTestController &
:' (
BaseController) 7
{ 
private 
readonly !
IKnowledgeTestService *!
_knowledgeTestService+ @
;@ A
private 
readonly 
IAnswerService #
_answerService$ 2
;2 3
private 
readonly 
IScoreService "
_scoreService# 0
;0 1
private 
readonly  
IQueryableRepository )
<) *
Answer* 0
>0 1&
_answerQueryableRepository2 L
;L M
private 
readonly  
IQueryableRepository )
<) *
KnowledgeTest* 7
>7 8 
_queryableRepository9 M
;M N
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public   
#
KnowledgeTestController   "
(  " #!
IKnowledgeTestService  # 8 
knowledgeTestService  9 M
,  M N 
IQueryableRepository  O c
<  c d
KnowledgeTest  d q
>  q r 
queryableRepository	  s Ü
,
  Ü á"
IQueryableRepository
  à ú
<
  ú ù
vwRP_StockCount
  ù ¨
>
  ¨ ≠!
totalRowsRepository
  Æ ¡
,
  ¡ ¬"
IQueryableRepository
  √ ◊
<
  ◊ ÿ
Answer
  ÿ ﬁ
>
  ﬁ ﬂ'
answerQueryableRepository
  ‡ ˘
,
  ˘ ˙
IAnswerService
  ˚ â
answerService
  ä ó
,
  ó ò
IScoreService
  ô ¶
scoreService
  ß ≥
)
  ≥ ¥
{!! !
_knowledgeTestService"" 
=""  
knowledgeTestService"" 2
;""2 3 
_queryableRepository## 
=## 
queryableRepository## 0
;##0 1 
_totalRowsRepository$$ 
=$$ 
totalRowsRepository$$ 0
;$$0 1&
_answerQueryableRepository%%  
=%%! "%
answerQueryableRepository%%# <
;%%< =
_answerService&& 
=&& 
answerService&& $
;&&$ %
_scoreService'' 
='' 
scoreService'' "
;''" #
}(( 
[** 
SecuredOperation** 
(** 
Roles** 
=** 
$str** +
)**+ ,
]**, -
public++ 

ActionResult++ 
KnowledgeTestIndex++ *
(++* +
Int32+++ 0
?++0 1
page++2 6
,++6 7
Int32++8 =
?++= >
rows++? C
)++C D
{,, 
IGrid-- 
<-- 
KnowledgeTest-- 
>-- 
col-- 
=--  
new--! $
Grid--% )
<--) *
KnowledgeTest--* 7
>--7 8
(--8 9 
_queryableRepository--9 M
.--M N
Table--N S
.--S T
OrderByDescending--T e
(--e f
x--f g
=>--h j
x--k l
.--l m
KnowledgeTestId--m |
)--| }
.--} ~
Skip	--~ Ç
(
--Ç É
(
--É Ñ
page
--Ñ à
-
--â ä
$num
--ã å
??
--ç è
$num
--ê ë
)
--ë í
*
--ì î
(
--ï ñ
rows
--ñ ö
??
--õ ù
$num
--û †
)
--† °
)
--° ¢
.
--¢ £
Take
--£ ß
(
--ß ®
rows
--® ¨
??
--≠ Ø
$num
--∞ ≤
)
--≤ ≥
)
--≥ ¥
;
--¥ µ
col.. 	
...	 

Query..
 
=.. 
new.. 
NameValueCollection.. )
(..) *
Request..* 1
...1 2
QueryString..2 =
)..= >
;..> ?
if00 
(00	 

col00
 
.00 
Query00 
!=00 
null00 
)00 
{11 
col22 
=22 
new22 
Grid22 
<22 
KnowledgeTest22 $
>22$ %
(22% & 
_queryableRepository22& :
.22: ;
Table22; @
.22@ A
OrderByDescending22A R
(22R S
x22S T
=>22U W
x22X Y
.22Y Z
KnowledgeTestId22Z i
)22i j
)22j k
;22k l
}33 
col44 	
.44	 

Columns44
 
.44 
Add44 
(44 
x44 
=>44 
$str44 h
+44i j
x44k l
.44l m
KnowledgeTestId44m |
+44} ~
$str	44 à
+
44â ä
$str55 p
+55q r
x55s t
.55t u
KnowledgeTestId	55u Ñ
+
55Ö Ü
$str
55á ê
)
55ê ë
.66
 
Encoded66 
(66 
false66 
)66 
.66 
Titled66  
(66  !
$str66! +
)66+ ,
.66, -

Filterable66- 7
(667 8
false668 =
)66= >
;66> ?
col88 	
.88	 

Columns88
 
.88 
Add88 
(88 
x88 
=>88 
x88 
.88 
KnowledgeTestId88 ,
)88, -
.88- .
Titled88. 4
(884 5
$str885 F
)88F G
.88G H
MultiFilterable88H W
(88W X
true88X \
)88\ ]
;88] ^
col99 	
.99	 

Columns99
 
.99 
Add99 
(99 
x99 
=>99 
x99 
.99 
Question99 %
)99% &
.99& '
Titled99' -
(99- .
$str99. 4
)994 5
;995 6
col:: 	
.::	 

Columns::
 
.:: 
Add:: 
(:: 
x:: 
=>:: 
x:: 
.:: 
ValidAnswerType:: ,
)::, -
.::- .
Titled::. 4
(::4 5
$str::5 B
)::B C
;::C D
col;; 	
.;;	 

Columns;;
 
.;; 
Add;; 
(;; 
x;; 
=>;; 
x;; 
.;; 
Point;; "
);;" #
.;;# $
Titled;;$ *
(;;* +
$str;;+ 7
);;7 8
;;;8 9
col<< 	
.<<	 

Pager<<
 
=<< 
new<< 
	GridPager<< 
<<<  
KnowledgeTest<<  -
><<- .
(<<. /
col<</ 2
)<<2 3
;<<3 4
col== 	
.==	 


Processors==
 
.== 
Add== 
(== 
col== 
.== 
Pager== "
)==" #
;==# $
col>> 	
.>>	 

Pager>>
 
.>> 
RowsPerPage>> 
=>> 
$num>>  
;>>  !
col?? 	
.??	 

	EmptyText??
 
=?? 
$str?? 1
;??1 2
foreach@@ 
(@@ 
IGridColumn@@ 
column@@ !
in@@" $
col@@% (
.@@( )
Columns@@) 0
)@@0 1
{AA 
columnBB 
.BB 
IsFilterableBB 
=BB 
trueBB "
;BB" #
columnCC 
.CC 

IsSortableCC 
=CC 
trueCC  
;CC  !
}DD 
varEE 	
totalEE
 
=EE  
_totalRowsRepositoryEE &
.EE& '
TableEE' ,
.EE, -
WhereEE- 2
(EE2 3
xEE3 4
=>EE5 7
xEE8 9
.EE9 :
	TableNameEE: C
==EED F
$strEEG W
)EEW X
.EEX Y
SelectEEY _
(EE_ `
xEE` a
=>EEb d
xEEe f
.EEf g
	TableRowsEEg p
)EEp q
.EEq r
FirstEEr w
(EEw x
)EEx y
;EEy z
ViewBagFF 
.FF 
	totalRowsFF 
=FF 
ConvertFF !
.FF! "
ToInt32FF" )
(FF) *
totalFF* /
)FF/ 0
;FF0 1
returnGG 
ViewGG 
(GG 
colGG 
)GG 
;GG 
}HH 
[II 
SecuredOperationII 
(II 
RolesII 
=II 
$strII 6
)II6 7
]II7 8
publicJJ 

ActionResultJJ 
QuestionJJ  
(JJ  !
)JJ! "
{KK 
varLL 	
dateLL
 
=LL 
DateTimeLL 
.LL 
NowLL 
.LL 
ToShortDateStringLL /
(LL/ 0
)LL0 1
;LL1 2
varMM 	
userIdMM
 
=MM 
ConvertMM 
.MM 
ToInt32MM "
(MM" #
GeneralHelpersMM# 1
.MM1 2
	GetUserIdMM2 ;
(MM; <
)MM< =
)MM= >
;MM> ?
varNN 	
quizNN
 
=NN !
_knowledgeTestServiceNN &
.NN& '
GetAllNN' -
(NN- .
)NN. /
.NN/ 0
WhereNN0 5
(NN5 6
xNN6 7
=>NN8 :
(NN; <
ConvertNN< C
.NNC D

ToDateTimeNND N
(NNN O
xNNO P
.NNP Q
KnowledgeDateNNQ ^
.NN^ _
ToShortDateStringNN_ p
(NNp q
)NNq r
)NNr s
==NNt v
ConvertNNw ~
.NN~ 

ToDateTime	NN â
(
NNâ ä
date
NNä é
)
NNé è
)
NNè ê
)
NNê ë
.
NNë í
ToList
NNí ò
(
NNò ô
)
NNô ö
;
NNö õ
varOO 	
answerOO
 
=OO &
_answerQueryableRepositoryOO -
.OO- .
TableOO. 3
.OO3 4
WhereOO4 9
(OO9 :
xOO: ;
=>OO< >
xOO? @
.OO@ A
UserIdOOA G
==OOH J
userIdOOK Q
)OOQ R
.OOR S
ToListOOS Y
(OOY Z
)OOZ [
;OO[ \
ListPP 

<PP
 
KnowledgeTestPP 
>PP 
quizListPP "
=PP# $
newPP% (
ListPP) -
<PP- .
KnowledgeTestPP. ;
>PP; <
(PP< =
)PP= >
;PP> ?
ifQQ 
(QQ	 

answerQQ
 
.QQ 
CountQQ 
==QQ 
$numQQ 
)QQ 
{RR 
returnSS 
ViewSS 
(SS 
quizSS 
)SS 
;SS 
}TT 
foreachUU 
(UU 
varUU 
quizItemUU 
inUU 
quizUU #
)UU# $
{VV 
foreachXX 
(XX 
varXX 

answerItemXX 
inXX  "
answerXX# )
)XX) *
{YY 	
ifZZ
 
(ZZ 
answerZZ 
.ZZ 
CountZZ 
!=ZZ 
quizZZ  
.ZZ  !
CountZZ! &
)ZZ& '
{[[
 
if\\ 
(\\ 
quizItem\\ 
.\\ 
KnowledgeTestId\\ (
!=\\) +

answerItem\\, 6
.\\6 7
KnowledgeTestId\\7 F
)\\F G
{]] 
quizList^^ 
.^^ 
Add^^ 
(^^ !
_knowledgeTestService^^ 0
.^^0 1
GetById^^1 8
(^^8 9

answerItem^^9 C
.^^C D
KnowledgeTestId^^D S
)^^S T
)^^T U
;^^U V
}__ 
}``
 
}bb 	
}dd 
returnee 
Viewee 
(ee 
quizListee 
)ee 
;ee 
}ff 
[gg 
HttpPostgg 
]gg 
publichh 

ActionResulthh 
Questionhh  
(hh  !
FormCollectionhh! /
formhh0 4
,hh4 5
inthh6 9

questionidhh: D
)hhD E
{ii 
varjj 	
formIdjj
 
=jj  
_queryableRepositoryjj '
.jj' (
Tablejj( -
.jj- .
FirstOrDefaultjj. <
(jj< =
xjj= >
=>jj? A
xjjB C
.jjC D
KnowledgeTestIdjjD S
==jjT V

questionidjjW a
)jja b
;jjb c
varkk 	
keyskk
 
=kk 
Requestkk 
.kk 
Formkk 
.kk 
AllKeyskk %
;kk% &
varll 	
reqFormll
 
=ll 
formll 
[ll 
$strll (
]ll( )
;ll) *
varmm 	
datemm
 
=mm 
DateTimemm 
.mm 
Nowmm 
.mm 
ToShortDateStringmm /
(mm/ 0
)mm0 1
;mm1 2
varnn 	
quiznn
 
=nn !
_knowledgeTestServicenn &
.nn& '
GetAllnn' -
(nn- .
)nn. /
.nn/ 0
Wherenn0 5
(nn5 6
xnn6 7
=>nn8 :
(nn; <
Convertnn< C
.nnC D

ToDateTimennD N
(nnN O
xnnO P
.nnP Q
KnowledgeDatennQ ^
.nn^ _
ToShortDateStringnn_ p
(nnp q
)nnq r
)nnr s
==nnt v
Convertnnw ~
.nn~ 

ToDateTime	nn â
(
nnâ ä
date
nnä é
)
nné è
)
nnè ê
)
nnê ë
;
nnë í
varoo 	
quizListoo
 
=oo 
quizoo 
.oo 
ToListoo  
(oo  !
)oo! "
;oo" #
ifpp 
(pp	 

reqFormpp
 
==pp 
formIdpp 
.pp 
ValidAnswerTypepp +
)pp+ ,
{qq 
_answerServicerr 
.rr 
Addrr 
(rr 
newrr 
Answerrr %
{ss 	
UserIdtt
 
=tt 
Converttt 
.tt 
ToInt32tt "
(tt" #
GeneralHelperstt# 1
.tt1 2
	GetUserIdtt2 ;
(tt; <
)tt< =
)tt= >
,tt> ?
KnowledgeTestIduu
 
=uu 

questioniduu &
,uu& '

AnswerDatevv
 
=vv 
DateTimevv 
.vv  
Nowvv  #
,vv# $
ValidAnswerww
 
=ww 
trueww 
}xx 	
)xx	 

;xx
 
_scoreServiceyy 
.yy 
Addyy 
(yy 
newyy 
Scoreyy #
{zz 	
UserId{{
 
={{ 
Convert{{ 
.{{ 
ToInt32{{ "
({{" #
GeneralHelpers{{# 1
.{{1 2
	GetUserId{{2 ;
({{; <
){{< =
){{= >
,{{> ?

ScoreTotal||
 
=|| 
formId|| 
.|| 
Point|| #
,||# $
	ScoreType}}
 
=}} 
	ScoreType}} 
.}}  
BilgiModulu}}  +
,}}+ ,
}~~ 	
)~~	 

;~~
 
SuccessNotification 
( 
$str 9
)9 :
;: ;
}
ÄÄ 
else
ÅÅ 

{
ÇÇ 
_answerService
ÉÉ 
.
ÉÉ 
Add
ÉÉ 
(
ÉÉ 
new
ÉÉ 
Answer
ÉÉ %
{
ÑÑ 	
UserId
ÖÖ
 
=
ÖÖ 
Convert
ÖÖ 
.
ÖÖ 
ToInt32
ÖÖ "
(
ÖÖ" #
GeneralHelpers
ÖÖ# 1
.
ÖÖ1 2
	GetUserId
ÖÖ2 ;
(
ÖÖ; <
)
ÖÖ< =
)
ÖÖ= >
,
ÖÖ> ?
KnowledgeTestId
ÜÜ
 
=
ÜÜ 

questionid
ÜÜ &
,
ÜÜ& '

AnswerDate
áá
 
=
áá 
DateTime
áá 
.
áá  
Now
áá  #
,
áá# $
ValidAnswer
àà
 
=
àà 
false
àà 
}
ââ 	
)
ââ	 

;
ââ
 
ErrorNotification
ää 
(
ää 
$str
ää 0
+
ää1 2
formId
ää3 9
.
ää9 :
ValidAnswerType
ää: I
+
ääJ K
$str
ääL [
)
ää[ \
;
ää\ ]
}
ãã 
return
çç 
RedirectToAction
çç 
(
çç 
$str
çç (
)
çç( )
;
çç) *
}
éé 
[
êê 
SecuredOperation
êê 
(
êê 
Roles
êê 
=
êê 
$str
êê +
)
êê+ ,
]
êê, -
public
ëë 

ActionResult
ëë 
Create
ëë 
(
ëë 
)
ëë  
{
íí 
var
ìì 	
empty
ìì
 
=
ìì 
new
ìì $
KnowledgeTestViewModel
ìì ,
(
ìì, -
)
ìì- .
;
ìì. /
var
îî 	
data
îî
 
=
îî 
empty
îî 
.
îî 
ToVM
îî 
(
îî 
)
îî 
;
îî 
return
ïï 
View
ïï 
(
ïï 
data
ïï 
)
ïï 
;
ïï 
}
ññ 
[
òò 
HttpPost
òò 
]
òò 
public
ôô 

ActionResult
ôô 
Create
ôô 
(
ôô $
KnowledgeTestViewModel
ôô 5
knowledgeTest
ôô6 C
)
ôôC D
{
öö 
if
õõ 
(
õõ	 

!
õõ
 

ModelState
õõ 
.
õõ 
IsValid
õõ 
)
õõ 
{
úú 
ErrorNotification
ùù 
(
ùù 
$str
ùù -
)
ùù- .
;
ùù. /
return
ûû 
RedirectToAction
ûû 
(
ûû  
$str
ûû  (
)
ûû( )
;
ûû) *
}
üü #
_knowledgeTestService
†† 
.
†† 
Add
†† 
(
††  
new
††  #
KnowledgeTest
††$ 1
{
°° 
Question
¢¢ 
=
¢¢ 
knowledgeTest
¢¢  
.
¢¢  !
Question
¢¢! )
,
¢¢) *
Answer1
££ 
=
££ 
knowledgeTest
££ 
.
££  
Answer1
££  '
,
££' (
Answer2
§§ 
=
§§ 
knowledgeTest
§§ 
.
§§  
Answer2
§§  '
,
§§' (
Answer3
•• 
=
•• 
knowledgeTest
•• 
.
••  
Answer3
••  '
,
••' (
Answer4
¶¶ 
=
¶¶ 
knowledgeTest
¶¶ 
.
¶¶  
Answer4
¶¶  '
,
¶¶' (
KnowledgeDate
ßß 
=
ßß 
DateTime
ßß  
.
ßß  !
Now
ßß! $
,
ßß$ %
Point
®® 
=
®® 
knowledgeTest
®® 
.
®® 
Point
®® #
,
®®# $
IsActive
©© 
=
©© 
knowledgeTest
©©  
.
©©  !
IsActive
©©! )
,
©©) *
ValidAnswerType
™™ 
=
™™ 
knowledgeTest
™™ '
.
™™' (
ValidAnswerType
™™( 7
}
´´ 
)
´´ 
;
´´ 	!
SuccessNotification
¨¨ 
(
¨¨ 
$str
¨¨ *
)
¨¨* +
;
¨¨+ ,
return
≠≠ 
RedirectToAction
≠≠ 
(
≠≠ 
$str
≠≠ 2
)
≠≠2 3
;
≠≠3 4
}
ÆÆ 
[
∞∞ 
SecuredOperation
∞∞ 
(
∞∞ 
Roles
∞∞ 
=
∞∞ 
$str
∞∞ +
)
∞∞+ ,
]
∞∞, -
public
±± 

ActionResult
±± 
Edit
±± 
(
±± 
int
±±  
id
±±! #
)
±±# $
{
≤≤ 
var
≥≥ 	
data
≥≥
 
=
≥≥ 
AutoMapperHelper
≥≥ !
.
≥≥! " 
MapToSameViewModel
≥≥" 4
<
≥≥4 5
KnowledgeTest
≥≥5 B
,
≥≥B C$
KnowledgeTestViewModel
≥≥D Z
>
≥≥Z [
(
≥≥[ \#
_knowledgeTestService
≥≥\ q
.
≥≥q r
GetById
≥≥r y
(
≥≥y z
id
≥≥z |
)
≥≥| }
)
≥≥} ~
;
≥≥~ 
return
¥¥ 
View
¥¥ 
(
¥¥ 
data
¥¥ 
.
¥¥ 
ToVM
¥¥ 
(
¥¥ 
)
¥¥ 
)
¥¥ 
;
¥¥ 
}
µµ 
[
∑∑ 
HttpPost
∑∑ 
]
∑∑ 
public
∏∏ 

ActionResult
∏∏ 
Edit
∏∏ 
(
∏∏ 
KnowledgeTest
∏∏ *
knowledgeTest
∏∏+ 8
)
∏∏8 9
{
ππ 
try
∫∫ 	
{
ªª #
_knowledgeTestService
ºº 
.
ºº 
Update
ºº $
(
ºº$ %
new
ºº% (
KnowledgeTest
ºº) 6
{
ΩΩ 	
Question
ææ
 
=
ææ 
knowledgeTest
ææ "
.
ææ" #
Question
ææ# +
,
ææ+ ,
Answer1
øø
 
=
øø 
knowledgeTest
øø !
.
øø! "
Answer1
øø" )
,
øø) *
Answer2
¿¿
 
=
¿¿ 
knowledgeTest
¿¿ !
.
¿¿! "
Answer2
¿¿" )
,
¿¿) *
Answer3
¡¡
 
=
¡¡ 
knowledgeTest
¡¡ !
.
¡¡! "
Answer3
¡¡" )
,
¡¡) *
Answer4
¬¬
 
=
¬¬ 
knowledgeTest
¬¬ !
.
¬¬! "
Answer4
¬¬" )
,
¬¬) *
KnowledgeDate
√√
 
=
√√ 
DateTime
√√ "
.
√√" #
Now
√√# &
,
√√& '
Point
ƒƒ
 
=
ƒƒ 
knowledgeTest
ƒƒ 
.
ƒƒ  
Point
ƒƒ  %
,
ƒƒ% &
IsActive
≈≈
 
=
≈≈ 
knowledgeTest
≈≈ "
.
≈≈" #
IsActive
≈≈# +
,
≈≈+ ,
ValidAnswerType
∆∆
 
=
∆∆ 
knowledgeTest
∆∆ )
.
∆∆) *
ValidAnswerType
∆∆* 9
,
∆∆9 :
KnowledgeTestId
««
 
=
«« 
knowledgeTest
«« )
.
««) *
KnowledgeTestId
««* 9
}
»» 	
)
»»	 

;
»»
 !
SuccessNotification
…… 
(
…… 
$str
…… /
)
……/ 0
;
……0 1
return
   
RedirectToAction
   
(
    
$str
    4
)
  4 5
;
  5 6
}
ÀÀ 
catch
ÃÃ 
{
ÕÕ 
return
ŒŒ 
View
ŒŒ 
(
ŒŒ 
)
ŒŒ 
;
ŒŒ 
}
œœ 
}
–– 
[
““ 
SecuredOperation
““ 
(
““ 
Roles
““ 
=
““ 
$str
““ +
)
““+ ,
]
““, -
public
”” 

ActionResult
”” 
Delete
”” 
(
”” 
int
”” "
id
””# %
,
””% &
KnowledgeTest
””' 4
knowledgeTest
””5 B
)
””B C
{
‘‘ 
var
’’ 	
data
’’
 
=
’’ 
AutoMapperHelper
’’ !
.
’’! " 
MapToSameViewModel
’’" 4
<
’’4 5
KnowledgeTest
’’5 B
,
’’B C$
KnowledgeTestViewModel
’’D Z
>
’’Z [
(
’’[ \#
_knowledgeTestService
’’\ q
.
’’q r
GetById
’’r y
(
’’y z
id
’’z |
)
’’| }
)
’’} ~
;
’’~ 
return
÷÷ 
View
÷÷ 
(
÷÷ 
data
÷÷ 
.
÷÷ 
ToVM
÷÷ 
(
÷÷ 
)
÷÷ 
)
÷÷ 
;
÷÷ 
}
◊◊ 
[
ŸŸ 
HttpPost
ŸŸ 
]
ŸŸ 
public
⁄⁄ 

ActionResult
⁄⁄ 
Delete
⁄⁄ 
(
⁄⁄ 
int
⁄⁄ "
id
⁄⁄# %
)
⁄⁄% &
{
€€ 
try
‹‹ 	
{
›› #
_knowledgeTestService
ﬁﬁ 
.
ﬁﬁ 
Delete
ﬁﬁ $
(
ﬁﬁ$ %#
_knowledgeTestService
ﬁﬁ% :
.
ﬁﬁ: ;
GetById
ﬁﬁ; B
(
ﬁﬁB C
id
ﬁﬁC E
)
ﬁﬁE F
)
ﬁﬁF G
;
ﬁﬁG H!
SuccessNotification
ﬂﬂ 
(
ﬂﬂ 
$str
ﬂﬂ +
)
ﬂﬂ+ ,
;
ﬂﬂ, -
return
‡‡ 
RedirectToAction
‡‡ 
(
‡‡  
$str
‡‡  4
)
‡‡4 5
;
‡‡5 6
}
·· 
catch
‚‚ 
{
„„ 
return
‰‰ 
View
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
}
ÂÂ 
}
ÊÊ 
}
ÁÁ 
}ËË Ÿ^
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\LanguageController.cs
	namespace 	
BayiPuan
 
. 
MVCWebUI 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class 
LanguageController #
:$ %
BaseController& 4
{ 
private 
readonly 
ILanguageService )
_languageService* :
;: ;
private 
readonly  
IQueryableRepository -
<- .
Language. 6
>6 7 
_queryableRepository8 L
;L M
private 
readonly  
IQueryableRepository -
<- .
vwRP_StockCount. =
>= > 
_totalRowsRepository? S
;S T
public 
LanguageController !
(! "
ILanguageService" 2
languageService3 B
,B C 
IQueryableRepositoryD X
<X Y
LanguageY a
>a b
queryableRepositoryc v
,v w!
IQueryableRepository	x å
<
å ç
vwRP_StockCount
ç ú
>
ú ù!
totalRowsRepository
û ±
)
± ≤
{ 	
_languageService 
= 
languageService .
;. / 
_queryableRepository  
=! "
queryableRepository# 6
;6 7 
_totalRowsRepository  
=! "
totalRowsRepository# 6
;6 7
}   	
[!! 
SecuredOperation!! 
(!! 
Roles!! 
=!! 
$str!! +
)!!+ ,
]!!, -
[## 	
SecuredOperation##	 
(## 
Roles## 
=##  !
$str##" /
)##/ 0
]##0 1
public$$ 
ActionResult$$ 
LanguageIndex$$ )
($$) *
Int32$$* /
?$$/ 0
page$$1 5
,$$5 6
Int32$$7 <
?$$< =
rows$$> B
)$$B C
{%% 	
IGrid&& 
<&& 
Language&& 
>&& 
col&& 
=&&  !
new&&" %
Grid&&& *
<&&* +
Language&&+ 3
>&&3 4
(&&4 5 
_queryableRepository&&5 I
.&&I J
Table&&J O
.&&O P
OrderByDescending&&P a
(&&a b
x&&b c
=>&&d f
x&&g h
.&&h i

LanguageId&&i s
)&&s t
.&&t u
Skip&&u y
(&&y z
(&&z {
page&&{ 
-
&&Ä Å
$num
&&Ç É
??
&&Ñ Ü
$num
&&á à
)
&&à â
*
&&ä ã
(
&&å ç
rows
&&ç ë
??
&&í î
$num
&&ï ó
)
&&ó ò
)
&&ò ô
.
&&ô ö
Take
&&ö û
(
&&û ü
rows
&&ü £
??
&&§ ¶
$num
&&ß ©
)
&&© ™
.
&&™ ´
AsNoTracking
&&´ ∑
(
&&∑ ∏
)
&&∏ π
)
&&π ∫
;
&&∫ ª
col'' 
.'' 
Query'' 
='' 
new'' 
NameValueCollection'' /
(''/ 0
Request''0 7
.''7 8
QueryString''8 C
)''C D
;''D E
if)) 
()) 
col)) 
.)) 
Query)) 
!=)) 
null)) !
)))! "
{** 
col++ 
=++ 
new++ 
Grid++ 
<++ 
Language++ '
>++' (
(++( ) 
_queryableRepository++) =
.++= >
Table++> C
.++C D
OrderByDescending++D U
(++U V
x++V W
=>++X Z
x++[ \
.++\ ]

LanguageId++] g
)++g h
.++h i
AsNoTracking++i u
(++u v
)++v w
)++w x
;++x y
},, 
col-- 
.-- 
Columns-- 
.-- 
Add-- 
(-- 
x-- 
=>--  
$str--! n
+--o p
x--q r
.--r s

LanguageId--s }
+--~ 
$str
--Ä â
+
--ä ã
$str..! v
+..w x
x..y z
...z {

LanguageId	..{ Ö
+
..Ü á
$str
..à ë
)
..ë í
.// 
Encoded// 
(// 
false// 
)// 
.//  
Titled//  &
(//& '
$str//' 1
)//1 2
.//2 3

Filterable//3 =
(//= >
false//> C
)//C D
;//D E
col11 
.11 
Columns11 
.11 
Add11 
(11 
x11 
=>11  
x11! "
.11" #

LanguageId11# -
)11- .
.11. /
Titled11/ 5
(115 6
$str116 B
)11B C
.11C D
MultiFilterable11D S
(11S T
true11T X
)11X Y
;11Y Z
col33 
.33 
Pager33 
=33 
new33 
	GridPager33 %
<33% &
Language33& .
>33. /
(33/ 0
col330 3
)333 4
;334 5
col44 
.44 

Processors44 
.44 
Add44 
(44 
col44 "
.44" #
Pager44# (
)44( )
;44) *
col55 
.55 
Pager55 
.55 
RowsPerPage55 !
=55" #
$num55$ &
;55& '
col66 
.66 
	EmptyText66 
=66 
$str66 7
;667 8
foreach77 
(77 
IGridColumn77  
column77! '
in77( *
col77+ .
.77. /
Columns77/ 6
)776 7
{88 
column99 
.99 
IsFilterable99 #
=99$ %
true99& *
;99* +
column:: 
.:: 

IsSortable:: !
=::" #
true::$ (
;::( )
};; 
var<< 
total<< 
=<<  
_totalRowsRepository<< ,
.<<, -
Table<<- 2
.<<2 3
AsNoTracking<<3 ?
(<<? @
)<<@ A
.<<A B
Where<<B G
(<<G H
x<<H I
=><<J L
x<<M N
.<<N O
	TableName<<O X
==<<Y [
$str<<\ g
)<<g h
.<<h i
Select<<i o
(<<o p
x<<p q
=><<r t
x<<u v
.<<v w
	TableRows	<<w Ä
)
<<Ä Å
.
<<Å Ç
First
<<Ç á
(
<<á à
)
<<à â
;
<<â ä
ViewBag== 
.== 
	totalRows== 
=== 
Convert==  '
.==' (
ToInt32==( /
(==/ 0
total==0 5
)==5 6
;==6 7
return>> 
View>> 
(>> 
col>> 
)>> 
;>> 
}?? 	
[AA 	
SecuredOperationAA	 
(AA 
RolesAA 
=AA  !
$strAA" /
)AA/ 0
]AA0 1
publicBB 
ActionResultBB 
CreateBB "
(BB" #
)BB# $
{CC 	
varDD 
emptyDD 
=DD 
newDD 
LanguageViewModelDD -
(DD- .
)DD. /
;DD/ 0
varEE 
dataEE 
=EE 
emptyEE 
.EE 
ToVMEE !
(EE! "
)EE" #
;EE# $
returnFF 
ViewFF 
(FF 
dataFF 
)FF 
;FF 
}GG 	
[II 	
HttpPostII	 
]II 
publicJJ 
ActionResultJJ 
CreateJJ "
(JJ" #
LanguageViewModelJJ# 4
languageJJ5 =
)JJ= >
{KK 	
ifLL 
(LL 
!LL 

ModelStateLL 
.LL 
IsValidLL #
)LL# $
{MM 
ErrorNotificationNN !
(NN! "
$strNN" 5
)NN5 6
;NN6 7
returnOO 
RedirectToActionOO '
(OO' (
$strOO( 0
)OO0 1
;OO1 2
}PP 
_languageServiceQQ 
.QQ 
AddQQ  
(QQ  !
newQQ! $
LanguageQQ% -
{RR 
}VV 
)VV 
;VV 
SuccessNotificationWW 
(WW  
$strWW  0
)WW0 1
;WW1 2
returnXX 
RedirectToActionXX #
(XX# $
$strXX$ 3
)XX3 4
;XX4 5
}YY 	
[[[ 	
SecuredOperation[[	 
([[ 
Roles[[ 
=[[  !
$str[[" /
)[[/ 0
][[0 1
public\\ 
ActionResult\\ 
Edit\\  
(\\  !
int\\! $
id\\% '
)\\' (
{]] 	
var^^ 
data^^ 
=^^ 
AutoMapperHelper^^ '
.^^' (
MapToSameViewModel^^( :
<^^: ;
Language^^; C
,^^C D
LanguageViewModel^^E V
>^^V W
(^^W X
_languageService^^X h
.^^h i
GetById^^i p
(^^p q
id^^q s
)^^s t
)^^t u
;^^u v
return__ 
View__ 
(__ 
data__ 
.__ 
ToVM__ !
(__! "
)__" #
)__# $
;__$ %
}`` 	
[bb 	
HttpPostbb	 
]bb 
publiccc 
ActionResultcc 
Editcc  
(cc  !
Languagecc" *
languagecc+ 3
)cc3 4
{dd 	
tryee 
{ff 
_languageServicehh  
.hh  !
Updatehh! '
(hh' (
newhh( +
Languagehh- 5
{ii 
}mm 
)mm 
;mm 
SuccessNotificationnn #
(nn# $
$strnn$ 7
)nn7 8
;nn8 9
returnoo 
RedirectToActionoo '
(oo' (
$stroo( 7
)oo7 8
;oo8 9
}pp 
catchqq 
{rr 
returnss 
Viewss 
(ss 
)ss 
;ss 
}tt 
}uu 	
[ww 	
SecuredOperationww	 
(ww 
Rolesww 
=ww  !
$strww" /
)ww/ 0
]ww0 1
publicxx 
ActionResultxx 
Deletexx "
(xx" #
intxx# &
idxx' )
,xx) *
Languagexx+ 3
languagexx4 <
)xx< =
{yy 	
varzz 
datazz 
=zz 
AutoMapperHelperzz '
.zz' (
MapToSameViewModelzz( :
<zz: ;
Languagezz; C
,zzC D
LanguageViewModelzzE V
>zzV W
(zzW X
_languageServicezzX h
.zzh i
GetByIdzzi p
(zzp q
idzzq s
)zzs t
)zzt u
;zzu v
return{{ 
View{{ 
({{ 
data{{ 
.{{ 
ToVM{{ !
({{! "
){{" #
){{# $
;{{$ %
}|| 	
[~~ 	
HttpPost~~	 
]~~ 
public 
ActionResult 
Delete "
(" #
int# &
id' )
)) *
{
ÄÄ 	
try
ÅÅ 
{
ÇÇ 
_languageService
ÉÉ  
.
ÉÉ  !
Delete
ÉÉ! '
(
ÉÉ' (
_languageService
ÉÉ( 8
.
ÉÉ8 9
GetById
ÉÉ9 @
(
ÉÉ@ A
id
ÉÉA C
)
ÉÉC D
)
ÉÉD E
;
ÉÉE F!
SuccessNotification
ÑÑ #
(
ÑÑ# $
$str
ÑÑ$ 3
)
ÑÑ3 4
;
ÑÑ4 5
return
ÖÖ 
RedirectToAction
ÖÖ '
(
ÖÖ' (
$str
ÖÖ( 7
)
ÖÖ7 8
;
ÖÖ8 9
}
ÜÜ 
catch
áá 
{
àà 
return
ââ 
View
ââ 
(
ââ 
)
ââ 
;
ââ 
}
ää 
}
ãã 	
}
åå 
}çç ÕD
TE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\LanguageWordController.cs
	namespace 	
BayiPuan
 
. 
MVCWebUI 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class "
LanguageWordController '
:( )
BaseController* 8
{ 
private 
readonly  
ILanguageWordService - 
_languageWordService. B
;B C
private 
readonly  
IQueryableRepository -
<- .
LanguageWord. :
>: ; 
_queryableRepository< P
;P Q
private 
readonly  
IQueryableRepository -
<- .
vwRP_StockCount. =
>= > 
_totalRowsRepository? S
;S T
public "
LanguageWordController %
(% & 
ILanguageWordService& :
languageWordService; N
,N O 
IQueryableRepositoryP d
<d e
LanguageWorde q
>q r 
queryableRepository	s Ü
,
Ü á"
IQueryableRepository
à ú
<
ú ù
vwRP_StockCount
ù ¨
>
¨ ≠!
totalRowsRepository
Æ ¡
)
¡ ¬
{ 	 
_languageWordService  
=! "
languageWordService# 6
;6 7 
_queryableRepository  
=! "
queryableRepository# 6
;6 7 
_totalRowsRepository  
=! "
totalRowsRepository# 6
;6 7
} 	
[ 
SecuredOperation 
( 
Roles 
= 
$str +
)+ ,
], -
[!! 	
SecuredOperation!!	 
(!! 
Roles!! 
=!!  !
$str!!" /
)!!/ 0
]!!0 1
public"" 
ActionResult"" 
LanguageWordIndex"" -
(""- .
Int32"". 3
?""3 4
page""5 9
,""9 :
Int32""; @
?""@ A
rows""B F
)""F G
{## 	
IGrid$$ 
<$$ 
LanguageWord$$ 
>$$ 
col$$  #
=$$$ %
new$$& )
Grid$$* .
<$$. /
LanguageWord$$/ ;
>$$; <
($$< = 
_queryableRepository$$= Q
.$$Q R
Table$$R W
.$$W X
OrderByDescending$$X i
($$i j
x$$j k
=>$$l n
x$$o p
.$$p q

LanguageId$$q {
)$${ |
.$$| }
Skip	$$} Å
(
$$Å Ç
(
$$Ç É
page
$$É á
-
$$à â
$num
$$ä ã
??
$$å é
$num
$$è ê
)
$$ê ë
*
$$í ì
(
$$î ï
rows
$$ï ô
??
$$ö ú
$num
$$ù ü
)
$$ü †
)
$$† °
.
$$° ¢
Take
$$¢ ¶
(
$$¶ ß
rows
$$ß ´
??
$$¨ Æ
$num
$$Ø ±
)
$$± ≤
.
$$≤ ≥
AsNoTracking
$$≥ ø
(
$$ø ¿
)
$$¿ ¡
)
$$¡ ¬
;
$$¬ √
col%% 
.%% 
Query%% 
=%% 
new%% 
NameValueCollection%% /
(%%/ 0
Request%%0 7
.%%7 8
QueryString%%8 C
)%%C D
;%%D E
if'' 
('' 
col'' 
.'' 
Query'' 
!='' 
null'' !
)''! "
{(( 
col)) 
=)) 
new)) 
Grid)) 
<)) 
LanguageWord)) +
>))+ ,
()), - 
_queryableRepository))- A
.))A B
Table))B G
.))G H
OrderByDescending))H Y
())Y Z
x))Z [
=>))\ ^
x))_ `
.))` a

LanguageId))a k
)))k l
.))l m
AsNoTracking))m y
())y z
)))z {
))){ |
;))| }
}** 
col++ 
.++ 
Columns++ 
.++ 
Add++ 
(++ 
x++ 
=>++  
$str++! n
+++o p
x++q r
.++r s

LanguageId++s }
+++~ 
$str
++Ä â
+
++ä ã
$str,,! v
+,,w x
x,,y z
.,,z {

LanguageId	,,{ Ö
+
,,Ü á
$str
,,à ë
)
,,ë í
.-- 
Encoded-- 
(-- 
false-- 
)-- 
.--  
Titled--  &
(--& '
$str--' 1
)--1 2
.--2 3

Filterable--3 =
(--= >
false--> C
)--C D
;--D E
col// 
.// 
Columns// 
.// 
Add// 
(// 
x// 
=>//  
x//! "
.//" #

LanguageId//# -
)//- .
.//. /
Titled/// 5
(//5 6
$str//6 B
)//B C
.//C D
MultiFilterable//D S
(//S T
true//T X
)//X Y
;//Y Z
col11 
.11 
Pager11 
=11 
new11 
	GridPager11 %
<11% &
LanguageWord11& 2
>112 3
(113 4
col114 7
)117 8
;118 9
col22 
.22 

Processors22 
.22 
Add22 
(22 
col22 "
.22" #
Pager22# (
)22( )
;22) *
col33 
.33 
Pager33 
.33 
RowsPerPage33 !
=33" #
$num33$ &
;33& '
col44 
.44 
	EmptyText44 
=44 
$str44 7
;447 8
foreach55 
(55 
IGridColumn55  
column55! '
in55( *
col55+ .
.55. /
Columns55/ 6
)556 7
{66 
column77 
.77 
IsFilterable77 #
=77$ %
true77& *
;77* +
column88 
.88 

IsSortable88 !
=88" #
true88$ (
;88( )
}99 
var:: 
total:: 
=::  
_totalRowsRepository:: ,
.::, -
Table::- 2
.::2 3
AsNoTracking::3 ?
(::? @
)::@ A
.::A B
Where::B G
(::G H
x::H I
=>::J L
x::M N
.::N O
	TableName::O X
==::Y [
$str::\ k
)::k l
.::l m
Select::m s
(::s t
x::t u
=>::v x
x::y z
.::z {
	TableRows	::{ Ñ
)
::Ñ Ö
.
::Ö Ü
First
::Ü ã
(
::ã å
)
::å ç
;
::ç é
ViewBag;; 
.;; 
	totalRows;; 
=;; 
Convert;;  '
.;;' (
ToInt32;;( /
(;;/ 0
total;;0 5
);;5 6
;;;6 7
return<< 
View<< 
(<< 
col<< 
)<< 
;<< 
}== 	
[?? 	
SecuredOperation??	 
(?? 
Roles?? 
=??  !
$str??" /
)??/ 0
]??0 1
public@@ 
ActionResult@@ 
Create@@ "
(@@" #
)@@# $
{AA 	
varBB 
emptyBB 
=BB 
newBB !
LanguageWordViewModelBB 1
(BB1 2
)BB2 3
;BB3 4
varCC 
dataCC 
=CC 
emptyCC 
.CC 
ToVMCC !
(CC! "
)CC" #
;CC# $
returnDD 
ViewDD 
(DD 
dataDD 
)DD 
;DD 
}EE 	
[GG 	
HttpPostGG	 
]GG 
publicHH 
ActionResultHH 
CreateHH "
(HH" #!
LanguageWordViewModelHH# 8
languageWordHH9 E
)HHE F
{II 	
ifJJ 
(JJ 
!JJ 

ModelStateJJ 
.JJ 
IsValidJJ #
)JJ# $
{KK 
ErrorNotificationLL !
(LL! "
$strLL" 5
)LL5 6
;LL6 7
returnMM 
RedirectToActionMM '
(MM' (
$strMM( 0
)MM0 1
;MM1 2
}NN  
_languageWordServiceOO  
.OO  !
AddOO! $
(OO$ %
newOO% (
LanguageWordOO) 5
{PP 
}TT 
)TT 
;TT 
SuccessNotificationUU 
(UU  
$strUU  0
)UU0 1
;UU1 2
returnVV 
RedirectToActionVV #
(VV# $
$strVV$ 7
)VV7 8
;VV8 9
}WW 	
}XX 
}YY ¿
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\MenuHomeController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
public 

class 
MenuHomeController #
:$ %

Controller& 0
{ 
public 
ActionResult 
Index !
(! "
)" #
{		 	
return

 
View

 
(

 
)

 
;

 
} 	
} 
} ôñ
ME:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\MyNewController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class 
MyNewController  
:! "
BaseController# 1
{ 
private 
readonly 
IMyNewService &
_myNewService' 4
;4 5
private 
readonly  
IQueryableRepository -
<- .
MyNew. 3
>3 4 
_queryableRepository5 I
;I J
private 
readonly  
IQueryableRepository -
<- .
vwRP_StockCount. =
>= > 
_totalRowsRepository? S
;S T
public 
MyNewController 
( 
IMyNewService ,
myNewService- 9
,9 : 
IQueryableRepository; O
<O P
MyNewP U
>U V
queryableRepositoryW j
,j k!
IQueryableRepository	l Ä
<
Ä Å
vwRP_StockCount
Å ê
>
ê ë!
totalRowsRepository
í •
)
• ¶
{ 	
_myNewService 
= 
myNewService (
;( ) 
_queryableRepository  
=! "
queryableRepository# 6
;6 7 
_totalRowsRepository  
=! "
totalRowsRepository# 6
;6 7
} 	
[   	
SecuredOperation  	 
(   
Roles   
=    !
$str  " /
)  / 0
]  0 1
public!! 
ActionResult!! 

MyNewIndex!! &
(!!& '
Int32!!' ,
?!!, -
page!!. 2
,!!2 3
Int32!!4 9
?!!9 :
rows!!; ?
)!!? @
{"" 	
IGrid## 
<## 
MyNew## 
>## 
col## 
=## 
new## "
Grid### '
<##' (
MyNew##( -
>##- .
(##. / 
_queryableRepository##/ C
.##C D
Table##D I
.##I J
OrderByDescending##J [
(##[ \
x##\ ]
=>##^ `
x##a b
.##b c
NewsId##c i
)##i j
.##j k
Skip##k o
(##o p
(##p q
page##q u
-##v w
$num##x y
??##z |
$num##} ~
)##~ 
*
##Ä Å
(
##Ç É
rows
##É á
??
##à ä
$num
##ã ç
)
##ç é
)
##é è
.
##è ê
Take
##ê î
(
##î ï
rows
##ï ô
??
##ö ú
$num
##ù ü
)
##ü †
)
##† °
;
##° ¢
col$$ 
.$$ 
Query$$ 
=$$ 
new$$ 
NameValueCollection$$ /
($$/ 0
Request$$0 7
.$$7 8
QueryString$$8 C
)$$C D
;$$D E
if&& 
(&& 
col&& 
.&& 
Query&& 
!=&& 
null&& !
)&&! "
{'' 
col(( 
=(( 
new(( 
Grid(( 
<(( 
MyNew(( $
>(($ %
(((% & 
_queryableRepository((& :
.((: ;
Table((; @
.((@ A
OrderByDescending((A R
(((R S
x((S T
=>((U W
x((X Y
.((Y Z
NewsId((Z `
)((` a
)((a b
;((b c
})) 
col** 
.** 
Columns** 
.** 
Add** 
(** 
x** 
=>**  
$str**! n
+**o p
x**q r
.**r s
NewsId**s y
+**z {
$str	**| Ö
+
**Ü á
$str++! v
+++w x
x++y z
.++z {
NewsId	++{ Å
+
++Ç É
$str
++Ñ ç
)
++ç é
.,, 
Encoded,, 
(,, 
false,, 
),, 
.,,  
Titled,,  &
(,,& '
$str,,' 1
),,1 2
.,,2 3

Filterable,,3 =
(,,= >
false,,> C
),,C D
;,,D E
col.. 
... 
Columns.. 
... 
Add.. 
(.. 
x.. 
=>..  
x..! "
..." #
NewsId..# )
)..) *
...* +
Titled..+ 1
(..1 2
$str..2 ;
)..; <
...< =
MultiFilterable..= L
(..L M
true..M Q
)..Q R
;..R S
col//
 
.// 
Columns// 
.// 
Add// 
(// 
x// 
=>// 
x//  
.//  !
NewsName//! )
)//) *
.//* +
Titled//+ 1
(//1 2
$str//2 A
)//A B
;//B C
col00
 
.00 
Columns00 
.00 
Add00 
(00 
x00 
=>00 
x00  
.00  !
NewsType00! )
)00) *
.00* +
Titled00+ 1
(001 2
$str002 D
)00D E
;00E F
col11 
.11 
Pager11 
=11 
new11 
	GridPager11 %
<11% &
MyNew11& +
>11+ ,
(11, -
col11- 0
)110 1
;111 2
col22 
.22 

Processors22 
.22 
Add22 
(22 
col22 "
.22" #
Pager22# (
)22( )
;22) *
col33 
.33 
Pager33 
.33 
RowsPerPage33 !
=33" #
$num33$ &
;33& '
col44 
.44 
	EmptyText44 
=44 
$str44 7
;447 8
foreach55 
(55 
IGridColumn55  
column55! '
in55( *
col55+ .
.55. /
Columns55/ 6
)556 7
{66 
column77 
.77 
IsFilterable77 #
=77$ %
true77& *
;77* +
column88 
.88 

IsSortable88 !
=88" #
true88$ (
;88( )
}99 
var:: 
total:: 
=::  
_totalRowsRepository:: ,
.::, -
Table::- 2
.::2 3
Where::3 8
(::8 9
x::9 :
=>::; =
x::> ?
.::? @
	TableName::@ I
==::J L
$str::M U
)::U V
.::V W
Select::W ]
(::] ^
x::^ _
=>::` b
x::c d
.::d e
	TableRows::e n
)::n o
.::o p
First::p u
(::u v
)::v w
;::w x
ViewBag;; 
.;; 
	totalRows;; 
=;; 
Convert;;  '
.;;' (
ToInt32;;( /
(;;/ 0
total;;0 5
);;5 6
;;;6 7
return<< 
View<< 
(<< 
col<< 
)<< 
;<< 
}== 	
[>> 
SecuredOperation>> 
(>> 
Roles>> 
=>> 
$str>>  8
)>>8 9
]>>9 :
public?? 
ActionResult?? 
UserMyNewIndex?? (
(??( )
Int32??) .
???. /
page??0 4
,??4 5
Int32??6 ;
???; <
rows??= A
)??A B
{@@ 
IGridAA 
<AA 
MyNewAA 
>AA 
colAA 
=AA 
newAA 
GridAA #
<AA# $
MyNewAA$ )
>AA) *
(AA* + 
_queryableRepositoryAA+ ?
.AA? @
TableAA@ E
.AAE F
OrderByDescendingAAF W
(AAW X
xAAX Y
=>AAZ \
xAA] ^
.AA^ _
NewsIdAA_ e
)AAe f
.AAf g
SkipAAg k
(AAk l
(AAl m
pageAAm q
-AAr s
$numAAt u
??AAv x
$numAAy z
)AAz {
*AA| }
(AA~ 
rows	AA É
??
AAÑ Ü
$num
AAá â
)
AAâ ä
)
AAä ã
.
AAã å
Take
AAå ê
(
AAê ë
rows
AAë ï
??
AAñ ò
$num
AAô õ
)
AAõ ú
)
AAú ù
;
AAù û
colBB 
.BB 
QueryBB 
=BB 
newBB 
NameValueCollectionBB +
(BB+ ,
RequestBB, 3
.BB3 4
QueryStringBB4 ?
)BB? @
;BB@ A
ifDD 

(DD 
colDD 
.DD 
QueryDD 
!=DD 
nullDD 
)DD 
{EE 	
colFF
 
=FF 
newFF 
GridFF 
<FF 
MyNewFF 
>FF 
(FF   
_queryableRepositoryFF  4
.FF4 5
TableFF5 :
.FF: ;
OrderByDescendingFF; L
(FFL M
xFFM N
=>FFO Q
xFFR S
.FFS T
NewsIdFFT Z
)FFZ [
)FF[ \
;FF\ ]
}GG 	
colHH 
.HH 
ColumnsHH 
.HH 
AddHH 
(HH 
xHH 
=>HH 
$strHH s
+HHt u
xHHv w
.HHw x
NewsIdHHx ~
+	HH Ä
$str
HHÅ ä
)
HHã å
.II
 
EncodedII 
(II 
falseII 
)II 
.II 
TitledII  
(II  !
$strII! +
)II+ ,
.II, -

FilterableII- 7
(II7 8
falseII8 =
)II= >
;II> ?
colKK 
.KK 
ColumnsKK 
.KK 
AddKK 
(KK 
xKK 
=>KK 
xKK 
.KK 
NewsNameKK '
)KK' (
.KK( )
TitledKK) /
(KK/ 0
$strKK0 ?
)KK? @
;KK@ A
colLL 
.LL 
PagerLL 
=LL 
newLL 
	GridPagerLL !
<LL! "
MyNewLL" '
>LL' (
(LL( )
colLL) ,
)LL, -
;LL- .
colMM 
.MM 

ProcessorsMM 
.MM 
AddMM 
(MM 
colMM 
.MM 
PagerMM $
)MM$ %
;MM% &
colNN 
.NN 
PagerNN 
.NN 
RowsPerPageNN 
=NN 
$numNN  "
;NN" #
colOO 
.OO 
	EmptyTextOO 
=OO 
$strOO 3
;OO3 4
foreachPP 
(PP 
IGridColumnPP 
columnPP #
inPP$ &
colPP' *
.PP* +
ColumnsPP+ 2
)PP2 3
{QQ 	
columnRR
 
.RR 
IsFilterableRR 
=RR 
trueRR  $
;RR$ %
columnSS
 
.SS 

IsSortableSS 
=SS 
trueSS "
;SS" #
}TT 	
varUU 
totalUU 
=UU  
_totalRowsRepositoryUU (
.UU( )
TableUU) .
.UU. /
WhereUU/ 4
(UU4 5
xUU5 6
=>UU7 9
xUU: ;
.UU; <
	TableNameUU< E
==UUF H
$strUUI Q
)UUQ R
.UUR S
SelectUUS Y
(UUY Z
xUUZ [
=>UU\ ^
xUU_ `
.UU` a
	TableRowsUUa j
)UUj k
.UUk l
FirstUUl q
(UUq r
)UUr s
;UUs t
ViewBagVV 
.VV 
	totalRowsVV 
=VV 
ConvertVV #
.VV# $
ToInt32VV$ +
(VV+ ,
totalVV, 1
)VV1 2
;VV2 3
returnWW 
ViewWW 
(WW 
colWW 
)WW 
;WW 
}XX 
publicZZ 
ActionResultZZ 
DetailZZ  
(ZZ  !
intZZ! $
idZZ% '
)ZZ' (
{[[ 
var\\ 

newsDetail\\ 
=\\  
_queryableRepository\\ -
.\\- .
Table\\. 3
.\\3 4
FirstOrDefault\\4 B
(\\B C
x\\C D
=>\\E G
x\\H I
.\\I J
NewsId\\J P
==\\Q S
id\\T V
)\\V W
;\\W X
return]] 
View]] 
(]] 

newsDetail]] 
)]] 
;]]  
}^^ 
[`` 
SecuredOperation`` 
(`` 
Roles`` 
=`` 
$str`` +
)``+ ,
]``, -
publicaa 
ActionResultaa 
Createaa "
(aa" #
)aa# $
{bb 	
varcc 
emptycc 
=cc 
newcc 
MyNewViewModelcc *
(cc* +
)cc+ ,
;cc, -
vardd 
datadd 
=dd 
emptydd 
.dd 
ToVMdd !
(dd! "
)dd" #
;dd# $
returnee 
Viewee 
(ee 
dataee 
)ee 
;ee 
}ff 	
[hh 	
HttpPosthh	 
]hh 
publicii 
ActionResultii 
Createii "
(ii" #
MyNewViewModelii# 1
myNewii2 7
)ii7 8
{jj 	
ifkk 
(kk 
!kk 

ModelStatekk 
.kk 
IsValidkk #
)kk# $
{ll 
ErrorNotificationmm !
(mm! "
$strmm" 5
)mm5 6
;mm6 7
returnnn 
RedirectToActionnn '
(nn' (
$strnn( 0
)nn0 1
;nn1 2
}oo 
_myNewServicepp 
.pp 
Addpp 
(pp 
newpp !
MyNewpp" '
{qq 
NewsNamerr 
=rr 
myNewrr 
.rr 
NewsNamerr &
,rr& '
	NewsImagess 
=ss 
myNewss 
.ss  
	NewsImagess  )
,ss) *
NewsImageExttt 
=tt 
$strtt #
,tt# $
Descriptionuu 
=uu 
myNewuu !
.uu! "
Descriptionuu" -
,uu- .
NewsTypevv 
=vv 
myNewvv 
.vv 
NewsTypevv '
,vv' (
IsActiveww 
=ww 
myNewww 
.ww 
IsActiveww '
}yy 
)yy 
;yy 
SuccessNotificationzz 
(zz  
$strzz  0
)zz0 1
;zz1 2
return{{ 
RedirectToAction{{ #
({{# $
$str{{$ 0
){{0 1
;{{1 2
}|| 	
[~~ 	
SecuredOperation~~	 
(~~ 
Roles~~ 
=~~  !
$str~~" /
)~~/ 0
]~~0 1
public 
ActionResult 
Edit  
(  !
int! $
id% '
)' (
{
ÄÄ 	
var
ÅÅ 
data
ÅÅ 
=
ÅÅ 
AutoMapperHelper
ÅÅ '
.
ÅÅ' ( 
MapToSameViewModel
ÅÅ( :
<
ÅÅ: ;
MyNew
ÅÅ; @
,
ÅÅ@ A
MyNewViewModel
ÅÅB P
>
ÅÅP Q
(
ÅÅQ R
_myNewService
ÅÅR _
.
ÅÅ_ `
GetById
ÅÅ` g
(
ÅÅg h
id
ÅÅh j
)
ÅÅj k
)
ÅÅk l
;
ÅÅl m
return
ÇÇ 
View
ÇÇ 
(
ÇÇ 
data
ÇÇ 
.
ÇÇ 
ToVM
ÇÇ !
(
ÇÇ! "
)
ÇÇ" #
)
ÇÇ# $
;
ÇÇ$ %
}
ÉÉ 	
[
ÖÖ 	
HttpPost
ÖÖ	 
]
ÖÖ 
public
ÜÜ 
ActionResult
ÜÜ 
Edit
ÜÜ  
(
ÜÜ  !
MyNewViewModel
ÜÜ! /
myNew
ÜÜ0 5
)
ÜÜ5 6
{
áá 	
try
àà 
{
ââ 
_myNewService
ää 
.
ää 
Update
ää $
(
ää$ %
new
ää% (
MyNew
ää* /
{
ãã 
NewsName
åå 
=
åå 
myNew
åå "
.
åå" #
NewsName
åå# +
,
åå+ ,
	NewsImage
çç 
=
çç 
myNew
çç #
.
çç# $
	NewsImage
çç$ -
,
çç- .
NewsImageExt
éé 
=
éé  
$str
éé! '
,
éé' (
Description
èè 
=
èè 
myNew
èè  %
.
èè% &
Description
èè& 1
,
èè1 2
NewsType
êê 
=
êê 
myNew
êê "
.
êê" #
NewsType
êê# +
,
êê+ ,
IsActive
ëë 
=
ëë 
myNew
ëë "
.
ëë" #
IsActive
ëë# +
,
ëë+ ,
NewsId
íí 
=
íí 
myNew
íí  
.
íí  !
NewsId
íí! '
}
ìì 
)
ìì 
;
ìì !
SuccessNotification
îî #
(
îî# $
$str
îî$ 7
)
îî7 8
;
îî8 9
return
ïï 
RedirectToAction
ïï '
(
ïï' (
$str
ïï( 4
)
ïï4 5
;
ïï5 6
}
ññ 
catch
óó 
{
òò 
return
ôô 
View
ôô 
(
ôô 
)
ôô 
;
ôô 
}
öö 
}
õõ 	
[
ùù 	
SecuredOperation
ùù	 
(
ùù 
Roles
ùù 
=
ùù  !
$str
ùù" /
)
ùù/ 0
]
ùù0 1
public
ûû 
ActionResult
ûû 
Delete
ûû "
(
ûû" #
int
ûû# &
id
ûû' )
,
ûû) *
MyNewViewModel
ûû+ 9
myNew
ûû: ?
)
ûû? @
{
üü 	
var
†† 
data
†† 
=
†† 
AutoMapperHelper
†† '
.
††' ( 
MapToSameViewModel
††( :
<
††: ;
MyNew
††; @
,
††@ A
MyNewViewModel
††B P
>
††P Q
(
††Q R
_myNewService
††R _
.
††_ `
GetById
††` g
(
††g h
id
††h j
)
††j k
)
††k l
;
††l m
return
°° 
View
°° 
(
°° 
data
°° 
.
°° 
ToVM
°° !
(
°°! "
)
°°" #
)
°°# $
;
°°$ %
}
¢¢ 	
[
§§ 	
HttpPost
§§	 
]
§§ 
public
•• 
ActionResult
•• 
Delete
•• "
(
••" #
int
••# &
id
••' )
)
••) *
{
¶¶ 	
try
ßß 
{
®® 
_myNewService
©© 
.
©© 
Delete
©© $
(
©©$ %
_myNewService
©©% 2
.
©©2 3
GetById
©©3 :
(
©©: ;
id
©©; =
)
©©= >
)
©©> ?
;
©©? @!
SuccessNotification
™™ #
(
™™# $
$str
™™$ 3
)
™™3 4
;
™™4 5
return
´´ 
RedirectToAction
´´ '
(
´´' (
$str
´´( 4
)
´´4 5
;
´´5 6
}
¨¨ 
catch
≠≠ 
{
ÆÆ 
return
ØØ 
View
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
}
∞∞ 
}
±± 	
}
≤≤ 
}≥≥ ®ñ
QE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\MyProductController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
MyProductController "
:# $
BaseController% 3
{ 
private 
readonly 
IMyProductService &
_myProductService' 8
;8 9
private 
readonly  
IQueryableRepository )
<) *
	MyProduct* 3
>3 4 
_queryableRepository5 I
;I J
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

MyProductController 
( 
IMyProductService 0
myProductService1 A
,A B 
IQueryableRepositoryC W
<W X
	MyProductX a
>a b
queryableRepositoryc v
,v w!
IQueryableRepository	x å
<
å ç
vwRP_StockCount
ç ú
>
ú ù!
totalRowsRepository
û ±
)
± ≤
{ 
_myProductService 
= 
myProductService *
;* + 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
} 
[   
SecuredOperation   
(   
Roles   
=   
$str   +
)  + ,
]  , -
public!! 

ActionResult!! 
MyProductIndex!! &
(!!& '
Int32!!' ,
?!!, -
page!!. 2
,!!2 3
Int32!!4 9
?!!9 :
rows!!; ?
)!!? @
{"" 
IGrid## 
<## 
	MyProduct## 
>## 
col## 
=## 
new##  
Grid##! %
<##% &
	MyProduct##& /
>##/ 0
(##0 1 
_queryableRepository##1 E
.##E F
Table##F K
.##K L
OrderByDescending##L ]
(##] ^
x##^ _
=>##` b
x##c d
.##d e
MyProductId##e p
)##p q
.##q r
Skip##r v
(##v w
(##w x
page##x |
-##} ~
$num	## Ä
??
##Å É
$num
##Ñ Ö
)
##Ö Ü
*
##á à
(
##â ä
rows
##ä é
??
##è ë
$num
##í î
)
##î ï
)
##ï ñ
.
##ñ ó
Take
##ó õ
(
##õ ú
rows
##ú †
??
##° £
$num
##§ ¶
)
##¶ ß
)
##ß ®
;
##® ©
col$$ 	
.$$	 

Query$$
 
=$$ 
new$$ 
NameValueCollection$$ )
($$) *
Request$$* 1
.$$1 2
QueryString$$2 =
)$$= >
;$$> ?
if&& 
(&&	 

col&&
 
.&& 
Query&& 
!=&& 
null&& 
)&& 
{'' 
col(( 
=(( 
new(( 
Grid(( 
<(( 
	MyProduct((  
>((  !
(((! " 
_queryableRepository((" 6
.((6 7
Table((7 <
.((< =
OrderByDescending((= N
(((N O
x((O P
=>((Q S
x((T U
.((U V
MyProductId((V a
)((a b
)((b c
;((c d
})) 
col** 	
.**	 

Columns**
 
.** 
Add** 
(** 
x** 
=>** 
$str** h
+**i j
x**k l
.**l m
MyProductId**m x
+**y z
$str	**{ Ñ
+
**Ö Ü
$str++ p
+++q r
x++s t
.++t u
MyProductId	++u Ä
+
++Å Ç
$str
++É å
)
++å ç
.,,
 
Encoded,, 
(,, 
false,, 
),, 
.,, 
Titled,,  
(,,  !
$str,,! +
),,+ ,
.,,, -

Filterable,,- 7
(,,7 8
false,,8 =
),,= >
;,,> ?
col// 	
.//	 

Columns//
 
.// 
Add// 
(// 
x// 
=>// 
x// 
.// 
ProductName// (
)//( )
.//) *
Titled//* 0
(//0 1
$str//1 ;
)//; <
;//< =
col00 	
.00	 

Columns00
 
.00 
Add00 
(00 
x00 
=>00 
x00 
.00 
IsActive00 %
)00% &
.00& '
Titled00' -
(00- .
$str00. 9
)009 :
;00: ;
col22 	
.22	 

Pager22
 
=22 
new22 
	GridPager22 
<22  
	MyProduct22  )
>22) *
(22* +
col22+ .
)22. /
;22/ 0
col33 	
.33	 


Processors33
 
.33 
Add33 
(33 
col33 
.33 
Pager33 "
)33" #
;33# $
col44 	
.44	 

Pager44
 
.44 
RowsPerPage44 
=44 
$num44  
;44  !
col55 	
.55	 

	EmptyText55
 
=55 
$str55 1
;551 2
foreach66 
(66 
IGridColumn66 
column66 !
in66" $
col66% (
.66( )
Columns66) 0
)660 1
{77 
column88 
.88 
IsFilterable88 
=88 
true88 "
;88" #
column99 
.99 

IsSortable99 
=99 
true99  
;99  !
}:: 
var;; 	
total;;
 
=;;  
_totalRowsRepository;; &
.;;& '
Table;;' ,
.;;, -
Where;;- 2
(;;2 3
x;;3 4
=>;;5 7
x;;8 9
.;;9 :
	TableName;;: C
==;;D F
$str;;G S
);;S T
.;;T U
Select;;U [
(;;[ \
x;;\ ]
=>;;^ `
x;;a b
.;;b c
	TableRows;;c l
);;l m
.;;m n
First;;n s
(;;s t
);;t u
;;;u v
ViewBag<< 
.<< 
	totalRows<< 
=<< 
Convert<< !
.<<! "
ToInt32<<" )
(<<) *
total<<* /
)<</ 0
;<<0 1
return== 
View== 
(== 
col== 
)== 
;== 
}>> 
[?? 
SecuredOperation?? 
(?? 
Roles?? 
=?? 
$str?? 6
)??6 7
]??7 8
public@@ 

ActionResult@@ 
UserMyProductIndex@@ *
(@@* +
Int32@@+ 0
?@@0 1
page@@2 6
,@@6 7
Int32@@8 =
?@@= >
rows@@? C
)@@C D
{AA 
IGridBB 
<BB 
	MyProductBB 
>BB 
colBB 
=BB 
newBB  
GridBB! %
<BB% &
	MyProductBB& /
>BB/ 0
(BB0 1 
_queryableRepositoryBB1 E
.BBE F
TableBBF K
.BBK L
OrderByDescendingBBL ]
(BB] ^
xBB^ _
=>BB` b
xBBc d
.BBd e
MyProductIdBBe p
)BBp q
.BBq r
SkipBBr v
(BBv w
(BBw x
pageBBx |
-BB} ~
$num	BB Ä
??
BBÅ É
$num
BBÑ Ö
)
BBÖ Ü
*
BBá à
(
BBâ ä
rows
BBä é
??
BBè ë
$num
BBí î
)
BBî ï
)
BBï ñ
.
BBñ ó
Take
BBó õ
(
BBõ ú
rows
BBú †
??
BB° £
$num
BB§ ¶
)
BB¶ ß
)
BBß ®
;
BB® ©
colCC 	
.CC	 

QueryCC
 
=CC 
newCC 
NameValueCollectionCC )
(CC) *
RequestCC* 1
.CC1 2
QueryStringCC2 =
)CC= >
;CC> ?
ifEE 
(EE	 

colEE
 
.EE 
QueryEE 
!=EE 
nullEE 
)EE 
{FF 
colGG 
=GG 
newGG 
GridGG 
<GG 
	MyProductGG  
>GG  !
(GG! " 
_queryableRepositoryGG" 6
.GG6 7
TableGG7 <
.GG< =
OrderByDescendingGG= N
(GGN O
xGGO P
=>GGQ S
xGGT U
.GGU V
MyProductIdGGV a
)GGa b
)GGb c
;GGc d
}HH 
colII 	
.II	 

ColumnsII
 
.II 
AddII 
(II 
xII 
=>II 
$strII u
+IIv w
xIIx y
.IIy z
MyProductId	IIz Ö
+
IIÜ á
$str
IIà ë
)
IIë í
.JJ 	
EncodedJJ	 
(JJ 
falseJJ 
)JJ 
.JJ 
TitledJJ 
(JJ 
$strJJ )
)JJ) *
.JJ* +

FilterableJJ+ 5
(JJ5 6
falseJJ6 ;
)JJ; <
;JJ< =
colLL 	
.LL	 

ColumnsLL
 
.LL 
AddLL 
(LL 
xLL 
=>LL 
xLL 
.LL 
ProductNameLL (
)LL( )
.LL) *
TitledLL* 0
(LL0 1
$strLL1 ;
)LL; <
;LL< =
colMM 	
.MM	 

ColumnsMM
 
.MM 
AddMM 
(MM 
xMM 
=>MM 
xMM 
.MM 
IsActiveMM %
)MM% &
.MM& '
TitledMM' -
(MM- .
$strMM. 9
)MM9 :
;MM: ;
colOO 	
.OO	 

PagerOO
 
=OO 
newOO 
	GridPagerOO 
<OO  
	MyProductOO  )
>OO) *
(OO* +
colOO+ .
)OO. /
;OO/ 0
colPP 	
.PP	 


ProcessorsPP
 
.PP 
AddPP 
(PP 
colPP 
.PP 
PagerPP "
)PP" #
;PP# $
colQQ 	
.QQ	 

PagerQQ
 
.QQ 
RowsPerPageQQ 
=QQ 
$numQQ  
;QQ  !
colRR 	
.RR	 

	EmptyTextRR
 
=RR 
$strRR 1
;RR1 2
foreachSS 
(SS 
IGridColumnSS 
columnSS !
inSS" $
colSS% (
.SS( )
ColumnsSS) 0
)SS0 1
{TT 
columnUU 
.UU 
IsFilterableUU 
=UU 
trueUU "
;UU" #
columnVV 
.VV 

IsSortableVV 
=VV 
trueVV  
;VV  !
}WW 
varXX 	
totalXX
 
=XX  
_totalRowsRepositoryXX &
.XX& '
TableXX' ,
.XX, -
WhereXX- 2
(XX2 3
xXX3 4
=>XX5 7
xXX8 9
.XX9 :
	TableNameXX: C
==XXD F
$strXXG S
)XXS T
.XXT U
SelectXXU [
(XX[ \
xXX\ ]
=>XX^ `
xXXa b
.XXb c
	TableRowsXXc l
)XXl m
.XXm n
FirstXXn s
(XXs t
)XXt u
;XXu v
ViewBagYY 
.YY 
	totalRowsYY 
=YY 
ConvertYY !
.YY! "
ToInt32YY" )
(YY) *
totalYY* /
)YY/ 0
;YY0 1
returnZZ 
ViewZZ 
(ZZ 
colZZ 
)ZZ 
;ZZ 
}[[ 
public]] 

ActionResult]] 
Detail]] 
(]] 
int]] "
id]]# %
)]]% &
{^^ 
var__ 	
productDetail__
 
=__  
_queryableRepository__ .
.__. /
Table__/ 4
.__4 5
FirstOrDefault__5 C
(__C D
x__D E
=>__F H
x__I J
.__J K
MyProductId__K V
==__W Y
id__Z \
)__\ ]
;__] ^
return`` 
View`` 
(`` 
productDetail`` 
)``  
;``  !
}aa 
[cc 
SecuredOperationcc 
(cc 
Rolescc 
=cc 
$strcc +
)cc+ ,
]cc, -
publicdd 

ActionResultdd 
Createdd 
(dd 
)dd  
{ee 
varff 	
emptyff
 
=ff 
newff 
MyProductViewModelff (
(ff( )
)ff) *
;ff* +
vargg 	
datagg
 
=gg 
emptygg 
.gg 
ToVMgg 
(gg 
)gg 
;gg 
returnhh 
Viewhh 
(hh 
datahh 
)hh 
;hh 
}ii 
[kk 
HttpPostkk 
]kk 
publicll 

ActionResultll 
Createll 
(ll 
MyProductViewModelll 1
	myProductll2 ;
)ll; <
{mm 
ifnn 
(nn	 

!nn
 

ModelStatenn 
.nn 
IsValidnn 
)nn 
{oo 
ErrorNotificationpp 
(pp 
$strpp -
)pp- .
;pp. /
returnqq 
RedirectToActionqq 
(qq  
$strqq  (
)qq( )
;qq) *
}rr 
_myProductServicess 
.ss 
Addss 
(ss 
newss 
	MyProductss  )
{tt 
ProductNameuu 
=uu 
	myProductuu 
.uu  
ProductNameuu  +
,uu+ ,
MyProductImagevv 
=vv 
	myProductvv "
.vv" #
MyProductImagevv# 1
,vv1 2
MyProductImageExtww 
=ww 
$strww "
,ww" #
Descriptionxx 
=xx 
	myProductxx 
.xx  
Descriptionxx  +
,xx+ ,
IsActiveyy 
=yy 
	myProductyy 
.yy 
IsActiveyy %
}{{ 
){{ 
;{{ 	
SuccessNotification|| 
(|| 
$str|| *
)||* +
;||+ ,
return}} 
RedirectToAction}} 
(}} 
$str}} .
)}}. /
;}}/ 0
}~~ 
[
ÄÄ 
SecuredOperation
ÄÄ 
(
ÄÄ 
Roles
ÄÄ 
=
ÄÄ 
$str
ÄÄ +
)
ÄÄ+ ,
]
ÄÄ, -
public
ÅÅ 

ActionResult
ÅÅ 
Edit
ÅÅ 
(
ÅÅ 
int
ÅÅ  
id
ÅÅ! #
)
ÅÅ# $
{
ÇÇ 
var
ÉÉ 	
data
ÉÉ
 
=
ÉÉ 
AutoMapperHelper
ÉÉ !
.
ÉÉ! " 
MapToSameViewModel
ÉÉ" 4
<
ÉÉ4 5
	MyProduct
ÉÉ5 >
,
ÉÉ> ? 
MyProductViewModel
ÉÉ@ R
>
ÉÉR S
(
ÉÉS T
_myProductService
ÉÉT e
.
ÉÉe f
GetById
ÉÉf m
(
ÉÉm n
id
ÉÉn p
)
ÉÉp q
)
ÉÉq r
;
ÉÉr s
return
ÑÑ 
View
ÑÑ 
(
ÑÑ 
data
ÑÑ 
.
ÑÑ 
ToVM
ÑÑ 
(
ÑÑ 
)
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
[
áá 
HttpPost
áá 
]
áá 
public
àà 

ActionResult
àà 
Edit
àà 
(
àà 
	MyProduct
àà &
	myProduct
àà' 0
)
àà0 1
{
ââ 
try
ää 	
{
ãã 
_myProductService
åå 
.
åå 
Update
åå  
(
åå  !
new
åå! $
	MyProduct
åå% .
{
çç 	
ProductName
èè
 
=
èè 
	myProduct
èè !
.
èè! "
ProductName
èè" -
,
èè- .
MyProductImage
êê
 
=
êê 
	myProduct
êê $
.
êê$ %
MyProductImage
êê% 3
,
êê3 4
MyProductImageExt
ëë
 
=
ëë 
$str
ëë $
,
ëë$ %
Description
íí
 
=
íí 
	myProduct
íí !
.
íí! "
Description
íí" -
,
íí- .
IsActive
ìì
 
=
ìì 
	myProduct
ìì 
.
ìì 
IsActive
ìì '
,
ìì' (
MyProductId
îî
 
=
îî 
	myProduct
îî !
.
îî! "
MyProductId
îî" -
}
ïï 	
)
ïï	 

;
ïï
 !
SuccessNotification
ññ 
(
ññ 
$str
ññ /
)
ññ/ 0
;
ññ0 1
return
óó 
RedirectToAction
óó 
(
óó  
$str
óó  0
)
óó0 1
;
óó1 2
}
òò 
catch
ôô 
{
öö 
return
õõ 
View
õõ 
(
õõ 
)
õõ 
;
õõ 
}
úú 
}
ùù 
[
üü 
SecuredOperation
üü 
(
üü 
Roles
üü 
=
üü 
$str
üü +
)
üü+ ,
]
üü, -
public
†† 

ActionResult
†† 
Delete
†† 
(
†† 
int
†† "
id
††# %
,
††% &
	MyProduct
††' 0
	myProduct
††1 :
)
††: ;
{
°° 
var
¢¢ 	
data
¢¢
 
=
¢¢ 
AutoMapperHelper
¢¢ !
.
¢¢! " 
MapToSameViewModel
¢¢" 4
<
¢¢4 5
	MyProduct
¢¢5 >
,
¢¢> ? 
MyProductViewModel
¢¢@ R
>
¢¢R S
(
¢¢S T
_myProductService
¢¢T e
.
¢¢e f
GetById
¢¢f m
(
¢¢m n
id
¢¢n p
)
¢¢p q
)
¢¢q r
;
¢¢r s
return
££ 
View
££ 
(
££ 
data
££ 
.
££ 
ToVM
££ 
(
££ 
)
££ 
)
££ 
;
££ 
}
§§ 
[
¶¶ 
HttpPost
¶¶ 
]
¶¶ 
public
ßß 

ActionResult
ßß 
Delete
ßß 
(
ßß 
int
ßß "
id
ßß# %
)
ßß% &
{
®® 
try
©© 	
{
™™ 
_myProductService
´´ 
.
´´ 
Delete
´´  
(
´´  !
_myProductService
´´! 2
.
´´2 3
GetById
´´3 :
(
´´: ;
id
´´; =
)
´´= >
)
´´> ?
;
´´? @!
SuccessNotification
¨¨ 
(
¨¨ 
$str
¨¨ +
)
¨¨+ ,
;
¨¨, -
return
≠≠ 
RedirectToAction
≠≠ 
(
≠≠  
$str
≠≠  0
)
≠≠0 1
;
≠≠1 2
}
ÆÆ 
catch
ØØ 
{
∞∞ 
return
±± 
View
±± 
(
±± 
)
±± 
;
±± 
}
≤≤ 
}
≥≥ 
}
¥¥ 
}µµ ®á
OE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\ProductController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
ProductController  
:! "
BaseController# 1
{ 
private 
readonly 
IProductService $
_productService% 4
;4 5
private 
readonly  
IQueryableRepository )
<) *
Product* 1
>1 2 
_queryableRepository3 G
;G H
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

ProductController 
( 
IProductService ,
productService- ;
,; < 
IQueryableRepository= Q
<Q R
ProductR Y
>Y Z
queryableRepository[ n
,n o!
IQueryableRepository	p Ñ
<
Ñ Ö
vwRP_StockCount
Ö î
>
î ï!
totalRowsRepository
ñ ©
)
© ™
{ 
_productService 
= 
productService &
;& ' 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
} 
["" 
SecuredOperation"" 
("" 
Roles"" 
="" 
$str"" 1
)""1 2
]""2 3
public## 

ActionResult## 
ProductIndex## $
(##$ %
Int32##% *
?##* +
page##, 0
,##0 1
Int32##2 7
?##7 8
rows##9 =
)##= >
{$$ 
IGrid%% 
<%% 
Product%% 
>%% 
col%% 
=%% 
new%% 
Grid%% #
<%%# $
Product%%$ +
>%%+ ,
(%%, - 
_queryableRepository%%- A
.%%A B
Table%%B G
.%%G H
Include%%H O
(%%O P
$str%%P Z
)%%Z [
.%%[ \
OrderByDescending%%\ m
(%%m n
x%%n o
=>%%p r
x%%s t
.%%t u
	ProductId%%u ~
)%%~ 
.	%% Ä
Skip
%%Ä Ñ
(
%%Ñ Ö
(
%%Ö Ü
page
%%Ü ä
-
%%ã å
$num
%%ç é
??
%%è ë
$num
%%í ì
)
%%ì î
*
%%ï ñ
(
%%ó ò
rows
%%ò ú
??
%%ù ü
$num
%%† ¢
)
%%¢ £
)
%%£ §
.
%%§ •
Take
%%• ©
(
%%© ™
rows
%%™ Æ
??
%%Ø ±
$num
%%≤ ¥
)
%%¥ µ
.
%%µ ∂
AsNoTracking
%%∂ ¬
(
%%¬ √
)
%%√ ƒ
)
%%ƒ ≈
;
%%≈ ∆
col&& 	
.&&	 

Query&&
 
=&& 
new&& 
NameValueCollection&& )
(&&) *
Request&&* 1
.&&1 2
QueryString&&2 =
)&&= >
;&&> ?
if(( 
(((	 

col((
 
.(( 
Query(( 
!=(( 
null(( 
)(( 
{)) 
col** 
=** 
new** 
Grid** 
<** 
Product** 
>** 
(**   
_queryableRepository**  4
.**4 5
Table**5 :
.**: ;
Include**; B
(**B C
$str**C M
)**M N
.**N O
OrderByDescending**O `
(**` a
x**a b
=>**c e
x**f g
.**g h
	ProductId**h q
)**q r
.**r s
AsNoTracking**s 
(	** Ä
)
**Ä Å
)
**Å Ç
;
**Ç É
}++ 
col,, 	
.,,	 

Columns,,
 
.,, 
Add,, 
(,, 
x,, 
=>,, 
$str,, h
+,,i j
x,,k l
.,,l m
	ProductId,,m v
+,,w x
$str	,,y Ç
+
,,É Ñ
$str-- p
+--q r
x--s t
.--t u
	ProductId--u ~
+	-- Ä
$str
--Å ä
)
--ä ã
...
 
Encoded.. 
(.. 
false.. 
).. 
... 
Titled..  
(..  !
$str..! +
)..+ ,
..., -

Filterable..- 7
(..7 8
false..8 =
)..= >
;..> ?
col00 	
.00	 

Columns00
 
.00 
Add00 
(00 
x00 
=>00 
x00 
.00 
	ProductId00 &
)00& '
.00' (
Titled00( .
(00. /
$str00/ 8
)008 9
.009 :
MultiFilterable00: I
(00I J
true00J N
)00N O
;00O P
col11 	
.11	 

Columns11
 
.11 
Add11 
(11 
x11 
=>11 
x11 
.11 
ProductName11 (
)11( )
.11) *
Titled11* 0
(110 1
$str111 ;
)11; <
;11< =
col22 	
.22	 

Columns22
 
.22 
Add22 
(22 
x22 
=>22 
x22 
.22 
ProductCode22 (
)22( )
.22) *
Titled22* 0
(220 1
$str221 <
)22< =
;22= >
col33 	
.33	 

Columns33
 
.33 
Add33 
(33 
x33 
=>33 
x33 
.33 
ProductShortCode33 -
)33- .
.33. /
Titled33/ 5
(335 6
$str336 F
)33F G
;33G H
col44 	
.44	 

Columns44
 
.44 
Add44 
(44 
x44 
=>44 
x44 
.44 
UnitType44 %
.44% &
UnitTypeName44& 2
)442 3
.443 4
Titled444 :
(44: ;
$str44; H
)44H I
;44I J
col55 	
.55	 

Columns55
 
.55 
Add55 
(55 
x55 
=>55 
x55 
.55 
StockAmount55 (
)55( )
.55) *
Titled55* 0
(550 1
$str551 G
)55G H
;55H I
col66 	
.66	 

Columns66
 
.66 
Add66 
(66 
x66 
=>66 
x66 
.66  
RemainingStockAmount66 1
)661 2
.662 3
Titled663 9
(669 :
$str66: N
)66N O
;66O P
col77 	
.77	 

Columns77
 
.77 
Add77 
(77 
x77 
=>77 
x77 
.77 
Point77 "
)77" #
.77# $
Titled77$ *
(77* +
$str77+ B
)77B C
;77C D
col88 	
.88	 

Columns88
 
.88 
Add88 
(88 
x88 
=>88 
x88 
.88 
PointToMoney88 )
)88) *
.88* +
Titled88+ 1
(881 2
$str882 G
)88G H
;88H I
col99 	
.99	 

Columns99
 
.99 
Add99 
(99 
x99 
=>99 
x99 
.99 
CriticalStockAmount99 0
)990 1
.991 2
Titled992 8
(998 9
$str999 O
)99O P
;99P Q
col;; 	
.;;	 

Pager;;
 
=;; 
new;; 
	GridPager;; 
<;;  
Product;;  '
>;;' (
(;;( )
col;;) ,
);;, -
;;;- .
col<< 	
.<<	 


Processors<<
 
.<< 
Add<< 
(<< 
col<< 
.<< 
Pager<< "
)<<" #
;<<# $
col== 	
.==	 

Pager==
 
.== 
RowsPerPage== 
=== 
$num==  
;==  !
col>> 	
.>>	 

	EmptyText>>
 
=>> 
$str>> 1
;>>1 2
foreach?? 
(?? 
IGridColumn?? 
column?? !
in??" $
col??% (
.??( )
Columns??) 0
)??0 1
{@@ 
columnAA 
.AA 
IsFilterableAA 
=AA 
trueAA "
;AA" #
columnBB 
.BB 

IsSortableBB 
=BB 
trueBB  
;BB  !
}CC 
varDD 	
totalDD
 
=DD  
_totalRowsRepositoryDD &
.DD& '
TableDD' ,
.DD, -
AsNoTrackingDD- 9
(DD9 :
)DD: ;
.DD; <
WhereDD< A
(DDA B
xDDB C
=>DDD F
xDDG H
.DDH I
	TableNameDDI R
==DDS U
$strDDV `
)DD` a
.DDa b
SelectDDb h
(DDh i
xDDi j
=>DDk m
xDDn o
.DDo p
	TableRowsDDp y
)DDy z
.DDz {
First	DD{ Ä
(
DDÄ Å
)
DDÅ Ç
;
DDÇ É
ViewBagEE 
.EE 
	totalRowsEE 
=EE 
ConvertEE !
.EE! "
ToInt32EE" )
(EE) *
totalEE* /
)EE/ 0
;EE0 1
returnFF 
ViewFF 
(FF 
colFF 
)FF 
;FF 
}GG 
[II 
SecuredOperationII 
(II 
RolesII 
=II 
$strII 1
)II1 2
]II2 3
publicJJ 

ActionResultJJ 
CreateJJ 
(JJ 
)JJ  
{KK 
varLL 	
emptyLL
 
=LL 
newLL 
ProductViewModelLL &
(LL& '
)LL' (
;LL( )
varMM 	
dataMM
 
=MM 
emptyMM 
.MM 
ToVMMM 
(MM 
)MM 
;MM 
returnNN 
ViewNN 
(NN 
dataNN 
)NN 
;NN 
}OO 
[QQ 
HttpPostQQ 
]QQ 
publicRR 

ActionResultRR 
CreateRR 
(RR 
ProductViewModelRR /
productRR0 7
)RR7 8
{SS 
ifTT 
(TT	 

!TT
 

ModelStateTT 
.TT 
IsValidTT 
)TT 
{UU 
ErrorNotificationVV 
(VV 
$strVV -
)VV- .
;VV. /
returnWW 
RedirectToActionWW 
(WW  
$strWW  (
)WW( )
;WW) *
}XX 
_productServiceYY 
.YY 
AddYY 
(YY 
newYY 
ProductYY %
{ZZ 
Point\\ 
=\\ 
product\\ 
.\\ 
Point\\ 
,\\ 
ProductCode]] 
=]] 
product]] 
.]] 
ProductCode]] )
,]]) * 
RemainingStockAmount^^ 
=^^ 
product^^ &
.^^& ' 
RemainingStockAmount^^' ;
,^^; <
ProductName__ 
=__ 
product__ 
.__ 
ProductName__ )
,__) *

UnitTypeId`` 
=`` 
product`` 
.`` 

UnitTypeId`` '
,``' (
PointToMoneyaa 
=aa 
productaa 
.aa 
PointToMoneyaa +
,aa+ ,
StockAmountbb 
=bb 
productbb 
.bb 
StockAmountbb )
,bb) *
CriticalStockAmountcc 
=cc 
productcc %
.cc% &
CriticalStockAmountcc& 9
,cc9 :
ProductShortCodedd 
=dd 
productdd "
.dd" #
ProductShortCodedd# 3
}ff 
)ff 
;ff 	
SuccessNotificationgg 
(gg 
$strgg *
)gg* +
;gg+ ,
returnhh 
RedirectToActionhh 
(hh 
$strhh ,
)hh, -
;hh- .
}ii 
[kk 
SecuredOperationkk 
(kk 
Roleskk 
=kk 
$strkk 1
)kk1 2
]kk2 3
publicll 

ActionResultll 
Editll 
(ll 
intll  
idll! #
)ll# $
{mm 
varnn 	
datann
 
=nn 
AutoMapperHelpernn !
.nn! "
MapToSameViewModelnn" 4
<nn4 5
Productnn5 <
,nn< =
ProductViewModelnn> N
>nnN O
(nnO P
_productServicennP _
.nn_ `
GetByIdnn` g
(nng h
idnnh j
)nnj k
)nnk l
;nnl m
returnoo 
Viewoo 
(oo 
dataoo 
.oo 
ToVMoo 
(oo 
)oo 
)oo 
;oo 
}pp 
[rr 
HttpPostrr 
]rr 
publicss 

ActionResultss 
Editss 
(ss 
Productss $
productss% ,
)ss, -
{tt 
tryuu 	
{vv 
_productServicexx 
.xx 
Updatexx 
(xx 
newxx "
Productxx# *
{yy 	
Point{{
 
={{ 
product{{ 
.{{ 
Point{{ 
,{{  
ProductCode||
 
=|| 
product|| 
.||  
ProductCode||  +
,||+ , 
RemainingStockAmount}}
 
=}}  
product}}! (
.}}( ) 
RemainingStockAmount}}) =
,}}= >
ProductName~~
 
=~~ 
product~~ 
.~~  
ProductName~~  +
,~~+ ,

UnitTypeId
 
= 
product 
. 

UnitTypeId )
,) *
PointToMoney
ÄÄ
 
=
ÄÄ 
product
ÄÄ  
.
ÄÄ  !
PointToMoney
ÄÄ! -
,
ÄÄ- .
StockAmount
ÅÅ
 
=
ÅÅ 
product
ÅÅ 
.
ÅÅ  
StockAmount
ÅÅ  +
,
ÅÅ+ ,!
CriticalStockAmount
ÇÇ
 
=
ÇÇ 
product
ÇÇ  '
.
ÇÇ' (!
CriticalStockAmount
ÇÇ( ;
,
ÇÇ; <
ProductShortCode
ÉÉ
 
=
ÉÉ 
product
ÉÉ $
.
ÉÉ$ %
ProductShortCode
ÉÉ% 5
,
ÉÉ5 6
	ProductId
ÑÑ
 
=
ÑÑ 
product
ÑÑ 
.
ÑÑ 
	ProductId
ÑÑ '
}
ÖÖ 	
)
ÖÖ	 

;
ÖÖ
 !
SuccessNotification
ÜÜ 
(
ÜÜ 
$str
ÜÜ /
)
ÜÜ/ 0
;
ÜÜ0 1
return
áá 
RedirectToAction
áá 
(
áá  
$str
áá  .
)
áá. /
;
áá/ 0
}
àà 
catch
ââ 
{
ää 
return
ãã 
View
ãã 
(
ãã 
)
ãã 
;
ãã 
}
åå 
}
çç 
[
èè 
SecuredOperation
èè 
(
èè 
Roles
èè 
=
èè 
$str
èè +
)
èè+ ,
]
èè, -
public
êê 

ActionResult
êê 
Delete
êê 
(
êê 
int
êê "
id
êê# %
,
êê% &
Product
êê' .
product
êê/ 6
)
êê6 7
{
ëë 
var
íí 	
data
íí
 
=
íí 
AutoMapperHelper
íí !
.
íí! " 
MapToSameViewModel
íí" 4
<
íí4 5
Product
íí5 <
,
íí< =
ProductViewModel
íí> N
>
ííN O
(
ííO P
_productService
ííP _
.
íí_ `
GetById
íí` g
(
ííg h
id
ííh j
)
ííj k
)
íík l
;
ííl m
return
ìì 
View
ìì 
(
ìì 
data
ìì 
.
ìì 
ToVM
ìì 
(
ìì 
)
ìì 
)
ìì 
;
ìì 
}
îî 
[
ññ 
HttpPost
ññ 
]
ññ 
public
óó 

ActionResult
óó 
Delete
óó 
(
óó 
int
óó "
id
óó# %
)
óó% &
{
òò 
try
ôô 	
{
öö 
_productService
õõ 
.
õõ 
Delete
õõ 
(
õõ 
_productService
õõ .
.
õõ. /
GetById
õõ/ 6
(
õõ6 7
id
õõ7 9
)
õõ9 :
)
õõ: ;
;
õõ; <!
SuccessNotification
úú 
(
úú 
$str
úú +
)
úú+ ,
;
úú, -
return
ùù 
RedirectToAction
ùù 
(
ùù  
$str
ùù  .
)
ùù. /
;
ùù/ 0
}
ûû 
catch
üü 
{
†† 
return
°° 
View
°° 
(
°° 
)
°° 
;
°° 
}
¢¢ 
}
££ 
}
§§ 
}•• Ë_
XE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\RelationalPersonController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class &
RelationalPersonController +
:, -
BaseController. <
{ 
private 
readonly $
IRelationalPersonService 1$
_relationalPersonService2 J
;J K
private 
readonly  
IQueryableRepository -
<- .
RelationalPerson. >
>> ? 
_queryableRepository@ T
;T U
private 
readonly  
IQueryableRepository -
<- .
vwRP_StockCount. =
>= > 
_totalRowsRepository? S
;S T
public &
RelationalPersonController )
() *$
IRelationalPersonService* B#
relationalPersonServiceC Z
,Z [ 
IQueryableRepository\ p
<p q
RelationalPerson	q Å
>
Å Ç!
queryableRepository
É ñ
,
ñ ó"
IQueryableRepository
ò ¨
<
¨ ≠
vwRP_StockCount
≠ º
>
º Ω!
totalRowsRepository
æ —
)
— “
{ 	$
_relationalPersonService $
=% &#
relationalPersonService' >
;> ? 
_queryableRepository  
=! "
queryableRepository# 6
;6 7 
_totalRowsRepository  
=! "
totalRowsRepository# 6
;6 7
} 	
[ 
SecuredOperation 
( 
Roles 
= 
$str +
)+ ,
], -
[!! 	
SecuredOperation!!	 
(!! 
Roles!! 
=!!  !
$str!!" /
)!!/ 0
]!!0 1
public"" 
ActionResult"" !
RelationalPersonIndex"" 1
(""1 2
Int32""2 7
?""7 8
page""9 =
,""= >
Int32""? D
?""D E
rows""F J
)""J K
{## 	
IGrid$$ 
<$$ 
RelationalPerson$$ "
>$$" #
col$$$ '
=$$( )
new$$* -
Grid$$. 2
<$$2 3
RelationalPerson$$3 C
>$$C D
($$D E 
_queryableRepository$$E Y
.$$Y Z
Table$$Z _
.$$_ `
OrderByDescending$$` q
($$q r
x$$r s
=>$$t v
x$$w x
.$$x y
RelationalPersonId	$$y ã
)
$$ã å
.
$$å ç
Skip
$$ç ë
(
$$ë í
(
$$í ì
page
$$ì ó
-
$$ò ô
$num
$$ö õ
??
$$ú û
$num
$$ü †
)
$$† °
*
$$¢ £
(
$$§ •
rows
$$• ©
??
$$™ ¨
$num
$$≠ Ø
)
$$Ø ∞
)
$$∞ ±
.
$$± ≤
Take
$$≤ ∂
(
$$∂ ∑
rows
$$∑ ª
??
$$º æ
$num
$$ø ¡
)
$$¡ ¬
)
$$¬ √
;
$$√ ƒ
col%% 
.%% 
Query%% 
=%% 
new%% 
NameValueCollection%% /
(%%/ 0
Request%%0 7
.%%7 8
QueryString%%8 C
)%%C D
;%%D E
if'' 
('' 
col'' 
.'' 
Query'' 
!='' 
null'' !
)''! "
{(( 
col)) 
=)) 
new)) 
Grid)) 
<)) 
RelationalPerson)) /
>))/ 0
())0 1 
_queryableRepository))1 E
.))E F
Table))F K
.))K L
OrderByDescending))L ]
())] ^
x))^ _
=>))` b
x))c d
.))d e
RelationalPersonId))e w
)))w x
)))x y
;))y z
}** 
col++ 
.++ 
Columns++ 
.++ 
Add++ 
(++ 
x++ 
=>++  
$str++! n
+++o p
x++q r
.++r s
RelationalPersonId	++s Ö
+
++Ü á
$str
++à ë
+
++í ì
$str,,! v
+,,w x
x,,y z
.,,z {
RelationalPersonId	,,{ ç
+
,,é è
$str
,,ê ô
)
,,ô ö
.-- 
Encoded-- 
(-- 
false-- 
)-- 
.--  
Titled--  &
(--& '
$str--' 1
)--1 2
.--2 3

Filterable--3 =
(--= >
false--> C
)--C D
;--D E
col// 
.// 
Columns// 
.// 
Add// 
(// 
x// 
=>//  
x//! "
.//" #
RelationalPersonId//# 5
)//5 6
.//6 7
Titled//7 =
(//= >
$str//> R
)//R S
.//S T
MultiFilterable//T c
(//c d
true//d h
)//h i
;//i j
col11 
.11 
Pager11 
=11 
new11 
	GridPager11 %
<11% &
RelationalPerson11& 6
>116 7
(117 8
col118 ;
)11; <
;11< =
col22 
.22 

Processors22 
.22 
Add22 
(22 
col22 "
.22" #
Pager22# (
)22( )
;22) *
col33 
.33 
Pager33 
.33 
RowsPerPage33 !
=33" #
$num33$ &
;33& '
col44 
.44 
	EmptyText44 
=44 
$str44 7
;447 8
foreach55 
(55 
IGridColumn55  
column55! '
in55( *
col55+ .
.55. /
Columns55/ 6
)556 7
{66 
column77 
.77 
IsFilterable77 #
=77$ %
true77& *
;77* +
column88 
.88 

IsSortable88 !
=88" #
true88$ (
;88( )
}99 
var:: 
total:: 
=::  
_totalRowsRepository:: ,
.::, -
Table::- 2
.::2 3
Where::3 8
(::8 9
x::9 :
=>::; =
x::> ?
.::? @
	TableName::@ I
==::J L
$str::M `
)::` a
.::a b
Select::b h
(::h i
x::i j
=>::k m
x::n o
.::o p
	TableRows::p y
)::y z
.::z {
First	::{ Ä
(
::Ä Å
)
::Å Ç
;
::Ç É
ViewBag;; 
.;; 
	totalRows;; 
=;; 
Convert;;  '
.;;' (
ToInt32;;( /
(;;/ 0
total;;0 5
);;5 6
;;;6 7
return<< 
View<< 
(<< 
col<< 
)<< 
;<< 
}== 	
[?? 	
SecuredOperation??	 
(?? 
Roles?? 
=??  !
$str??" /
)??/ 0
]??0 1
public@@ 
ActionResult@@ 
Create@@ "
(@@" #
)@@# $
{AA 	
varBB 
emptyBB 
=BB 
newBB %
RelationalPersonViewModelBB 5
(BB5 6
)BB6 7
;BB7 8
varCC 
dataCC 
=CC 
emptyCC 
.CC 
ToVMCC !
(CC! "
)CC" #
;CC# $
returnDD 
ViewDD 
(DD 
dataDD 
)DD 
;DD 
}EE 	
[GG 	
HttpPostGG	 
]GG 
publicHH 
ActionResultHH 
CreateHH "
(HH" #%
RelationalPersonViewModelHH# <
relationalPersonHH= M
)HHM N
{II 	
ifJJ 
(JJ 
!JJ 

ModelStateJJ 
.JJ 
IsValidJJ #
)JJ# $
{KK 
ErrorNotificationLL !
(LL! "
$strLL" 5
)LL5 6
;LL6 7
returnMM 
RedirectToActionMM '
(MM' (
$strMM( 0
)MM0 1
;MM1 2
}NN $
_relationalPersonServiceOO $
.OO$ %
AddOO% (
(OO( )
newOO) ,
RelationalPersonOO- =
{PP 
}TT 
)TT 
;TT 
SuccessNotificationUU 
(UU  
$strUU  0
)UU0 1
;UU1 2
returnVV 
RedirectToActionVV #
(VV# $
$strVV$ ;
)VV; <
;VV< =
}WW 	
[YY 	
SecuredOperationYY	 
(YY 
RolesYY 
=YY  !
$strYY" /
)YY/ 0
]YY0 1
publicZZ 
ActionResultZZ 
EditZZ  
(ZZ  !
intZZ! $
idZZ% '
)ZZ' (
{[[ 	
var\\ 
data\\ 
=\\ 
AutoMapperHelper\\ '
.\\' (
MapToSameViewModel\\( :
<\\: ;
RelationalPerson\\; K
,\\K L%
RelationalPersonViewModel\\M f
>\\f g
(\\g h%
_relationalPersonService	\\h Ä
.
\\Ä Å
GetById
\\Å à
(
\\à â
id
\\â ã
)
\\ã å
)
\\å ç
;
\\ç é
return]] 
View]] 
(]] 
data]] 
.]] 
ToVM]] !
(]]! "
)]]" #
)]]# $
;]]$ %
}^^ 	
[`` 	
HttpPost``	 
]`` 
publicaa 
ActionResultaa 
Editaa  
(aa  !
RelationalPersonaa" 2
relationalPersonaa3 C
)aaC D
{bb 	
trycc 
{dd $
_relationalPersonServiceff (
.ff( )
Updateff) /
(ff/ 0
newff0 3
RelationalPersonff5 E
{gg 
}kk 
)kk 
;kk 
SuccessNotificationll #
(ll# $
$strll$ 7
)ll7 8
;ll8 9
returnmm 
RedirectToActionmm '
(mm' (
$strmm( ?
)mm? @
;mm@ A
}nn 
catchoo 
{pp 
returnqq 
Viewqq 
(qq 
)qq 
;qq 
}rr 
}ss 	
[uu 	
SecuredOperationuu	 
(uu 
Rolesuu 
=uu  !
$struu" /
)uu/ 0
]uu0 1
publicvv 
ActionResultvv 
Deletevv "
(vv" #
intvv# &
idvv' )
,vv) *
RelationalPersonvv+ ;
relationalPersonvv< L
)vvL M
{ww 	
varxx 
dataxx 
=xx 
AutoMapperHelperxx '
.xx' (
MapToSameViewModelxx( :
<xx: ;
RelationalPersonxx; K
,xxK L%
RelationalPersonViewModelxxM f
>xxf g
(xxg h%
_relationalPersonService	xxh Ä
.
xxÄ Å
GetById
xxÅ à
(
xxà â
id
xxâ ã
)
xxã å
)
xxå ç
;
xxç é
returnyy 
Viewyy 
(yy 
datayy 
.yy 
ToVMyy !
(yy! "
)yy" #
)yy# $
;yy$ %
}zz 	
[|| 	
HttpPost||	 
]|| 
public}} 
ActionResult}} 
Delete}} "
(}}" #
int}}# &
id}}' )
)}}) *
{~~ 	
try 
{
ÄÄ &
_relationalPersonService
ÅÅ (
.
ÅÅ( )
Delete
ÅÅ) /
(
ÅÅ/ 0&
_relationalPersonService
ÅÅ0 H
.
ÅÅH I
GetById
ÅÅI P
(
ÅÅP Q
id
ÅÅQ S
)
ÅÅS T
)
ÅÅT U
;
ÅÅU V!
SuccessNotification
ÇÇ #
(
ÇÇ# $
$str
ÇÇ$ 3
)
ÇÇ3 4
;
ÇÇ4 5
return
ÉÉ 
RedirectToAction
ÉÉ '
(
ÉÉ' (
$str
ÉÉ( ?
)
ÉÉ? @
;
ÉÉ@ A
}
ÑÑ 
catch
ÖÖ 
{
ÜÜ 
return
áá 
View
áá 
(
áá 
)
áá 
;
áá 
}
àà 
}
ââ 	
}
ää 
}ãã Â®
TE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\ReportViewerController.cs
	namespace 	
BayiPuan
 
. 
MVCWebUI 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class "
ReportViewerController '
:( )
BaseController* 8
{ 
private 
readonly 
IGN_ReportService *
_reportService+ 9
;9 :
private 
readonly  
IQueryableRepository -
<- .
	GN_Report. 7
>7 8 
_queryableRepository9 M
;M N
private 
readonly  
IQueryableRepository -
<- .
UserRole. 6
>6 7
_roleRepository8 G
;G H
private 
readonly 
IUserService %
_userService& 2
;2 3
public "
ReportViewerController %
(% &
IGN_ReportService& 7
reportService8 E
,E F 
IQueryableRepositoryG [
<[ \
	GN_Report\ e
>e f
queryableRepositoryg z
,z {
IUserService	| à
userService
â î
,
î ï"
IQueryableRepository
ñ ™
<
™ ´
UserRole
´ ≥
>
≥ ¥
roleRepository
µ √
)
√ ƒ
{ 	
_reportService 
= 
reportService *
;* + 
_queryableRepository  
=! "
queryableRepository# 6
;6 7
_userService 
= 
userService &
;& '
_roleRepository 
= 
roleRepository ,
;, -
}   	
public"" 
ActionResult"" 
Index"" !
(""! "
int""" %
reportId""& .
,"". /
string""0 6
filterColumns""7 D
=""E F
null""G K
)""K L
{## 	
var$$ 
table$$ 
=$$ 
new$$ 
	DataTable$$ %
($$% &
)$$& '
;$$' (
var%% 
	reportKey%% 
=%%  
_queryableRepository%% 0
.%%0 1
Table%%1 6
.%%6 7
AsNoTracking%%7 C
(%%C D
)%%D E
.%%E F
FirstOrDefault%%F T
(%%T U
x%%U V
=>%%W Y
x%%Z [
.%%[ \
ReportId%%\ d
==%%e g
reportId%%h p
)%%p q
;%%q r
var&& 
	getUserId&& 
=&& 
_userService&& (
.&&( )
UniqueUserName&&) 7
(&&7 8
User&&8 <
.&&< =
Identity&&= E
.&&E F
Name&&F J
)&&J K
;&&K L
var'' 
roleControl'' 
='' 
_userService'' *
.''* +
GetUserRoles''+ 7
(''7 8
	getUserId''8 A
)''A B
.''B C
Select''C I
(''I J
u''J K
=>''L N
u''O P
.''P Q
RoleName''Q Y
)''Y Z
.''Z [
ToArray''[ b
(''b c
)''c d
;''d e
foreach** 
(** 
var** 
role** 
in**  
roleControl**! ,
)**, -
{++ 
var,, 
accessControl,, !
=,," #
	reportKey,,$ -
.,,- .
ReportAuthorization,,. A
.,,A B
Split,,B G
(,,G H
$char,,H K
),,K L
;,,L M
for-- 
(-- 
int-- 
i-- 
=-- 
$num-- 
;-- 
i--  !
<--" #
accessControl--$ 1
.--1 2
Length--2 8
;--8 9
i--: ;
++--; =
)--= >
{.. 
if// 
(// 
accessControl// %
[//% &
i//& '
]//' (
==//( *
role//* .
)//. /
{00 
if11 
(11 
!11 
string11 #
.11# $
IsNullOrEmpty11$ 1
(111 2
filterColumns112 ?
)11? @
)11@ A
{22 
foreach33 #
(33$ %
var33% (

filterType33) 3
in334 6
filterColumns337 D
.33D E
Split33E J
(33J K
$char33K N
)33N O
)33O P
{44 
if55  "
(55# $

filterType55$ .
.55. /
Contains55/ 7
(557 8
$str558 C
)55C D
)55D E
{66  !
var77$ '
keyst77( -
=77. /

filterType770 :
.77: ;
Replace77; B
(77B C
$str77C O
,77O P
$str77Q S
)77S T
;77T U
TempData88$ ,
[88, -
$str88- 3
]883 4
+=885 7
(888 9
keyst889 >
+88? @
$str88A n
+88o p

filterType88q {
.88{ |
Replace	88| É
(
88É Ñ
$str
88Ñ ê
,
88ê ë
$str
88í î
)
88î ï
+
88ñ ó
$str
88ò §
+
88• ¶

filterType
88ß ±
.
88± ≤
Replace
88≤ π
(
88π ∫
$str
88∫ ∆
,
88∆ «
$str
88»  
)
88  À
+
88Ã Õ
$str
88Œ Ë
)
88Ë È
;
88È Í
}99  !
else::  $
if::% '
(::( )

filterType::) 3
.::3 4
Contains::4 <
(::< =
$str::= E
)::E F
)::F G
{;;  !
var<<$ '
keyint<<( .
=<</ 0

filterType<<1 ;
.<<; <
Replace<<< C
(<<C D
$str<<D M
,<<M N
$str<<O Q
)<<Q R
;<<R S
TempData==$ ,
[==, -
$str==- 3
]==3 4
+===5 7
(==8 9
keyint==9 ?
+==@ A
$str==B n
+==o p

filterType==q {
.=={ |
Replace	==| É
(
==É Ñ
$str
==Ñ ç
,
==ç é
$str
==è ë
)
==ë í
+
==ì î
$str
==ï °
+
==¢ £

filterType
==§ Æ
.
==Æ Ø
Replace
==Ø ∂
(
==∂ ∑
$str
==∑ ¿
,
==¿ ¡
$str
==¬ ƒ
)
==ƒ ≈
+
==∆ «
$str
==» ‚
)
==‚ „
;
==„ ‰
}>>  !
else??  $
if??% '
(??( )

filterType??) 3
.??3 4
Contains??4 <
(??< =
$str??= I
)??I J
)??J K
{@@  !
TempDataAA$ ,
[AA, -
$strAA- 3
]AA3 4
+=AA5 7
(AA8 9
$strAA9 i
+AAj k

filterTypeAAl v
.AAv w
ReplaceAAw ~
(AA~ 
$str	AA å
,
AAå ç
$str
AAé ê
)
AAê ë
+
AAí ì
$str
AAî ô
+
AAö õ
$str
AAú ª
+
AAº Ω

filterType
AAæ »
.
AA» …
Replace
AA… –
(
AA– —
$str
AA— ﬁ
,
AAﬁ ﬂ
$str
AA‡ ‚
)
AA‚ „
+
AA‰ Â
$str
AAÊ Î
+
AAÏ Ì
$str
AAÓ ¥
+
AAµ ∂

filterType
AA∑ ¡
.
AA¡ ¬
Replace
AA¬ …
(
AA…  
$str
AA  ◊
,
AA◊ ÿ
$str
AAŸ €
)
AA€ ‹
+
AA› ﬁ
$str
AAﬂ ‰
+
AAÂ Ê
$str
AAÁ Ü
+
AAá à

filterType
AAâ ì
.
AAì î
Replace
AAî õ
(
AAõ ú
$str
AAú ©
,
AA© ™
$str
AA´ ≠
)
AA≠ Æ
+
AAØ ∞
$str
AA± ∂
+
AA∑ ∏
$str
AAπ ⁄
)
AA⁄ €
;
AA€ ‹
}BB  !
elseCC  $
ifCC% '
(CC( )

filterTypeCC) 3
.CC3 4
ContainsCC4 <
(CC< =
$strCC= H
)CCH I
)CCI J
{DD  !
varEE$ '
lookupEE( .
=EE/ 0

filterTypeEE1 ;
.EE; <
ReplaceEE< C
(EEC D
$strEED P
,EEP Q
$strEER T
)EET U
;EEU V
varFF$ '
IdFF( *
=FF+ ,
$strFF- /
;FF/ 0
varGG$ '
TextGG( ,
=GG- .
$strGG/ 1
;GG1 2
varHH$ '
ActualTableNameHH( 7
=HH8 9
$strHH: <
;HH< =
TextII$ (
=II) *
lookupII+ 1
.II1 2
SplitII2 7
(II7 8
$charII8 ;
)II; <
[II< =
$numII= >
]II> ?
.II? @
ToStringII@ H
(IIH I
)III J
;IIJ K
IdJJ$ &
=JJ' (
lookupJJ) /
.JJ/ 0
SplitJJ0 5
(JJ5 6
$charJJ6 9
)JJ9 :
[JJ: ;
$numJJ; <
]JJ< =
.JJ= >
ToStringJJ> F
(JJF G
)JJG H
;JJH I
ActualTableNameKK$ 3
=KK4 5
lookupKK6 <
.KK< =
SplitKK= B
(KKB C
$charKKC F
)KKF G
[KKG H
$numKKH I
]KKI J
.KKJ K
ToStringKKK S
(KKS T
)KKT U
;KKU V
IdLL$ &
=LL' (
IdLL) +
.LL+ ,
SplitLL, 1
(LL1 2
$charLL2 5
)LL5 6
[LL6 7
$numLL7 8
]LL8 9
.LL9 :
ToStringLL: B
(LLB C
)LLC D
;LLD E
varMM$ '
resultMM( .
=MM/ 0
ToolsMM1 6
.MM6 7
SelectMM7 =
<MM= >
ListItemMM> F
>MMF G
(MMG H
$"MMH J
select MMJ Q
{MMQ R
TextMMR V
}MMV W
	 [Text], MMW `
{MM` a
IdMMa c
}MMc d
 [Id] from MMd o
{MMo p
ActualTableNameMMp 
}	MM Ä
"
MMÄ Å
)
MMÅ Ç
;
MMÇ É
TempDataNN$ ,
[NN, -
$strNN- 3
]NN3 4
+=NN5 7
(NN8 9
TextNN9 =
+NN> ?
$"NN@ B
<select id=\"NNB O
{NNO P
IdNNP R
}NNR S

\" name=\"NNS ]
{NN] ^
IdNN^ `
}NN` a,
\" class=\"w3-input\" required>	NNa Ä
"
NNÄ Å
)
NNÅ Ç
;
NNÇ É
TempDataOO$ ,
[OO, -
$strOO- 3
]OO3 4
+=OO5 7
(OO8 9
$"OO9 ;0
$<option value=\"\">Se√ßiniz</option>OO; ^
"OO^ _
)OO_ `
;OO` a
foreachPP$ +
(PP, -
varPP- 0

optionItemPP1 ;
inPP< >
resultPP? E
)PPE F
{QQ$ %
TempDataRR( 0
[RR0 1
$strRR1 7
]RR7 8
+=RR9 ;
(RR< =
$"RR= ?
<option value=\"RR? O
{RRO P

optionItemRRP Z
.RRZ [
IdRR[ ]
}RR] ^
\">RR^ a
{RRa b

optionItemRRb l
.RRl m
TextRRm q
}RRq r
	</option>RRr {
"RR{ |
)RR| }
;RR} ~
}SS$ %
TempDataTT$ ,
[TT, -
$strTT- 3
]TT3 4
+=TT5 7
(TT8 9
$strTT9 H
)TTH I
;TTI J
}UU  !
elseVV  $
ifVV% '
(VV( )

filterTypeVV) 3
.VV3 4
ContainsVV4 <
(VV< =
$strVV= H
)VVH I
)VVI J
{WW  !
varXX$ '
lookupXX( .
=XX/ 0

filterTypeXX1 ;
.XX; <
ReplaceXX< C
(XXC D
$strXXD P
,XXP Q
$strXXR T
)XXT U
;XXU V
varYY$ '
IdYY( *
=YY+ ,
$strYY- /
;YY/ 0
varZZ$ '
TextZZ( ,
=ZZ- .
$strZZ/ 1
;ZZ1 2
var[[$ '
ActualTableName[[( 7
=[[8 9
$str[[: <
;[[< =
var\\$ '
	MasterKey\\( 1
=\\2 3
$str\\4 6
;\\6 7
foreach]]$ +
(]], -
var]]- 0

lookupItem]]1 ;
in]]< >
lookup]]? E
.]]E F
Split]]F K
(]]K L
$char]]L O
)]]O P
)]]P Q
{^^$ %
Text__( ,
=__- .
lookup__/ 5
.__5 6
Split__6 ;
(__; <
$char__< ?
)__? @
[__@ A
$num__A B
]__B C
.__C D
ToString__D L
(__L M
)__M N
;__N O
Id``( *
=``+ ,
lookup``- 3
.``3 4
Split``4 9
(``9 :
$char``: =
)``= >
[``> ?
$num``? @
]``@ A
.``A B
ToString``B J
(``J K
)``K L
;``L M
ActualTableNameaa( 7
=aa8 9
lookupaa: @
.aa@ A
SplitaaA F
(aaF G
$charaaG J
)aaJ K
[aaK L
$numaaL M
]aaM N
.aaN O
ToStringaaO W
(aaW X
)aaX Y
;aaY Z
	MasterKeybb( 1
=bb2 3
lookupbb4 :
.bb: ;
Splitbb; @
(bb@ A
$charbbA D
)bbD E
[bbE F
$numbbF G
]bbG H
.bbH I
ToStringbbI Q
(bbQ R
)bbR S
;bbS T
}cc$ %
TempDatadd$ ,
[dd, -
$strdd- 3
]dd3 4
+=dd5 7
(dd8 9
Textdd9 =
+dd> ?
$"dd@ B9
-<select required class=\"w3-input\" dataid=\"ddB o
{ddo p
Idddp r
}ddr s
\" dataentity=\"	dds É
{
ddÉ Ñ
ActualTableName
ddÑ ì
}
ddì î
\" dataname=\"
ddî ¢
{
dd¢ £
Text
dd£ ß
}
ddß ®
\" dataparent=\"
dd® ∏
{
dd∏ π
	MasterKey
ddπ ¬
}
dd¬ √
\" id=\"
dd√ À
{
ddÀ Ã
Id
ddÃ Œ
.
ddŒ œ
Split
ddœ ‘
(
dd‘ ’
$char
dd’ ÿ
)
ddÿ Ÿ
[
ddŸ ⁄
$num
dd⁄ €
]
dd€ ‹
.
dd‹ ›
ToString
dd› Â
(
ddÂ Ê
)
ddÊ Á
}
ddÁ Ë

\" name=\"
ddË Ú
{
ddÚ Û
Id
ddÛ ı
.
ddı ˆ
Split
ddˆ ˚
(
dd˚ ¸
$char
dd¸ ˇ
)
ddˇ Ä
[
ddÄ Å
$num
ddÅ Ç
]
ddÇ É
.
ddÉ Ñ
ToString
ddÑ å
(
ddå ç
)
ddç é
}
ddé è7
)\"  tabindex=\"-1\" aria-hidden=\"true\">
ddè ∏
"
dd∏ π
)
ddπ ∫
;
dd∫ ª
TempDataee$ ,
[ee, -
$stree- 3
]ee3 4
+=ee5 7
(ee8 9
$stree9 H
)eeH I
;eeI J
}ff  !
}gg 
returnhh "
Viewhh# '
(hh' (
tablehh( -
)hh- .
;hh. /
}ii 
elsejj 
{kk 
usingll !
(ll" #
varll# &
dbxll' *
=ll+ ,
newll- 0
BayiPuanContextll1 @
(ll@ A
)llA B
)llB C
{mm 
ViewDatann  (
[nn( )
$strnn) 6
]nn6 7
=nn8 9
	reportKeynn: C
?nnC D
.nnD E
ReportTitlennE P
;nnP Q
varoo  #
cmdoo$ '
=oo( )
dbxoo* -
.oo- .
Databaseoo. 6
.oo6 7

Connectionoo7 A
.ooA B
CreateCommandooB O
(ooO P
)ooP Q
;ooQ R
varpp  #
sqlpp$ '
=pp( )
	reportKeypp* 3
?pp3 4
.pp4 5
	ReportSqlpp5 >
;pp> ?
cmdqq  #
.qq# $
CommandTextqq$ /
=qq0 1
sqlqq2 5
;qq5 6
cmdrr  #
.rr# $

Connectionrr$ .
.rr. /
Openrr/ 3
(rr3 4
)rr4 5
;rr5 6
tabless  %
.ss% &
Loadss& *
(ss* +
cmdss+ .
.ss. /
ExecuteReaderss/ <
(ss< =
)ss= >
)ss> ?
;ss? @
returntt  &
Viewtt' +
(tt+ ,
tablett, 1
)tt1 2
;tt2 3
}uu 
}vv 
}ww 
}xx 
}yy 
ErrorNotificationzz 
(zz 
$strzz K
)zzK L
;zzL M
return{{ 
RedirectToAction{{ "
({{" #
$str{{# 3
,{{3 4
$str{{5 @
){{@ A
;{{A B
}|| 	
[}} 	
HttpPost}}	 
]}} 
public~~ 
ActionResult~~ 
FilterIndex~~ '
(~~' (
FormCollection~~( 6
form~~7 ;
,~~; <
int~~= @
reportId~~A I
,~~I J
string~~K Q
filterColumns~~R _
=~~` a
null~~b f
)~~f g
{ 	
var
ÄÄ 
table
ÄÄ 
=
ÄÄ 
new
ÄÄ 
	DataTable
ÄÄ %
(
ÄÄ% &
)
ÄÄ& '
;
ÄÄ' (
var
ÅÅ 
	reportKey
ÅÅ 
=
ÅÅ "
_queryableRepository
ÅÅ 0
.
ÅÅ0 1
Table
ÅÅ1 6
.
ÅÅ6 7
AsNoTracking
ÅÅ7 C
(
ÅÅC D
)
ÅÅD E
.
ÅÅE F
FirstOrDefault
ÅÅF T
(
ÅÅT U
x
ÅÅU V
=>
ÅÅW Y
x
ÅÅZ [
.
ÅÅ[ \
ReportId
ÅÅ\ d
==
ÅÅe g
reportId
ÅÅh p
)
ÅÅp q
;
ÅÅq r
var
ÇÇ 
sb
ÇÇ 
=
ÇÇ 
new
ÇÇ 
StringBuilder
ÇÇ &
(
ÇÇ& '
	reportKey
ÇÇ' 0
?
ÇÇ0 1
.
ÇÇ1 2
	ReportSql
ÇÇ2 ;
)
ÇÇ; <
;
ÇÇ< =
var
ÉÉ 
keys
ÉÉ 
=
ÉÉ 
Request
ÉÉ 
.
ÉÉ 
Form
ÉÉ #
.
ÉÉ# $
AllKeys
ÉÉ$ +
;
ÉÉ+ ,
if
ÑÑ 
(
ÑÑ 
filterColumns
ÑÑ 
!=
ÑÑ  
null
ÑÑ! %
)
ÑÑ% &
{
ÖÖ 
sb
ÜÜ 
.
ÜÜ 
Append
ÜÜ 
(
ÜÜ 
$str
ÜÜ +
)
ÜÜ+ ,
;
ÜÜ, -
foreach
áá 
(
áá 
var
áá 

filterType
áá '
in
áá( *
filterColumns
áá+ 8
.
áá8 9
Split
áá9 >
(
áá> ?
$char
áá? B
)
ááB C
)
ááC D
{
àà 
if
ââ 
(
ââ 

filterType
ââ "
.
ââ" #
Contains
ââ# +
(
ââ+ ,
$str
ââ, 7
)
ââ7 8
)
ââ8 9
{
ää 
var
ãã 
	keyString
ãã %
=
ãã& '

filterType
ãã( 2
.
ãã2 3
Replace
ãã3 :
(
ãã: ;
$str
ãã; G
,
ããG H
$str
ããI K
)
ããK L
;
ããL M
var
åå 
requestFormString
åå -
=
åå. /
form
åå0 4
[
åå4 5
	keyString
åå5 >
]
åå> ?
;
åå? @
if
çç 
(
çç 
requestFormString
çç -
!=
çç. 0
$str
çç1 3
)
çç3 4
{
éé 
sb
èè 
.
èè 
Append
èè %
(
èè% &
	keyString
èè& /
)
èè/ 0
;
èè0 1
sb
êê 
.
êê 
Append
êê %
(
êê% &
$str
êê& ,
+
êê- .
requestFormString
êê/ @
.
êê@ A
Replace
êêA H
(
êêH I
$str
êêI L
,
êêL M
$str
êêN P
)
êêP Q
+
êêR S
$str
êêT W
)
êêW X
;
êêX Y
sb
ëë 
.
ëë 
Append
ëë %
(
ëë% &
$str
ëë& -
)
ëë- .
;
ëë. /
}
íí 
}
ìì 
else
îî 
if
îî 
(
îî 

filterType
îî '
.
îî' (
Contains
îî( 0
(
îî0 1
$str
îî1 9
)
îî9 :
)
îî: ;
{
ïï 
var
ññ 
	intString
ññ %
=
ññ& '

filterType
ññ( 2
.
ññ2 3
Replace
ññ3 :
(
ññ: ;
$str
ññ; D
,
ññD E
$str
ññF H
)
ññH I
;
ññI J
var
óó 
requestFormInt
óó *
=
óó+ ,
form
óó- 1
[
óó1 2
	intString
óó2 ;
]
óó; <
;
óó< =
if
òò 
(
òò 
requestFormInt
òò *
!=
òò+ -
$str
òò. 0
)
òò0 1
{
ôô 
sb
öö 
.
öö 
Append
öö %
(
öö% &
	intString
öö& /
)
öö/ 0
;
öö0 1
sb
õõ 
.
õõ 
Append
õõ %
(
õõ% &
$str
õõ& +
+
õõ, -
requestFormInt
õõ. <
.
õõ< =
Replace
õõ= D
(
õõD E
$str
õõE H
,
õõH I
$str
õõJ L
)
õõL M
+
õõN O
$str
õõP R
)
õõR S
;
õõS T
sb
úú 
.
úú 
Append
úú %
(
úú% &
$str
úú& -
)
úú- .
;
úú. /
}
ùù 
}
ûû 
else
üü 
if
üü 
(
üü 

filterType
üü '
.
üü' (
Contains
üü( 0
(
üü0 1
$str
üü1 =
)
üü= >
)
üü> ?
{
†† 
var
°° 
betweenString
°° )
=
°°* +

filterType
°°, 6
.
°°6 7
Replace
°°7 >
(
°°> ?
$str
°°? L
,
°°L M
$str
°°N P
)
°°P Q
;
°°Q R
var
££ #
requestFormBetweensdt
££ 1
=
££2 3
form
££4 8
[
££8 9
betweenString
££9 F
+
££G H
$str
££I N
]
££N O
;
££O P
var
§§ #
requestFormBetweenedt
§§ 1
=
§§2 3
form
§§4 8
[
§§8 9
betweenString
§§9 F
+
§§G H
$str
§§I N
]
§§N O
;
§§O P
if
•• 
(
•• #
requestFormBetweensdt
•• 1
!=
••2 4
$str
••5 7
&&
••8 :#
requestFormBetweenedt
••; P
!=
••Q S
$str
••T V
)
••V W
{
¶¶ 
sb
ßß 
.
ßß 
Append
ßß %
(
ßß% &
betweenString
ßß& 3
)
ßß3 4
;
ßß4 5
var
®® 
sdt
®®  #
=
®®$ %#
requestFormBetweensdt
®®& ;
.
®®; <
Replace
®®< C
(
®®C D
$str
®®D G
,
®®G H
$str
®®I K
)
®®K L
;
®®L M
var
©© 
edt
©©  #
=
©©$ %#
requestFormBetweenedt
©©& ;
.
©©; <
Replace
©©< C
(
©©C D
$str
©©D G
,
©©G H
$str
©©I K
)
©©K L
;
©©L M
sb
™™ 
.
™™ 
Append
™™ %
(
™™% &
$str
™™& 2
+
™™3 4
sdt
™™5 8
.
™™8 9
Replace
™™9 @
(
™™@ A
$str
™™A D
,
™™D E
$str
™™F I
)
™™I J
+
™™K L
$str
™™M V
+
™™W X
edt
™™Y \
.
™™\ ]
Replace
™™] d
(
™™d e
$str
™™e h
,
™™h i
$str
™™j m
)
™™m n
+
™™o p
$str
™™q u
)
™™u v
;
™™v w
sb
´´ 
.
´´ 
Append
´´ %
(
´´% &
$str
´´& -
)
´´- .
;
´´. /
}
¨¨ 
}
≠≠ 
else
ÆÆ 
if
ÆÆ 
(
ÆÆ 

filterType
ÆÆ '
.
ÆÆ' (
Contains
ÆÆ( 0
(
ÆÆ0 1
$str
ÆÆ1 <
)
ÆÆ< =
)
ÆÆ= >
{
ØØ 
var
∞∞ 
LookupString
∞∞ (
=
∞∞) *

filterType
∞∞+ 5
.
∞∞5 6
Replace
∞∞6 =
(
∞∞= >
$str
∞∞> J
,
∞∞J K
$str
∞∞L N
)
∞∞N O
;
∞∞O P
var
±± 
requestFormInt
±± *
=
±±+ ,
$str
±±- /
;
±±/ 0
requestFormInt
≤≤ &
=
≤≤' (
LookupString
≤≤) 5
.
≤≤5 6
Split
≤≤6 ;
(
≤≤; <
$char
≤≤< ?
)
≤≤? @
[
≤≤@ A
$num
≤≤A B
]
≤≤B C
.
≤≤C D
ToString
≤≤D L
(
≤≤L M
)
≤≤M N
;
≤≤N O
if
≥≥ 
(
≥≥ 
requestFormInt
≥≥ *
!=
≥≥+ -
$str
≥≥. 0
)
≥≥0 1
{
¥¥ 
if
µµ 
(
µµ  
sb
µµ  "
.
µµ" #
ToString
µµ# +
(
µµ+ ,
)
µµ, -
.
µµ- .
Contains
µµ. 6
(
µµ6 7
$str
µµ7 =
)
µµ= >
==
µµ? A
true
µµB F
||
µµG I
sb
µµJ L
.
µµL M
ToString
µµM U
(
µµU V
)
µµV W
.
µµW X
Contains
µµX `
(
µµ` a
$str
µµa g
)
µµg h
)
µµh i
{
∂∂ 
sb
∑∑  "
.
∑∑" #
Append
∑∑# )
(
∑∑) *
requestFormInt
∑∑* 8
)
∑∑8 9
;
∑∑9 :
requestFormInt
∏∏  .
=
∏∏/ 0
requestFormInt
∏∏1 ?
.
∏∏? @
Split
∏∏@ E
(
∏∏E F
$char
∏∏F I
)
∏∏I J
[
∏∏J K
$num
∏∏K L
]
∏∏L M
.
∏∏M N
ToString
∏∏N V
(
∏∏V W
)
∏∏W X
;
∏∏X Y
requestFormInt
ππ  .
=
ππ/ 0
form
ππ1 5
[
ππ5 6
requestFormInt
ππ6 D
]
ππD E
;
ππE F
sb
∫∫  "
.
∫∫" #
Append
∫∫# )
(
∫∫) *
$str
∫∫* /
+
∫∫0 1
requestFormInt
∫∫2 @
.
∫∫@ A
Replace
∫∫A H
(
∫∫H I
$str
∫∫I L
,
∫∫L M
$str
∫∫N P
)
∫∫P Q
+
∫∫R S
$str
∫∫T V
)
∫∫V W
;
∫∫W X
sb
ªª  "
.
ªª" #
Append
ªª# )
(
ªª) *
$str
ªª* 1
)
ªª1 2
;
ªª2 3
}
ºº 
else
ΩΩ  
{
ææ 
requestFormInt
øø  .
=
øø/ 0
requestFormInt
øø1 ?
.
øø? @
Split
øø@ E
(
øøE F
$char
øøF I
)
øøI J
[
øøJ K
$num
øøK L
]
øøL M
.
øøM N
ToString
øøN V
(
øøV W
)
øøW X
;
øøX Y
sb
¿¿  "
.
¿¿" #
Append
¿¿# )
(
¿¿) *
requestFormInt
¿¿* 8
)
¿¿8 9
;
¿¿9 :
requestFormInt
¡¡  .
=
¡¡/ 0
form
¡¡1 5
[
¡¡5 6
requestFormInt
¡¡6 D
]
¡¡D E
;
¡¡E F
sb
¬¬  "
.
¬¬" #
Append
¬¬# )
(
¬¬) *
$str
¬¬* /
+
¬¬0 1
requestFormInt
¬¬2 @
.
¬¬@ A
Replace
¬¬A H
(
¬¬H I
$str
¬¬I L
,
¬¬L M
$str
¬¬N P
)
¬¬P Q
+
¬¬R S
$str
¬¬T V
)
¬¬V W
;
¬¬W X
sb
√√  "
.
√√" #
Append
√√# )
(
√√) *
$str
√√* 1
)
√√1 2
;
√√2 3
}
ƒƒ 
}
≈≈ 
}
«« 
else
»» 
if
»» 
(
»» 

filterType
»» '
.
»»' (
Contains
»»( 0
(
»»0 1
$str
»»1 <
)
»»< =
)
»»= >
{
…… 
var
   
LookupString
   (
=
  ) *

filterType
  + 5
.
  5 6
Replace
  6 =
(
  = >
$str
  > J
,
  J K
$str
  L N
)
  N O
;
  O P
var
ÀÀ 
requestFormInt
ÀÀ *
=
ÀÀ+ ,
$str
ÀÀ- /
;
ÀÀ/ 0
requestFormInt
ÃÃ &
=
ÃÃ' (
LookupString
ÃÃ) 5
.
ÃÃ5 6
Split
ÃÃ6 ;
(
ÃÃ; <
$char
ÃÃ< ?
)
ÃÃ? @
[
ÃÃ@ A
$num
ÃÃA B
]
ÃÃB C
.
ÃÃC D
ToString
ÃÃD L
(
ÃÃL M
)
ÃÃM N
;
ÃÃN O
if
ŒŒ 
(
ŒŒ 
requestFormInt
ŒŒ *
!=
ŒŒ+ -
$str
ŒŒ. 0
||
ŒŒ1 3
requestFormInt
ŒŒ4 B
!=
ŒŒC E
null
ŒŒF J
)
ŒŒJ K
{
œœ 
if
–– 
(
––  
sb
––  "
.
––" #
ToString
––# +
(
––+ ,
)
––, -
.
––- .
Contains
––. 6
(
––6 7
$str
––7 =
)
––= >
==
––? A
true
––B F
||
––G I
sb
––J L
.
––L M
ToString
––M U
(
––U V
)
––V W
.
––W X
Contains
––X `
(
––` a
$str
––a g
)
––g h
)
––h i
{
—— 
sb
““  "
.
““" #
Append
““# )
(
““) *
requestFormInt
““* 8
)
““8 9
;
““9 :
requestFormInt
””  .
=
””/ 0
requestFormInt
””1 ?
.
””? @
Split
””@ E
(
””E F
$char
””F I
)
””I J
[
””J K
$num
””K L
]
””L M
.
””M N
ToString
””N V
(
””V W
)
””W X
;
””X Y
requestFormInt
‘‘  .
=
‘‘/ 0
form
‘‘1 5
[
‘‘5 6
requestFormInt
‘‘6 D
]
‘‘D E
;
‘‘E F
sb
’’  "
.
’’" #
Append
’’# )
(
’’) *
$str
’’* /
+
’’0 1
requestFormInt
’’2 @
.
’’@ A
Replace
’’A H
(
’’H I
$str
’’I L
,
’’L M
$str
’’N P
)
’’P Q
+
’’R S
$str
’’T V
)
’’V W
;
’’W X
sb
÷÷  "
.
÷÷" #
Append
÷÷# )
(
÷÷) *
$str
÷÷* 1
)
÷÷1 2
;
÷÷2 3
}
◊◊ 
else
ÿÿ  
{
ŸŸ 
requestFormInt
⁄⁄  .
=
⁄⁄/ 0
requestFormInt
⁄⁄1 ?
.
⁄⁄? @
Split
⁄⁄@ E
(
⁄⁄E F
$char
⁄⁄F I
)
⁄⁄I J
[
⁄⁄J K
$num
⁄⁄K L
]
⁄⁄L M
.
⁄⁄M N
ToString
⁄⁄N V
(
⁄⁄V W
)
⁄⁄W X
;
⁄⁄X Y
sb
€€  "
.
€€" #
Append
€€# )
(
€€) *
requestFormInt
€€* 8
)
€€8 9
;
€€9 :
requestFormInt
‹‹  .
=
‹‹/ 0
form
‹‹1 5
[
‹‹5 6
requestFormInt
‹‹6 D
]
‹‹D E
;
‹‹E F
sb
››  "
.
››" #
Append
››# )
(
››) *
$str
››* /
+
››0 1
requestFormInt
››2 @
.
››@ A
Replace
››A H
(
››H I
$str
››I L
,
››L M
$str
››N P
)
››P Q
+
››R S
$str
››T V
)
››V W
;
››W X
sb
ﬁﬁ  "
.
ﬁﬁ" #
Append
ﬁﬁ# )
(
ﬁﬁ) *
$str
ﬁﬁ* 1
)
ﬁﬁ1 2
;
ﬁﬁ2 3
}
ﬂﬂ 
}
‡‡ 
}
‚‚ 
else
„„ 
if
„„ 
(
„„ 

filterType
„„ '
.
„„' (
Contains
„„( 0
(
„„0 1
$str
„„1 ;
)
„„; <
)
„„< =
{
‰‰ 
var
ÂÂ 
keyExtra
ÂÂ $
=
ÂÂ% &

filterType
ÂÂ' 1
.
ÂÂ1 2
Replace
ÂÂ2 9
(
ÂÂ9 :
$str
ÂÂ: E
,
ÂÂE F
$str
ÂÂG I
)
ÂÂI J
;
ÂÂJ K
sb
ÊÊ 
.
ÊÊ 
Append
ÊÊ !
(
ÊÊ! "
keyExtra
ÊÊ" *
)
ÊÊ* +
;
ÊÊ+ ,
sb
ÁÁ 
.
ÁÁ 
Append
ÁÁ !
(
ÁÁ! "
$str
ÁÁ" )
)
ÁÁ) *
;
ÁÁ* +
}
ËË 
if
ÈÈ 
(
ÈÈ 

filterType
ÈÈ "
.
ÈÈ" #
Contains
ÈÈ# +
(
ÈÈ+ ,
$str
ÈÈ, ;
)
ÈÈ; <
)
ÈÈ< =
{
ÍÍ 
var
ÎÎ 
cuteAnd
ÎÎ #
=
ÎÎ$ %
sb
ÎÎ& (
.
ÎÎ( )
ToString
ÎÎ) 1
(
ÎÎ1 2
)
ÎÎ2 3
.
ÎÎ3 4
	Substring
ÎÎ4 =
(
ÎÎ= >
$num
ÎÎ> ?
,
ÎÎ? @
sb
ÎÎA C
.
ÎÎC D
Length
ÎÎD J
-
ÎÎK L
$num
ÎÎM N
)
ÎÎN O
;
ÎÎO P
sb
ÏÏ 
=
ÏÏ 
new
ÏÏ  
StringBuilder
ÏÏ! .
(
ÏÏ. /
cuteAnd
ÏÏ/ 6
.
ÏÏ6 7
ToString
ÏÏ7 ?
(
ÏÏ? @
)
ÏÏ@ A
)
ÏÏA B
;
ÏÏB C
var
ÌÌ 
keyAfterWhere
ÌÌ )
=
ÌÌ* +

filterType
ÌÌ, 6
.
ÌÌ6 7
Replace
ÌÌ7 >
(
ÌÌ> ?
$str
ÌÌ? O
,
ÌÌO P
$str
ÌÌQ S
)
ÌÌS T
;
ÌÌT U
sb
ÓÓ 
.
ÓÓ 
Append
ÓÓ !
(
ÓÓ! "
keyAfterWhere
ÓÓ" /
)
ÓÓ/ 0
;
ÓÓ0 1
using
ÔÔ 
(
ÔÔ 
var
ÔÔ "
dbx
ÔÔ# &
=
ÔÔ' (
new
ÔÔ) ,
BayiPuanContext
ÔÔ- <
(
ÔÔ< =
)
ÔÔ= >
)
ÔÔ> ?
{
 
ViewData
ÒÒ $
[
ÒÒ$ %
$str
ÒÒ% 2
]
ÒÒ2 3
=
ÒÒ4 5
	reportKey
ÒÒ6 ?
?
ÒÒ? @
.
ÒÒ@ A
ReportTitle
ÒÒA L
;
ÒÒL M
var
ÚÚ 
cmd
ÚÚ  #
=
ÚÚ$ %
dbx
ÚÚ& )
.
ÚÚ) *
Database
ÚÚ* 2
.
ÚÚ2 3

Connection
ÚÚ3 =
.
ÚÚ= >
CreateCommand
ÚÚ> K
(
ÚÚK L
)
ÚÚL M
;
ÚÚM N
var
ÛÛ 
sql
ÛÛ  #
=
ÛÛ$ %
sb
ÛÛ& (
.
ÛÛ( )
ToString
ÛÛ) 1
(
ÛÛ1 2
)
ÛÛ2 3
;
ÛÛ3 4
cmd
ÙÙ 
.
ÙÙ  
CommandText
ÙÙ  +
=
ÙÙ, -
sql
ÙÙ. 1
.
ÙÙ1 2
ToString
ÙÙ2 :
(
ÙÙ: ;
)
ÙÙ; <
;
ÙÙ< =
cmd
ıı 
.
ıı  

Connection
ıı  *
.
ıı* +
Open
ıı+ /
(
ıı/ 0
)
ıı0 1
;
ıı1 2
table
ˆˆ !
.
ˆˆ! "
Load
ˆˆ" &
(
ˆˆ& '
cmd
ˆˆ' *
.
ˆˆ* +
ExecuteReader
ˆˆ+ 8
(
ˆˆ8 9
)
ˆˆ9 :
)
ˆˆ: ;
;
ˆˆ; <
return
˜˜ "
View
˜˜# '
(
˜˜' (
table
˜˜( -
)
˜˜- .
;
˜˜. /
}
¯¯ 
}
˘˘ 
}
˚˚ 
using
¸¸ 
(
¸¸ 
var
¸¸ 
dbx
¸¸ 
=
¸¸  
new
¸¸! $
BayiPuanContext
¸¸% 4
(
¸¸4 5
)
¸¸5 6
)
¸¸6 7
{
˝˝ 
ViewData
˛˛ 
[
˛˛ 
$str
˛˛ *
]
˛˛* +
=
˛˛, -
	reportKey
˛˛. 7
?
˛˛7 8
.
˛˛8 9
ReportTitle
˛˛9 D
;
˛˛D E
var
ˇˇ 
cmd
ˇˇ 
=
ˇˇ 
dbx
ˇˇ !
.
ˇˇ! "
Database
ˇˇ" *
.
ˇˇ* +

Connection
ˇˇ+ 5
.
ˇˇ5 6
CreateCommand
ˇˇ6 C
(
ˇˇC D
)
ˇˇD E
;
ˇˇE F
var
ÄÄ 
sql
ÄÄ 
=
ÄÄ 
sb
ÄÄ  
.
ÄÄ  !
ToString
ÄÄ! )
(
ÄÄ) *
)
ÄÄ* +
.
ÄÄ+ ,
	Substring
ÄÄ, 5
(
ÄÄ5 6
$num
ÄÄ6 7
,
ÄÄ7 8
sb
ÄÄ9 ;
.
ÄÄ; <
Length
ÄÄ< B
-
ÄÄC D
$num
ÄÄE F
)
ÄÄF G
;
ÄÄG H
cmd
ÅÅ 
.
ÅÅ 
CommandText
ÅÅ #
=
ÅÅ$ %
sql
ÅÅ& )
.
ÅÅ) *
ToString
ÅÅ* 2
(
ÅÅ2 3
)
ÅÅ3 4
;
ÅÅ4 5
cmd
ÇÇ 
.
ÇÇ 

Connection
ÇÇ "
.
ÇÇ" #
Open
ÇÇ# '
(
ÇÇ' (
)
ÇÇ( )
;
ÇÇ) *
table
ÉÉ 
.
ÉÉ 
Load
ÉÉ 
(
ÉÉ 
cmd
ÉÉ "
.
ÉÉ" #
ExecuteReader
ÉÉ# 0
(
ÉÉ0 1
)
ÉÉ1 2
)
ÉÉ2 3
;
ÉÉ3 4
return
ÑÑ 
View
ÑÑ 
(
ÑÑ  
table
ÑÑ  %
)
ÑÑ% &
;
ÑÑ& '
}
ÖÖ 
}
ÜÜ 
else
áá 
{
àà 
using
ââ 
(
ââ 
var
ââ 
dbx
ââ 
=
ââ  
new
ââ! $
BayiPuanContext
ââ% 4
(
ââ4 5
)
ââ5 6
)
ââ6 7
{
ää 
ViewData
ãã 
[
ãã 
$str
ãã *
]
ãã* +
=
ãã, -
	reportKey
ãã. 7
?
ãã7 8
.
ãã8 9
ReportTitle
ãã9 D
;
ããD E
var
åå 
cmd
åå 
=
åå 
dbx
åå !
.
åå! "
Database
åå" *
.
åå* +

Connection
åå+ 5
.
åå5 6
CreateCommand
åå6 C
(
ååC D
)
ååD E
;
ååE F
var
çç 
sql
çç 
=
çç 
	reportKey
çç '
?
çç' (
.
çç( )
	ReportSql
çç) 2
;
çç2 3
cmd
éé 
.
éé 
CommandText
éé #
=
éé$ %
sql
éé& )
;
éé) *
cmd
èè 
.
èè 

Connection
èè "
.
èè" #
Open
èè# '
(
èè' (
)
èè( )
;
èè) *
table
êê 
.
êê 
Load
êê 
(
êê 
cmd
êê "
.
êê" #
ExecuteReader
êê# 0
(
êê0 1
)
êê1 2
)
êê2 3
;
êê3 4
return
ëë 
View
ëë 
(
ëë  
table
ëë  %
)
ëë% &
;
ëë& '
}
íí 
}
ìì 
}
ïï 	
}
óó 
}òò €b
LE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\RoleController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class 
RoleController 
:  !
BaseController" 0
{ 
private 
readonly 
IRoleService %
_roleService& 2
;2 3
private 
readonly  
IQueryableRepository -
<- .
Role. 2
>2 3 
_queryableRepository4 H
;H I
private 
readonly  
IQueryableRepository -
<- .
vwRP_StockCount. =
>= > 
_totalRowsRepository? S
;S T
public 
RoleController 
( 
IRoleService *
roleService+ 6
,6 7 
IQueryableRepository8 L
<L M
RoleM Q
>Q R
queryableRepositoryS f
,f g 
IQueryableRepositoryh |
<| }
vwRP_StockCount	} å
>
å ç!
totalRowsRepository
é °
)
° ¢
{ 	
_roleService 
= 
roleService &
;& ' 
_queryableRepository  
=! "
queryableRepository# 6
;6 7 
_totalRowsRepository  
=! "
totalRowsRepository# 6
;6 7
}   	
[!! 
SecuredOperation!! 
(!! 
Roles!! 
=!! 
$str!! +
)!!+ ,
]!!, -
[## 	
SecuredOperation##	 
(## 
Roles## 
=##  !
$str##" /
)##/ 0
]##0 1
public$$ 
ActionResult$$ 
	RoleIndex$$ %
($$% &
Int32$$& +
?$$+ ,
page$$- 1
,$$1 2
Int32$$3 8
?$$8 9
rows$$: >
)$$> ?
{%% 	
IGrid&& 
<&& 
Role&& 
>&& 
col&& 
=&& 
new&& !
Grid&&" &
<&&& '
Role&&' +
>&&+ ,
(&&, - 
_queryableRepository&&- A
.&&A B
Table&&B G
.&&G H
OrderByDescending&&H Y
(&&Y Z
x&&Z [
=>&&\ ^
x&&_ `
.&&` a
RoleId&&a g
)&&g h
.&&h i
Skip&&i m
(&&m n
(&&n o
page&&o s
-&&t u
$num&&v w
??&&x z
$num&&{ |
)&&| }
*&&~ 
(
&&Ä Å
rows
&&Å Ö
??
&&Ü à
$num
&&â ã
)
&&ã å
)
&&å ç
.
&&ç é
Take
&&é í
(
&&í ì
rows
&&ì ó
??
&&ò ö
$num
&&õ ù
)
&&ù û
.
&&û ü
AsNoTracking
&&ü ´
(
&&´ ¨
)
&&¨ ≠
)
&&≠ Æ
;
&&Æ Ø
col'' 
.'' 
Query'' 
='' 
new'' 
NameValueCollection'' /
(''/ 0
Request''0 7
.''7 8
QueryString''8 C
)''C D
;''D E
if)) 
()) 
col)) 
.)) 
Query)) 
!=)) 
null)) !
)))! "
{** 
col++ 
=++ 
new++ 
Grid++ 
<++ 
Role++ #
>++# $
(++$ % 
_queryableRepository++% 9
.++9 :
Table++: ?
.++? @
OrderByDescending++@ Q
(++Q R
x++R S
=>++T V
x++W X
.++X Y
RoleId++Y _
)++_ `
.++` a
AsNoTracking++a m
(++m n
)++n o
)++o p
;++p q
},, 
col-- 
.-- 
Columns-- 
.-- 
Add-- 
(-- 
x-- 
=>--  
$str--! n
+--o p
x--q r
.--r s
RoleId--s y
+--z {
$str	--| Ö
+
--Ü á
$str..! v
+..w x
x..y z
...z {
RoleId	..{ Å
+
..Ç É
$str
..Ñ ç
)
..ç é
.// 
Encoded// 
(// 
false// 
)// 
.//  
Titled//  &
(//& '
$str//' 1
)//1 2
.//2 3

Filterable//3 =
(//= >
false//> C
)//C D
;//D E
col11 
.11 
Columns11 
.11 
Add11 
(11 
x11 
=>11  
x11! "
.11" #
RoleId11# )
)11) *
.11* +
Titled11+ 1
(111 2
$str112 :
)11: ;
.11; <
MultiFilterable11< K
(11K L
true11L P
)11P Q
;11Q R
col22 	
.22	 

Columns22
 
.22 
Add22 
(22 
x22 
=>22 
x22 
.22 
RoleName22 %
)22% &
.22& '
Titled22' -
(22- .
$str22. 8
)228 9
.229 :
MultiFilterable22: I
(22I J
true22J N
)22N O
;22O P
col44 	
.44	 

Pager44
 
=44 
new44 
	GridPager44 
<44  
Role44  $
>44$ %
(44% &
col44& )
)44) *
;44* +
col55 
.55 

Processors55 
.55 
Add55 
(55 
col55 "
.55" #
Pager55# (
)55( )
;55) *
col66 
.66 
Pager66 
.66 
RowsPerPage66 !
=66" #
$num66$ &
;66& '
col77 
.77 
	EmptyText77 
=77 
$str77 7
;777 8
foreach88 
(88 
IGridColumn88  
column88! '
in88( *
col88+ .
.88. /
Columns88/ 6
)886 7
{99 
column:: 
.:: 
IsFilterable:: #
=::$ %
true::& *
;::* +
column;; 
.;; 

IsSortable;; !
=;;" #
true;;$ (
;;;( )
}<< 
var== 
total== 
===  
_totalRowsRepository== ,
.==, -
Table==- 2
.==2 3
AsNoTracking==3 ?
(==? @
)==@ A
.==A B
Where==B G
(==G H
x==H I
=>==J L
x==M N
.==N O
	TableName==O X
====Y [
$str==\ c
)==c d
.==d e
Select==e k
(==k l
x==l m
=>==n p
x==q r
.==r s
	TableRows==s |
)==| }
.==} ~
First	==~ É
(
==É Ñ
)
==Ñ Ö
;
==Ö Ü
ViewBag>> 
.>> 
	totalRows>> 
=>> 
Convert>>  '
.>>' (
ToInt32>>( /
(>>/ 0
total>>0 5
)>>5 6
;>>6 7
return?? 
View?? 
(?? 
col?? 
)?? 
;?? 
}@@ 	
[BB 	
SecuredOperationBB	 
(BB 
RolesBB 
=BB  !
$strBB" /
)BB/ 0
]BB0 1
publicCC 
ActionResultCC 
CreateCC "
(CC" #
)CC# $
{DD 	
varEE 
emptyEE 
=EE 
newEE 
RoleViewModelEE )
(EE) *
)EE* +
;EE+ ,
varFF 
dataFF 
=FF 
emptyFF 
.FF 
ToVMFF !
(FF! "
)FF" #
;FF# $
returnGG 
ViewGG 
(GG 
dataGG 
)GG 
;GG 
}HH 	
[JJ 	
HttpPostJJ	 
]JJ 
publicKK 
ActionResultKK 
CreateKK "
(KK" #
RoleViewModelKK# 0
roleKK1 5
)KK5 6
{LL 	
ifMM 
(MM 
!MM 

ModelStateMM 
.MM 
IsValidMM #
)MM# $
{NN 
ErrorNotificationOO !
(OO! "
$strOO" 5
)OO5 6
;OO6 7
returnPP 
RedirectToActionPP '
(PP' (
$strPP( 0
)PP0 1
;PP1 2
}QQ 
_roleServiceRR 
.RR 
AddRR 
(RR 
newRR  
RoleRR! %
{SS 
RoleNameVV 
=VV 
roleVV 
.VV 
RoleNameVV &
}XX 
)XX 
;XX 
SuccessNotificationYY 
(YY  
$strYY  0
)YY0 1
;YY1 2
returnZZ 
RedirectToActionZZ #
(ZZ# $
$strZZ$ /
)ZZ/ 0
;ZZ0 1
}[[ 	
[]] 	
SecuredOperation]]	 
(]] 
Roles]] 
=]]  !
$str]]" /
)]]/ 0
]]]0 1
public^^ 
ActionResult^^ 
Edit^^  
(^^  !
int^^! $
id^^% '
)^^' (
{__ 	
var`` 
data`` 
=`` 
AutoMapperHelper`` '
.``' (
MapToSameViewModel``( :
<``: ;
Role``; ?
,``? @
RoleViewModel``A N
>``N O
(``O P
_roleService``P \
.``\ ]
GetById``] d
(``d e
id``e g
)``g h
)``h i
;``i j
returnaa 
Viewaa 
(aa 
dataaa 
.aa 
ToVMaa !
(aa! "
)aa" #
)aa# $
;aa$ %
}bb 	
[dd 	
HttpPostdd	 
]dd 
publicee 
ActionResultee 
Editee  
(ee  !
Roleee" &
roleee' +
)ee+ ,
{ff 	
trygg 
{hh 
_roleServicejj 
.jj 
Updatejj #
(jj# $
newjj$ '
Rolejj) -
{kk 
RoleNameoo 
=oo 
roleoo !
.oo! "
RoleNameoo" *
,oo* +
RoleIdpp 
=pp 
rolepp 
.pp  
RoleIdpp  &
}qq 
)qq 
;qq 
SuccessNotificationrr #
(rr# $
$strrr$ 7
)rr7 8
;rr8 9
returnss 
RedirectToActionss '
(ss' (
$strss( 3
)ss3 4
;ss4 5
}tt 
catchuu 
{vv 
returnww 
Viewww 
(ww 
)ww 
;ww 
}xx 
}yy 	
[{{ 	
SecuredOperation{{	 
({{ 
Roles{{ 
={{  !
$str{{" /
){{/ 0
]{{0 1
public|| 
ActionResult|| 
Delete|| "
(||" #
int||# &
id||' )
,||) *
Role||+ /
role||0 4
)||4 5
{}} 	
var~~ 
data~~ 
=~~ 
AutoMapperHelper~~ '
.~~' (
MapToSameViewModel~~( :
<~~: ;
Role~~; ?
,~~? @
RoleViewModel~~A N
>~~N O
(~~O P
_roleService~~P \
.~~\ ]
GetById~~] d
(~~d e
id~~e g
)~~g h
)~~h i
;~~i j
return 
View 
( 
data 
. 
ToVM !
(! "
)" #
)# $
;$ %
}
ÄÄ 	
[
ÇÇ 	
HttpPost
ÇÇ	 
]
ÇÇ 
public
ÉÉ 
ActionResult
ÉÉ 
Delete
ÉÉ "
(
ÉÉ" #
int
ÉÉ# &
id
ÉÉ' )
)
ÉÉ) *
{
ÑÑ 	
try
ÖÖ 
{
ÜÜ 
_roleService
áá 
.
áá 
Delete
áá #
(
áá# $
_roleService
áá$ 0
.
áá0 1
GetById
áá1 8
(
áá8 9
id
áá9 ;
)
áá; <
)
áá< =
;
áá= >!
SuccessNotification
àà #
(
àà# $
$str
àà$ 3
)
àà3 4
;
àà4 5
return
ââ 
RedirectToAction
ââ '
(
ââ' (
$str
ââ( 3
)
ââ3 4
;
ââ4 5
}
ää 
catch
ãã 
{
åå 
return
çç 
View
çç 
(
çç 
)
çç 
;
çç 
}
éé 
}
èè 	
}
êê 
}ëë Õ∫
LE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\SaleController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
SaleController 
: 
BaseController  .
{ 
private 
readonly 
ISaleService !
_saleService" .
;. /
private 
readonly 
IUserService !
_userService" .
;. /
private 
readonly 
IProductService $
_productService% 4
;4 5
private 
readonly  
IQueryableRepository )
<) *
Sale* .
>. / 
_queryableRepository0 D
;D E
private 
readonly  
IQueryableRepository )
<) *
Product* 1
>1 2'
_productQueryableRepository3 N
;N O
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
private   
readonly    
IQueryableRepository   )
<  ) *
User  * .
>  . /$
_userQueryableRepository  0 H
;  H I
private!! 
readonly!! 
IScoreService!! "
_scoreService!!# 0
;!!0 1
public"" 

SaleController"" 
("" 
ISaleService"" &
saleService""' 2
,""2 3 
IQueryableRepository""4 H
<""H I
Sale""I M
>""M N
queryableRepository""O b
,""b c 
IQueryableRepository""d x
<""x y
vwRP_StockCount	""y à
>
""à â!
totalRowsRepository
""ä ù
,
""ù û
IUserService
""ü ´
userService
""¨ ∑
,
""∑ ∏
IProductService
""π »
productService
""… ◊
,
""◊ ÿ"
IQueryableRepository
""Ÿ Ì
<
""Ì Ó
Product
""Ó ı
>
""ı ˆ(
productQueryableRepository
""˜ ë
,
""ë í"
IQueryableRepository
""ì ß
<
""ß ®
User
""® ¨
>
""¨ ≠%
userQueryableRepository
""Æ ≈
,
""≈ ∆
IScoreService
""« ‘
scoreService
""’ ·
)
""· ‚
{## 
_saleService$$ 
=$$ 
saleService$$  
;$$  ! 
_queryableRepository%% 
=%% 
queryableRepository%% 0
;%%0 1 
_totalRowsRepository&& 
=&& 
totalRowsRepository&& 0
;&&0 1
_userService'' 
='' 
userService''  
;''  !
_productService(( 
=(( 
productService(( &
;((& ''
_productQueryableRepository)) !
=))" #&
productQueryableRepository))$ >
;))> ?$
_userQueryableRepository** 
=**  #
userQueryableRepository**! 8
;**8 9
_scoreService++ 
=++ 
scoreService++ "
;++" #
},, 
[.. 
SecuredOperation.. 
(.. 
Roles.. 
=.. 
$str.. 6
)..6 7
]..7 8
public// 

ActionResult// 
	SaleIndex// !
(//! "
Int32//" '
?//' (
page//) -
,//- .
Int32/// 4
?//4 5
rows//6 :
)//: ;
{00 
var11 	
	getUserId11
 
=11 
_userService11 "
.11" #
UniqueUserName11# 1
(111 2
User112 6
.116 7
Identity117 ?
.11? @
Name11@ D
)11D E
;11E F
IGrid22 
<22 
Sale22 
>22 
col22 
=22 
new22 
Grid22  
<22  !
Sale22! %
>22% &
(22& ' 
_queryableRepository22' ;
.22; <
Table22< A
.22A B
Include22B I
(22I J
$str22J S
)22S T
.22T U
Include22U \
(22\ ]
$str22] g
)22g h
.22h i
Include22i p
(22p q
$str22q w
)22w x
.22x y
Where22y ~
(22~ 
x	22 Ä
=>
22Ä Ç
x
22Ç É
.
22É Ñ
UserId
22Ñ ä
==
22ä å
	getUserId
22å ï
.
22ï ñ
UserId
22ñ ú
&&
22ù ü
x
22† °
.
22° ¢

IsApproved
22¢ ¨
==
22¨ Æ
false
22Æ ≥
)
22≥ ¥
.
22¥ µ
OrderByDescending
22µ ∆
(
22∆ «
x
22« »
=>
22… À
x
22Ã Õ
.
22Õ Œ
SaleId
22Œ ‘
)
22‘ ’
.
22’ ÷
Skip
22÷ ⁄
(
22⁄ €
(
22€ ‹
page
22‹ ‡
-
22· ‚
$num
22„ ‰
??
22Â Á
$num
22Ë È
)
22È Í
*
22Î Ï
(
22Ì Ó
rows
22Ó Ú
??
22Û ı
$num
22ˆ ¯
)
22¯ ˘
)
22˘ ˙
.
22˙ ˚
Take
22˚ ˇ
(
22ˇ Ä
rows
22Ä Ñ
??
22Ö á
$num
22à ä
)
22ä ã
.
22ã å
AsNoTracking
22å ò
(
22ò ô
)
22ô ö
)
22ö õ
;
22õ ú
col33 	
.33	 

Query33
 
=33 
new33 
NameValueCollection33 )
(33) *
Request33* 1
.331 2
QueryString332 =
)33= >
;33> ?
if55 
(55	 

col55
 
.55 
Query55 
!=55 
null55 
)55 
{66 
col77 
=77 
new77 
Grid77 
<77 
Sale77 
>77 
(77  
_queryableRepository77 1
.771 2
Table772 7
.777 8
Include778 ?
(77? @
$str77@ I
)77I J
.77J K
Include77K R
(77R S
$str77S ]
)77] ^
.77^ _
Include77_ f
(77f g
$str77g m
)77m n
.77n o
Where77o t
(77t u
x77u v
=>77w y
x77z {
.77{ |
UserId	77| Ç
==
77É Ö
	getUserId
77Ü è
.
77è ê
UserId
77ê ñ
&&
77ó ô
x
77ö õ
.
77õ ú

IsApproved
77ú ¶
==
77ß ©
false
77™ Ø
)
77Ø ∞
.
77∞ ±
OrderByDescending
77± ¬
(
77¬ √
x
77√ ƒ
=>
77≈ «
x
77» …
.
77…  
SaleId
77  –
)
77– —
.
77— “
AsNoTracking
77“ ﬁ
(
77ﬁ ﬂ
)
77ﬂ ‡
)
77‡ ·
;
77· ‚
}88 
col== 	
.==	 

Columns==
 
.== 
Add== 
(== 
x== 
=>== 
x== 
.== 
	InvoiceNo== &
)==& '
.==' (
Titled==( .
(==. /
$str==/ :
)==: ;
;==; <
col>> 	
.>>	 

Columns>>
 
.>> 
Add>> 
(>> 
x>> 
=>>> 
x>> 
.>> 
InvoiceImage>> )
)>>) *
.>>* +
Titled>>+ 1
(>>1 2
$str>>2 B
)>>B C
.>>C D
Encoded>>D K
(>>K L
false>>L Q
)>>Q R
.>>R S

RenderedAs>>S ]
(>>] ^
x>>^ _
=>>>` b
x>>c d
.>>d e
InvoiceImage>>e q
!=>>r t
null>>u y
?>>z {
$str	>>| õ
+
>>ú ù
String
>>û §
.
>>§ •
Format
>>• ´
(
>>´ ¨
$str
>>¨ «
,
>>« »
Convert
>>… –
.
>>– —
ToBase64String
>>— ﬂ
(
>>ﬂ ‡
x
>>‡ ·
.
>>· ‚
InvoiceImage
>>‚ Ó
)
>>Ó Ô
)
>>Ô 
+
>>Ò Ú
$str
>>Û î
:
>>ï ñ
$str
>>ó Ÿ
)
>>Ÿ ⁄
;
>>⁄ €
col?? 	
.??	 

Columns??
 
.?? 
Add?? 
(?? 
x?? 
=>?? 
x?? 
.?? 
Product?? $
.??$ %
ProductName??% 0
)??0 1
.??1 2
Titled??2 8
(??8 9
$str??9 ?
)??? @
;??@ A
col@@ 	
.@@	 

Columns@@
 
.@@ 
Add@@ 
(@@ 
x@@ 
=>@@ 
x@@ 
.@@ 
AmountOfSales@@ *
)@@* +
.@@+ ,
Titled@@, 2
(@@2 3
$str@@3 ;
)@@; <
;@@< =
colAA 	
.AA	 

ColumnsAA
 
.AA 
AddAA 
(AA 
xAA 
=>AA 
xAA 
.AA 
InvoiceTotalAA )
)AA) *
.AA* +
TitledAA+ 1
(AA1 2
$strAA2 A
)AAA B
;AAB C
colBB 	
.BB	 

ColumnsBB
 
.BB 
AddBB 
(BB 
xBB 
=>BB 
xBB 
.BB 
CustomerBB %
.BB% &
CustomerNameBB& 2
)BB2 3
.BB3 4
TitledBB4 :
(BB: ;
$strBB; D
)BBD E
;BBE F
colDD 	
.DD	 

ColumnsDD
 
.DD 
AddDD 
(DD 
xDD 
=>DD 
xDD 
.DD 
InvoiceDateDD (
)DD( )
.DD) *
TitledDD* 0
(DD0 1
$strDD1 @
)DD@ A
;DDA B
colEE 	
.EE	 

ColumnsEE
 
.EE 
AddEE 
(EE 
xEE 
=>EE 
xEE 
.EE 
UserEE !
.EE! "
UserNameEE" *
)EE* +
.EE+ ,
TitledEE, 2
(EE2 3
$strEE3 ;
)EE; <
;EE< =
colFF 	
.FF	 

ColumnsFF
 
.FF 
AddFF 
(FF 
xFF 
=>FF 
xFF 
.FF 
ReasonFF #
)FF# $
.FF$ %
TitledFF% +
(FF+ ,
$strFF, ;
)FF; <
;FF< =
colHH 	
.HH	 

PagerHH
 
=HH 
newHH 
	GridPagerHH 
<HH  
SaleHH  $
>HH$ %
(HH% &
colHH& )
)HH) *
;HH* +
colII 	
.II	 


ProcessorsII
 
.II 
AddII 
(II 
colII 
.II 
PagerII "
)II" #
;II# $
colJJ 	
.JJ	 

PagerJJ
 
.JJ 
RowsPerPageJJ 
=JJ 
$numJJ  
;JJ  !
colKK 	
.KK	 

	EmptyTextKK
 
=KK 
$strKK 1
;KK1 2
foreachMM 
(MM 
IGridColumnMM 
columnMM !
inMM" $
colMM% (
.MM( )
ColumnsMM) 0
)MM0 1
{NN 
columnOO 
.OO 
IsFilterableOO 
=OO 
trueOO "
;OO" #
columnPP 
.PP 

IsSortablePP 
=PP 
truePP  
;PP  !
}QQ 
varRR 	
totalRR
 
=RR  
_totalRowsRepositoryRR &
.RR& '
TableRR' ,
.RR, -
AsNoTrackingRR- 9
(RR9 :
)RR: ;
.RR; <
WhereRR< A
(RRA B
xRRB C
=>RRD F
xRRG H
.RRH I
	TableNameRRI R
==RRS U
$strRRV ]
)RR] ^
.RR^ _
SelectRR_ e
(RRe f
xRRf g
=>RRh j
xRRk l
.RRl m
	TableRowsRRm v
)RRv w
.RRw x
FirstRRx }
(RR} ~
)RR~ 
;	RR Ä
ViewBagSS 
.SS 
	totalRowsSS 
=SS 
ConvertSS !
.SS! "
ToInt32SS" )
(SS) *
totalSS* /
)SS/ 0
;SS0 1
returnTT 
ViewTT 
(TT 
colTT 
)TT 
;TT 
}UU 
[WW 
SecuredOperationWW 
(WW 
RolesWW 
=WW 
$strWW 1
)WW1 2
]WW2 3
publicXX 

ActionResultXX 
ApprovedSaleIndexXX )
(XX) *
Int32XX* /
?XX/ 0
pageXX1 5
,XX5 6
Int32XX7 <
?XX< =
rowsXX> B
)XXB C
{YY 
IGridZZ 
<ZZ 
SaleZZ 
>ZZ 
colZZ 
=ZZ 
newZZ 
GridZZ  
<ZZ  !
SaleZZ! %
>ZZ% &
(ZZ& ' 
_queryableRepositoryZZ' ;
.ZZ; <
TableZZ< A
.ZZA B
IncludeZZB I
(ZZI J
$strZZJ S
)ZZS T
.ZZT U
IncludeZZU \
(ZZ\ ]
$strZZ] g
)ZZg h
.ZZh i
IncludeZZi p
(ZZp q
$strZZq w
)ZZw x
.ZZx y
WhereZZy ~
(ZZ~ 
x	ZZ Ä
=>
ZZÄ Ç
x
ZZÇ É
.
ZZÉ Ñ

IsApproved
ZZÑ é
==
ZZé ê
false
ZZê ï
&&
ZZñ ò
x
ZZô ö
.
ZZö õ
NotApproved
ZZõ ¶
!=
ZZ¶ ®
true
ZZ® ¨
)
ZZ¨ ≠
.
ZZ≠ Æ
OrderByDescending
ZZÆ ø
(
ZZø ¿
x
ZZ¿ ¡
=>
ZZ¬ ƒ
x
ZZ≈ ∆
.
ZZ∆ «
SaleId
ZZ« Õ
)
ZZÕ Œ
.
ZZŒ œ
Skip
ZZœ ”
(
ZZ” ‘
(
ZZ‘ ’
page
ZZ’ Ÿ
-
ZZ⁄ €
$num
ZZ‹ ›
??
ZZﬁ ‡
$num
ZZ· ‚
)
ZZ‚ „
*
ZZ‰ Â
(
ZZÊ Á
rows
ZZÁ Î
??
ZZÏ Ó
$num
ZZÔ Ò
)
ZZÒ Ú
)
ZZÚ Û
.
ZZÛ Ù
Take
ZZÙ ¯
(
ZZ¯ ˘
rows
ZZ˘ ˝
??
ZZ˛ Ä
$num
ZZÅ É
)
ZZÉ Ñ
.
ZZÑ Ö
AsNoTracking
ZZÖ ë
(
ZZë í
)
ZZí ì
)
ZZì î
;
ZZî ï
col[[ 	
.[[	 

Query[[
 
=[[ 
new[[ 
NameValueCollection[[ )
([[) *
Request[[* 1
.[[1 2
QueryString[[2 =
)[[= >
;[[> ?
if]] 
(]]	 

col]]
 
.]] 
Query]] 
!=]] 
null]] 
)]] 
{^^ 
col__ 
=__ 
new__ 
Grid__ 
<__ 
Sale__ 
>__ 
(__  
_queryableRepository__ 1
.__1 2
Table__2 7
.__7 8
Include__8 ?
(__? @
$str__@ I
)__I J
.__J K
Include__K R
(__R S
$str__S ]
)__] ^
.__^ _
Include___ f
(__f g
$str__g m
)__m n
.__n o
Where__o t
(__t u
x__u v
=>__w y
x__z {
.__{ |

IsApproved	__| Ü
==
__á â
false
__ä è
&&
__ê í
x
__ì î
.
__î ï
NotApproved
__ï †
!=
__° £
true
__§ ®
)
__® ©
.
__© ™
OrderByDescending
__™ ª
(
__ª º
x
__º Ω
=>
__æ ¿
x
__¡ ¬
.
__¬ √
SaleId
__√ …
)
__…  
.
__  À
AsNoTracking
__À ◊
(
__◊ ÿ
)
__ÿ Ÿ
)
__Ÿ ⁄
;
__⁄ €
}`` 
colaa 	
.aa	 

Columnsaa
 
.aa 
Addaa 
(aa 
xaa 
=>aa 
$straa p
+aaq r
xaas t
.aat u
SaleIdaau {
+aa| }
$str	aa~ á
+
aaà â
$strbb w
+bbx y
xbbz {
.bb{ |
SaleId	bb| Ç
+
bbÉ Ñ
$str
bbÖ é
)
bbé è
.cc
 
Encodedcc 
(cc 
falsecc 
)cc 
.cc 
Titledcc  
(cc  !
$strcc! +
)cc+ ,
.cc, -

Filterablecc- 7
(cc7 8
falsecc8 =
)cc= >
;cc> ?
colee 	
.ee	 

Columnsee
 
.ee 
Addee 
(ee 
xee 
=>ee 
xee 
.ee 
	InvoiceNoee &
)ee& '
.ee' (
Titledee( .
(ee. /
$stree/ :
)ee: ;
;ee; <
colff 	
.ff	 

Columnsff
 
.ff 
Addff 
(ff 
xff 
=>ff 
xff 
.ff 
InvoiceImageff )
)ff) *
.ff* +
Titledff+ 1
(ff1 2
$strff2 B
)ffB C
.ffC D
EncodedffD K
(ffK L
falseffL Q
)ffQ R
.ffR S

RenderedAsffS ]
(ff] ^
xff^ _
=>ff` b
xffc d
.ffd e
InvoiceImageffe q
!=ffr t
nullffu y
?ffz {
$str	ff| õ
+
ffú ù
String
ffû §
.
ff§ •
Format
ff• ´
(
ff´ ¨
$str
ff¨ «
,
ff« »
Convert
ff… –
.
ff– —
ToBase64String
ff— ﬂ
(
ffﬂ ‡
x
ff‡ ·
.
ff· ‚
InvoiceImage
ff‚ Ó
)
ffÓ Ô
)
ffÔ 
+
ffÒ Ú
$str
ffÛ ñ
:
ffó ò
$str
ffô €
)
ff€ ‹
;
ff‹ ›
colgg 	
.gg	 

Columnsgg
 
.gg 
Addgg 
(gg 
xgg 
=>gg 
xgg 
.gg 
Productgg $
.gg$ %
ProductNamegg% 0
)gg0 1
.gg1 2
Titledgg2 8
(gg8 9
$strgg9 ?
)gg? @
;gg@ A
colhh 	
.hh	 

Columnshh
 
.hh 
Addhh 
(hh 
xhh 
=>hh 
xhh 
.hh 
AmountOfSaleshh *
)hh* +
.hh+ ,
Titledhh, 2
(hh2 3
$strhh3 ;
)hh; <
;hh< =
colii 	
.ii	 

Columnsii
 
.ii 
Addii 
(ii 
xii 
=>ii 
xii 
.ii 
InvoiceTotalii )
)ii) *
.ii* +
Titledii+ 1
(ii1 2
$strii2 A
)iiA B
;iiB C
coljj 	
.jj	 

Columnsjj
 
.jj 
Addjj 
(jj 
xjj 
=>jj 
xjj 
.jj 
Customerjj %
.jj% &
CustomerNamejj& 2
)jj2 3
.jj3 4
Titledjj4 :
(jj: ;
$strjj; D
)jjD E
;jjE F
colkk 	
.kk	 

Columnskk
 
.kk 
Addkk 
(kk 
xkk 
=>kk 
xkk 
.kk 
InvoiceDatekk (
)kk( )
.kk) *
Titledkk* 0
(kk0 1
$strkk1 @
)kk@ A
;kkA B
colll 	
.ll	 

Columnsll
 
.ll 
Addll 
(ll 
xll 
=>ll 
xll 
.ll 
Userll !
.ll! "
UserNamell" *
)ll* +
.ll+ ,
Titledll, 2
(ll2 3
$strll3 ;
)ll; <
;ll< =
colnn 	
.nn	 

Pagernn
 
=nn 
newnn 
	GridPagernn 
<nn  
Salenn  $
>nn$ %
(nn% &
colnn& )
)nn) *
;nn* +
coloo 	
.oo	 


Processorsoo
 
.oo 
Addoo 
(oo 
coloo 
.oo 
Pageroo "
)oo" #
;oo# $
colpp 	
.pp	 

Pagerpp
 
.pp 
RowsPerPagepp 
=pp 
$numpp  
;pp  !
colqq 	
.qq	 

	EmptyTextqq
 
=qq 
$strqq 1
;qq1 2
foreachrr 
(rr 
IGridColumnrr 
columnrr !
inrr" $
colrr% (
.rr( )
Columnsrr) 0
)rr0 1
{ss 
columntt 
.tt 
IsFilterablett 
=tt 
truett "
;tt" #
columnuu 
.uu 

IsSortableuu 
=uu 
trueuu  
;uu  !
}vv 
varww 	
totalww
 
=ww  
_totalRowsRepositoryww &
.ww& '
Tableww' ,
.ww, -
Whereww- 2
(ww2 3
xww3 4
=>ww5 7
xww8 9
.ww9 :
	TableNameww: C
==wwD F
$strwwG N
)wwN O
.wwO P
AsNoTrackingwwP \
(ww\ ]
)ww] ^
.ww^ _
Selectww_ e
(wwe f
xwwf g
=>wwh j
xwwk l
.wwl m
	TableRowswwm v
)wwv w
.www x
Firstwwx }
(ww} ~
)ww~ 
;	ww Ä
ViewBagxx 
.xx 
	totalRowsxx 
=xx 
Convertxx !
.xx! "
ToInt32xx" )
(xx) *
totalxx* /
)xx/ 0
;xx0 1
returnyy 
Viewyy 
(yy 
colyy 
)yy 
;yy 
}zz 
[|| 
SecuredOperation|| 
(|| 
Roles|| 
=|| 
$str|| 6
)||6 7
]||7 8
public}} 

ActionResult}} 
Create}} 
(}} 
)}}  
{~~ 
var 	
empty
 
= 
new 
SaleViewModel #
(# $
)$ %
;% &
var
ÄÄ 	
data
ÄÄ
 
=
ÄÄ 
empty
ÄÄ 
.
ÄÄ 
ToVM
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
return
ÅÅ 
View
ÅÅ 
(
ÅÅ 
data
ÅÅ 
)
ÅÅ 
;
ÅÅ 
}
ÇÇ 
[
ÑÑ 
HttpPost
ÑÑ 
]
ÑÑ 
[
ÖÖ $
TransactionScopeAspect
ÖÖ 
]
ÖÖ 
public
ÜÜ 

ActionResult
ÜÜ 
Create
ÜÜ 
(
ÜÜ 
SaleViewModel
ÜÜ ,
sale
ÜÜ- 1
)
ÜÜ1 2
{
áá 
var
àà 	
	getUserId
àà
 
=
àà 
Convert
àà 
.
àà 
ToInt32
àà $
(
àà$ %
GeneralHelpers
àà% 3
.
àà3 4
	GetUserId
àà4 =
(
àà= >
)
àà> ?
)
àà? @
;
ààA B
if
ââ 
(
ââ	 

!
ââ
 

ModelState
ââ 
.
ââ 
IsValid
ââ 
)
ââ 
{
ää 
ErrorNotification
ãã 
(
ãã 
$str
ãã -
)
ãã- .
;
ãã. /
return
åå 
RedirectToAction
åå 
(
åå  
$str
åå  (
)
åå( )
;
åå) *
}
çç 
var
êê 	
product
êê
 
=
êê )
_productQueryableRepository
êê /
.
êê/ 0
Table
êê0 5
.
êê5 6
AsNoTracking
êê6 B
(
êêB C
)
êêC D
.
êêD E
FirstOrDefault
êêE S
(
êêS T
x
êêT U
=>
êêV X
x
êêY Z
.
êêZ [
	ProductId
êê[ d
==
êêe g
sale
êêh l
.
êêl m
	ProductId
êêm v
)
êêv w
;
êêw x
var
ëë 	
userMail
ëë
 
=
ëë &
_userQueryableRepository
ëë -
.
ëë- .
Table
ëë. 3
.
ëë3 4
AsNoTracking
ëë4 @
(
ëë@ A
)
ëëA B
.
ëëB C
FirstOrDefault
ëëC Q
(
ëëQ R
x
ëëR S
=>
ëëT V
x
ëëW X
.
ëëX Y
UserId
ëëY _
==
ëë` b
	getUserId
ëëb k
)
ëëk l
;
ëël m
if
íí 
(
íí	 

product
íí
 
==
íí 
null
íí 
||
íí 
product
íí $
.
íí$ %"
RemainingStockAmount
íí% 9
<
íí: ;
sale
íí< @
.
íí@ A
AmountOfSales
ííA N
)
ííN O
{
ìì 
ErrorNotification
îî 
(
îî 
$"
îî ®
òSatƒ±≈ü Ger√ßekle≈üemedi Sattƒ±ƒüƒ±nƒ±z √úr√ºn Miktarƒ± Satabileceƒüinizden Fazla G√∂z√ºk√ºyor! <br /> Satabileceƒüiniz √úr√ºn Stoƒüu Miktarƒ±:<strong> îî †
{îî† °
productîî° ®
.îî® ©$
RemainingStockAmountîî© Ω
.îîΩ æ
ToStringîîæ ∆
(îî∆ «
)îî« »
}îî» …
	</strong>îî… “
"îî“ ”
)îî” ‘
;îî‘ ’
return
ïï 
RedirectToAction
ïï 
(
ïï  
$str
ïï  (
)
ïï( )
;
ïï) *
}
ññ 
_saleService
óó 
.
óó 
Add
óó 
(
óó 
new
óó 
Sale
óó 
{
òò 
UserId
ôô 
=
ôô 
	getUserId
ôô 
,
ôô 
InvoiceImage
öö 
=
öö 
sale
öö 
.
öö 
InvoiceImage
öö (
,
öö( )
InvoiceDate
õõ 
=
õõ 
sale
õõ 
.
õõ 
InvoiceDate
õõ &
,
õõ& '
AddDate
úú 
=
úú 
DateTime
úú 
.
úú 
Now
úú 
,
úú 
AmountOfSales
ùù 
=
ùù 
sale
ùù 
.
ùù 
AmountOfSales
ùù *
,
ùù* +
InvoiceImageExt
ûû 
=
ûû 
$str
ûû  
,
ûû  !
	InvoiceNo
üü 
=
üü 
sale
üü 
.
üü 
	InvoiceNo
üü "
,
üü" #
	ProductId
†† 
=
†† 
sale
†† 
.
†† 
	ProductId
†† "
,
††" #

CustomerId
°° 
=
°° 
sale
°° 
.
°° 

CustomerId
°° $
,
°°$ %
InvoiceTotal
¢¢ 
=
¢¢ 
sale
¢¢ 
.
¢¢ 
InvoiceTotal
¢¢ (
}
££ 
)
££ 
;
££ 	
_productService
•• 
.
•• 
Update
•• 
(
•• 
new
••  
Product
••! (
{
¶¶ 
ProductName
ßß 
=
ßß 
product
ßß 
.
ßß 
ProductName
ßß )
,
ßß) *!
CriticalStockAmount
®® 
=
®® 
product
®® %
.
®®% &!
CriticalStockAmount
®®& 9
,
®®9 :
Point
©© 
=
©© 
product
©© 
.
©© 
Point
©© 
,
©© 
PointToMoney
™™ 
=
™™ 
product
™™ 
.
™™ 
PointToMoney
™™ +
,
™™+ ,
ProductCode
´´ 
=
´´ 
product
´´ 
.
´´ 
ProductCode
´´ )
,
´´) *
ProductShortCode
¨¨ 
=
¨¨ 
product
¨¨ "
.
¨¨" #
ProductShortCode
¨¨# 3
,
¨¨3 4
StockAmount
≠≠ 
=
≠≠ 
product
≠≠ 
.
≠≠ 
StockAmount
≠≠ )
,
≠≠) *

UnitTypeId
ÆÆ 
=
ÆÆ 
product
ÆÆ 
.
ÆÆ 

UnitTypeId
ÆÆ '
,
ÆÆ' ("
RemainingStockAmount
ØØ 
=
ØØ 
product
ØØ &
.
ØØ& '"
RemainingStockAmount
ØØ' ;
-
ØØ< =
sale
ØØ> B
.
ØØB C
AmountOfSales
ØØC P
,
ØØP Q
	ProductId
∞∞ 
=
∞∞ 
sale
∞∞ 
.
∞∞ 
	ProductId
∞∞ "
}
±± 
)
±± 
;
±± 	
var
≤≤ 	

mailEnable
≤≤
 
=
≤≤ 
System
≤≤ 
.
≤≤ 
Configuration
≤≤ +
.
≤≤+ ,"
ConfigurationManager
≤≤, @
.
≤≤@ A
AppSettings
≤≤A L
[
≤≤L M
$str
≤≤M Y
]
≤≤Y Z
;
≤≤Z [
if
≥≥ 
(
≥≥	 


mailEnable
≥≥
 
==
≥≥ 
$str
≥≥ 
)
≥≥ 
{
¥¥ 
var
µµ 
mail
µµ 
=
µµ 

MailHelper
µµ 
.
µµ 
SendMail
µµ &
(
µµ& '
$"
∂∂
 
{
∂∂ 
userMail
∂∂ 
.
∂∂ 
	FirstName
∂∂ 
+
∂∂  !
$str
∂∂" %
+
∂∂& '
userMail
∂∂( 0
.
∂∂0 1
LastName
∂∂1 9
}
∂∂9 :
 Tarafƒ±ndan 
∂∂: F
{
∂∂F G
sale
∂∂G K
.
∂∂K L
	InvoiceNo
∂∂L U
}
∂∂U Vz
k Fatura Numarasƒ±yla Yeni Bir Satƒ±≈ü Ger√ßekle≈ütirildi.<br/> L√ºtfen bayipuan.com √ºzerinde takip ediniz.∂∂V ∫
"∂∂∫ ª
,∂∂ª º
$"
∑∑
  
kerem@hemosoft.com
∑∑ 
"
∑∑ 
,
∑∑  
$str
∑∑! :
,
∑∑: ;
true
∑∑< @
)
∑∑@ A
;
∑∑A B
if
∏∏ 

(
∏∏ 
mail
∏∏ 
)
∏∏ 
{
ππ 	!
SuccessNotification
∫∫
 
(
∫∫ 
$str
∫∫ /
)
∫∫/ 0
;
∫∫0 1
}
ªª 	
else
ºº 
{
ΩΩ 	
ErrorNotification
ææ
 
(
ææ 
$str
ææ 1
)
ææ1 2
;
ææ2 3
}
øø 	
}
¿¿ !
SuccessNotification
¬¬ 
(
¬¬ 
$str
¬¬ X
)
¬¬X Y
;
¬¬Y Z
return
√√ 
RedirectToAction
√√ 
(
√√ 
$str
√√ )
)
√√) *
;
√√* +
}
ƒƒ 
[
∆∆ 
SecuredOperation
∆∆ 
(
∆∆ 
Roles
∆∆ 
=
∆∆ 
$str
∆∆ 1
)
∆∆1 2
]
∆∆2 3
public
«« 

ActionResult
«« 
Edit
«« 
(
«« 
int
««  
id
««! #
)
««# $
{
»» 
var
…… 	
data
……
 
=
…… 
AutoMapperHelper
…… !
.
……! " 
MapToSameViewModel
……" 4
<
……4 5
Sale
……5 9
,
……9 :"
ApproveSaleViewModel
……; O
>
……O P
(
……P Q
_saleService
……Q ]
.
……] ^
GetById
……^ e
(
……e f
id
……f h
)
……h i
)
……i j
;
……j k
return
   
View
   
(
   
data
   
.
   
ToVM
   
(
   
)
   
)
   
;
   
}
ÀÀ 
[
ÕÕ 
HttpPost
ÕÕ 
]
ÕÕ 
public
ŒŒ 

ActionResult
ŒŒ 
Edit
ŒŒ 
(
ŒŒ "
ApproveSaleViewModel
ŒŒ 1
sale
ŒŒ2 6
)
ŒŒ6 7
{
œœ 
var
–– 	
saleDefault
––
 
=
–– "
_queryableRepository
–– ,
.
––, -
Table
––- 2
.
––2 3
Include
––3 :
(
––: ;
$str
––; D
)
––D E
.
––E F
Include
––F M
(
––M N
$str
––N X
)
––X Y
.
––Y Z
Include
––Z a
(
––a b
$str
––b h
)
––h i
.
––i j
FirstOrDefault
––j x
(
––x y
x
––y z
=>
––z |
x
––| }
.
––} ~
SaleId––~ Ñ
==––Ñ Ü
sale––Ü ä
.––ä ã
SaleId––ã ë
)––ë í
;––í ì
if
—— 
(
——	 

!
——
 

ModelState
—— 
.
—— 
IsValid
—— 
)
—— 
{
““ 
ErrorNotification
”” 
(
”” 
$str
”” +
)
””+ ,
;
””, -
return
‘‘ 
RedirectToAction
‘‘ 
(
‘‘  
$str
‘‘  ,
)
‘‘, -
;
‘‘- .
}
’’ 
var
÷÷ 	
	saleImage
÷÷
 
=
÷÷ 
_saleService
÷÷ "
.
÷÷" #
GetById
÷÷# *
(
÷÷* +
sale
÷÷+ /
.
÷÷/ 0
SaleId
÷÷0 6
)
÷÷6 7
;
÷÷7 8
var
◊◊ 	
userMail
◊◊
 
=
◊◊ &
_userQueryableRepository
◊◊ -
.
◊◊- .
Table
◊◊. 3
.
◊◊3 4
AsNoTracking
◊◊4 @
(
◊◊@ A
)
◊◊A B
.
◊◊B C
FirstOrDefault
◊◊C Q
(
◊◊Q R
x
◊◊R S
=>
◊◊T V
x
◊◊W X
.
◊◊X Y
UserId
◊◊Y _
==
◊◊` b
sale
◊◊c g
.
◊◊g h
UserId
◊◊h n
)
◊◊n o
;
◊◊o p
try
ÿÿ 	
{
ŸŸ 
if
⁄⁄ 

(
⁄⁄ 
sale
⁄⁄ 
.
⁄⁄ 

IsApproved
⁄⁄ 
==
⁄⁄ 
false
⁄⁄ "
)
⁄⁄" #
{
€€ 	
ErrorNotification
‹‹
 
(
‹‹ 
$str
‹‹ Y
)
‹‹Y Z
;
‹‹Z [
return
››
 
Redirect
›› 
(
›› 
Request
›› !
.
››! "
UrlReferrer
››" -
.
››- .
ToString
››. 6
(
››6 7
)
››7 8
)
››8 9
;
››9 :
}
ﬁﬁ 	
if
‡‡
 
(
‡‡ 
	saleImage
‡‡ 
.
‡‡ 
InvoiceImage
‡‡ $
!=
‡‡% '
null
‡‡( ,
)
‡‡, -
{
··
 
_saleService
‚‚ 
.
‚‚ 
Update
‚‚ 
(
‚‚  
new
‚‚  #
Sale
‚‚$ (
{
„„ 
UserId
‰‰ 
=
‰‰ 
sale
‰‰ 
.
‰‰ 
UserId
‰‰ "
,
‰‰" #
InvoiceImage
ÂÂ 
=
ÂÂ 
	saleImage
ÂÂ &
.
ÂÂ& '
InvoiceImage
ÂÂ' 3
,
ÂÂ3 4
InvoiceDate
ÊÊ 
=
ÊÊ 
sale
ÊÊ  
.
ÊÊ  !
InvoiceDate
ÊÊ! ,
,
ÊÊ, -
AddDate
ÁÁ 
=
ÁÁ 
	saleImage
ÁÁ !
.
ÁÁ! "
AddDate
ÁÁ" )
,
ÁÁ) *
AmountOfSales
ËË 
=
ËË 
sale
ËË "
.
ËË" #
AmountOfSales
ËË# 0
,
ËË0 1
InvoiceImageExt
ÈÈ 
=
ÈÈ 
$str
ÈÈ  &
,
ÈÈ& '
	InvoiceNo
ÍÍ 
=
ÍÍ 
sale
ÍÍ 
.
ÍÍ 
	InvoiceNo
ÍÍ (
,
ÍÍ( )
	ProductId
ÎÎ 
=
ÎÎ 
sale
ÎÎ 
.
ÎÎ 
	ProductId
ÎÎ (
,
ÎÎ( )

CustomerId
ÏÏ 
=
ÏÏ 
sale
ÏÏ 
.
ÏÏ  

CustomerId
ÏÏ  *
,
ÏÏ* +
SaleId
ÌÌ 
=
ÌÌ 
sale
ÌÌ 
.
ÌÌ 
SaleId
ÌÌ "
,
ÌÌ" #

IsApproved
ÓÓ 
=
ÓÓ 
sale
ÓÓ 
.
ÓÓ  

IsApproved
ÓÓ  *
,
ÓÓ* +
ApprovedDate
ÔÔ 
=
ÔÔ 
DateTime
ÔÔ %
.
ÔÔ% &
Now
ÔÔ& )
,
ÔÔ) *
InvoiceTotal
 
=
 
sale
 !
.
! "
InvoiceTotal
" .
}
ÚÚ 
)
ÚÚ 
;
ÚÚ 
_scoreService
ÛÛ 
.
ÛÛ 
Add
ÛÛ 
(
ÛÛ 
new
ÛÛ !
Score
ÛÛ" '
{
ÙÙ 

ScoreTotal
ıı 
=
ıı 
sale
ıı 
.
ıı  
AmountOfSales
ıı  -
*
ıı. /
saleDefault
ıı0 ;
.
ıı; <
Product
ıı< C
.
ııC D
Point
ııD I
,
ııI J
	ScoreType
ˆˆ 
=
ˆˆ 
	ScoreType
ˆˆ #
.
ˆˆ# $

UrunModulu
ˆˆ$ .
,
ˆˆ. /
UserId
˜˜ 
=
˜˜ 
sale
˜˜ 
.
˜˜ 
UserId
˜˜ "
,
˜˜" #
	ScoreDate
¯¯ 
=
¯¯ 
DateTime
¯¯ "
.
¯¯" #
Now
¯¯# &
}
˘˘ 
)
˘˘ 
;
˘˘ 
var
˙˙ 

mailEnable
˙˙ 
=
˙˙ 
System
˙˙ #
.
˙˙# $
Configuration
˙˙$ 1
.
˙˙1 2"
ConfigurationManager
˙˙2 F
.
˙˙F G
AppSettings
˙˙G R
[
˙˙R S
$str
˙˙S _
]
˙˙_ `
;
˙˙` a
if
˚˚ 
(
˚˚ 

mailEnable
˚˚ 
==
˚˚ 
$str
˚˚ $
)
˚˚$ %
{
¸¸ 
var
˝˝ 
mail
˝˝ 
=
˝˝ 

MailHelper
˝˝ #
.
˝˝# $
SendMail
˝˝$ ,
(
˝˝, -
$"
˛˛ 

Tebrikler 
˛˛ 
{
˛˛ 
sale
˛˛ !
.
˛˛! "
	InvoiceNo
˛˛" +
}
˛˛+ ,l
] Fatura Numaralƒ± Satƒ±≈üƒ±nƒ±z Onaylandƒ±.<br/> L√ºtfen bayipuan.com √ºzerinde takip ediniz.˛˛, Å
"˛˛Å Ç
,˛˛Ç É
$"
ˇˇ 
{
ˇˇ 
userMail
ˇˇ 
.
ˇˇ 
Email
ˇˇ !
}
ˇˇ! "
"
ˇˇ" #
,
ˇˇ# $
$str
ˇˇ% 9
,
ˇˇ9 :
true
ˇˇ; ?
)
ˇˇ? @
;
ˇˇ@ A
if
ÄÄ 
(
ÄÄ 
mail
ÄÄ 
)
ÄÄ 
{
ÅÅ !
SuccessNotification
ÇÇ #
(
ÇÇ# $
$str
ÇÇ$ 5
)
ÇÇ5 6
;
ÇÇ6 7
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
ErrorNotification
ÜÜ !
(
ÜÜ! "
$str
ÜÜ" 7
)
ÜÜ7 8
;
ÜÜ8 9
}
áá 
}
àà !
SuccessNotification
ââ 
(
ââ  
$str
ââ  4
)
ââ4 5
;
ââ5 6
return
ää 
RedirectToAction
ää #
(
ää# $
$str
ää$ /
)
ää/ 0
;
ää0 1
}
ãã
 
_saleService
åå 
.
åå 
Update
åå 
(
åå 
new
åå 
Sale
åå  $
{
çç 	
UserId
éé
 
=
éé 
sale
éé 
.
éé 
UserId
éé 
,
éé 
InvoiceImage
èè
 
=
èè 
sale
èè 
.
èè 
InvoiceImage
èè *
,
èè* +
InvoiceDate
êê
 
=
êê 
sale
êê 
.
êê 
InvoiceDate
êê (
,
êê( )
AddDate
ëë
 
=
ëë 
	saleImage
ëë 
.
ëë 
AddDate
ëë %
,
ëë% &
AmountOfSales
íí
 
=
íí 
sale
íí 
.
íí 
AmountOfSales
íí ,
,
íí, -
InvoiceImageExt
ìì
 
=
ìì 
$str
ìì "
,
ìì" #
	InvoiceNo
îî
 
=
îî 
sale
îî 
.
îî 
	InvoiceNo
îî $
,
îî$ %
	ProductId
ïï
 
=
ïï 
sale
ïï 
.
ïï 
	ProductId
ïï $
,
ïï$ %

CustomerId
ññ
 
=
ññ 
sale
ññ 
.
ññ 

CustomerId
ññ &
,
ññ& '
SaleId
óó
 
=
óó 
sale
óó 
.
óó 
SaleId
óó 
,
óó 

IsApproved
òò
 
=
òò 
sale
òò 
.
òò 

IsApproved
òò &
,
òò& '
ApprovedDate
ôô
 
=
ôô 
DateTime
ôô !
.
ôô! "
Now
ôô" %
,
ôô% &
InvoiceTotal
öö
 
=
öö 
sale
öö 
.
öö 
InvoiceTotal
öö *
}
õõ 	
)
õõ	 

;
õõ
 
_scoreService
úú 
.
úú 
Add
úú 
(
úú 
new
úú 
Score
úú #
{
ùù 	

ScoreTotal
ûû
 
=
ûû 
sale
ûû 
.
ûû 
AmountOfSales
ûû )
*
ûû* +
saleDefault
ûû, 7
.
ûû7 8
Product
ûû8 ?
.
ûû? @
Point
ûû@ E
,
ûûE F
	ScoreType
üü
 
=
üü 
	ScoreType
üü 
.
üü  

UrunModulu
üü  *
,
üü* +
UserId
††
 
=
†† 
sale
†† 
.
†† 
UserId
†† 
,
†† 
	ScoreDate
°°
 
=
°° 
DateTime
°° 
.
°° 
Now
°° "
}
¢¢ 	
)
¢¢	 

;
¢¢
 
var
££ 
mailEnablex
££ 
=
££ 
System
££  
.
££  !
Configuration
££! .
.
££. /"
ConfigurationManager
££/ C
.
££C D
AppSettings
££D O
[
££O P
$str
££P \
]
££\ ]
;
££] ^
if
§§ 

(
§§ 
mailEnablex
§§ 
==
§§ 
$str
§§ !
)
§§! "
{
•• 	
var
¶¶
 
onayMail
¶¶ 
=
¶¶ 

MailHelper
ßß 
.
ßß 
SendMail
ßß 
(
ßß  
$"
®® 

Tebrikler 
®® 
{
®® 
sale
®® 
.
®®  
	InvoiceNo
®®  )
}
®®) *k
] Fatura Numaralƒ± Satƒ±≈üƒ±nƒ±z Onaylandƒ±.<br/> L√ºtfen bayipuan.com √ºzerinde takip ediniz.
®®* 
"®® Ä
,®®Ä Å
$"
©© 
{
©© 
userMail
©© 
.
©© 
Email
©© 
}
©©  
"
©©  !
,
©©! "
$str
©©# 7
,
©©7 8
true
©©9 =
)
©©= >
;
©©> ?
if
™™
 
(
™™ 
onayMail
™™ 
)
™™ 
{
´´
 !
SuccessNotification
¨¨ 
(
¨¨  
$str
¨¨  1
)
¨¨1 2
;
¨¨2 3
}
≠≠
 
else
ÆÆ
 
{
ØØ
 
ErrorNotification
∞∞ 
(
∞∞ 
$str
∞∞ 3
)
∞∞3 4
;
∞∞4 5
}
±±
 
}
≤≤ 	!
SuccessNotification
¥¥ 
(
¥¥ 
$str
¥¥ 0
)
¥¥0 1
;
¥¥1 2
return
µµ 
RedirectToAction
µµ 
(
µµ  
$str
µµ  +
)
µµ+ ,
;
µµ, -
}
∂∂ 
catch
∑∑ 
{
∏∏ 
return
ππ 
View
ππ 
(
ππ 
)
ππ 
;
ππ 
}
∫∫ 
}
ªª 
[
ΩΩ 
SecuredOperation
ΩΩ 
(
ΩΩ 
Roles
ΩΩ 
=
ΩΩ 
$str
ΩΩ 1
)
ΩΩ1 2
]
ΩΩ2 3
public
ææ 

ActionResult
ææ 

DeleteEdit
ææ "
(
ææ" #
int
ææ# &
id
ææ' )
)
ææ) *
{
øø 
var
¿¿ 	
data
¿¿
 
=
¿¿ 
AutoMapperHelper
¿¿ !
.
¿¿! " 
MapToSameViewModel
¿¿" 4
<
¿¿4 5
Sale
¿¿5 9
,
¿¿9 :%
NotApproveSaleViewModel
¿¿; R
>
¿¿R S
(
¿¿S T
_saleService
¿¿T `
.
¿¿` a
GetById
¿¿a h
(
¿¿h i
id
¿¿i k
)
¿¿k l
)
¿¿l m
;
¿¿m n
return
¡¡ 
View
¡¡ 
(
¡¡ 
data
¡¡ 
.
¡¡ 
ToVM
¡¡ 
(
¡¡ 
)
¡¡ 
)
¡¡ 
;
¡¡ 
}
¬¬ 
[
ƒƒ 
HttpPost
ƒƒ 
]
ƒƒ 
[
≈≈ $
TransactionScopeAspect
≈≈ 
]
≈≈ 
public
∆∆ 

ActionResult
∆∆ 

DeleteEdit
∆∆ "
(
∆∆" #%
NotApproveSaleViewModel
∆∆# :
sale
∆∆; ?
)
∆∆? @
{
«« 
if
»» 
(
»»	 

!
»»
 

ModelState
»» 
.
»» 
IsValid
»» 
)
»» 
{
…… 
ErrorNotification
   
(
   
$str
   +
)
  + ,
;
  , -
return
ÀÀ 
RedirectToAction
ÀÀ 
(
ÀÀ  
$str
ÀÀ  ,
)
ÀÀ, -
;
ÀÀ- .
}
ÃÃ 
var
ÕÕ 	
product
ÕÕ
 
=
ÕÕ )
_productQueryableRepository
ÕÕ /
.
ÕÕ/ 0
Table
ÕÕ0 5
.
ÕÕ5 6
AsNoTracking
ÕÕ6 B
(
ÕÕB C
)
ÕÕC D
.
ÕÕD E
FirstOrDefault
ÕÕE S
(
ÕÕS T
x
ÕÕT U
=>
ÕÕV X
x
ÕÕY Z
.
ÕÕZ [
	ProductId
ÕÕ[ d
==
ÕÕe g
sale
ÕÕh l
.
ÕÕl m
	ProductId
ÕÕm v
)
ÕÕv w
;
ÕÕw x
var
ŒŒ 	
	saleImage
ŒŒ
 
=
ŒŒ 
_saleService
ŒŒ "
.
ŒŒ" #
GetById
ŒŒ# *
(
ŒŒ* +
sale
ŒŒ+ /
.
ŒŒ/ 0
SaleId
ŒŒ0 6
)
ŒŒ6 7
;
ŒŒ7 8
var
œœ 	
userMail
œœ
 
=
œœ &
_userQueryableRepository
œœ -
.
œœ- .
Table
œœ. 3
.
œœ3 4
AsNoTracking
œœ4 @
(
œœ@ A
)
œœA B
.
œœB C
FirstOrDefault
œœC Q
(
œœQ R
x
œœR S
=>
œœT V
x
œœW X
.
œœX Y
UserId
œœY _
==
œœ` b
sale
œœc g
.
œœg h
UserId
œœh n
)
œœn o
;
œœo p
try
–– 	
{
—— 
if
”” 

(
”” 
	saleImage
”” 
.
”” 
InvoiceImage
”” "
!=
””# %
null
””& *
)
””* +
{
‘‘ 	
_saleService
’’
 
.
’’ 
Update
’’ 
(
’’ 
new
’’ !
Sale
’’" &
{
÷÷
 
UserId
◊◊ 
=
◊◊ 
sale
◊◊ 
.
◊◊ 
UserId
◊◊  
,
◊◊  !
InvoiceImage
ÿÿ 
=
ÿÿ 
	saleImage
ÿÿ $
.
ÿÿ$ %
InvoiceImage
ÿÿ% 1
,
ÿÿ1 2
InvoiceDate
ŸŸ 
=
ŸŸ 
	saleImage
ŸŸ #
.
ŸŸ# $
InvoiceDate
ŸŸ$ /
,
ŸŸ/ 0
AddDate
⁄⁄ 
=
⁄⁄ 
	saleImage
⁄⁄ 
.
⁄⁄  
AddDate
⁄⁄  '
,
⁄⁄' (
AmountOfSales
€€ 
=
€€ 
	saleImage
€€ %
.
€€% &
AmountOfSales
€€& 3
,
€€3 4
InvoiceImageExt
‹‹ 
=
‹‹ 
$str
‹‹ $
,
‹‹$ %
	InvoiceNo
›› 
=
›› 
	saleImage
›› !
.
››! "
	InvoiceNo
››" +
,
››+ ,
	ProductId
ﬁﬁ 
=
ﬁﬁ 
	saleImage
ﬁﬁ !
.
ﬁﬁ! "
	ProductId
ﬁﬁ" +
,
ﬁﬁ+ ,

CustomerId
ﬂﬂ 
=
ﬂﬂ 
	saleImage
ﬂﬂ "
.
ﬂﬂ" #

CustomerId
ﬂﬂ# -
,
ﬂﬂ- .
SaleId
‡‡ 
=
‡‡ 
sale
‡‡ 
.
‡‡ 
SaleId
‡‡  
,
‡‡  !

IsApproved
·· 
=
·· 
false
·· 
,
·· 
ApprovedDate
‚‚ 
=
‚‚ 
null
‚‚ 
,
‚‚  
NotApproved
„„ 
=
„„ 
true
„„ 
,
„„ 
NotApprovedDate
‰‰ 
=
‰‰ 
DateTime
‰‰ &
.
‰‰& '
Now
‰‰' *
,
‰‰* +
Reason
ÂÂ 
=
ÂÂ 
sale
ÂÂ 
.
ÂÂ 
Reason
ÂÂ  
,
ÂÂ  !
InvoiceTotal
ÊÊ 
=
ÊÊ 
sale
ÊÊ 
.
ÊÊ  
InvoiceTotal
ÊÊ  ,
}
ËË
 
)
ËË 
;
ËË 
_productService
ÈÈ
 
.
ÈÈ 
Update
ÈÈ  
(
ÈÈ  !
new
ÈÈ! $
Product
ÈÈ% ,
{
ÍÍ
 
ProductName
ÎÎ 
=
ÎÎ 
product
ÎÎ !
.
ÎÎ! "
ProductName
ÎÎ" -
,
ÎÎ- .!
CriticalStockAmount
ÌÌ 
=
ÌÌ  !
product
ÌÌ" )
.
ÌÌ) *!
CriticalStockAmount
ÌÌ* =
,
ÌÌ= >
Point
ÓÓ 
=
ÓÓ 
product
ÓÓ 
.
ÓÓ 
Point
ÓÓ !
,
ÓÓ! "
PointToMoney
ÔÔ 
=
ÔÔ 
product
ÔÔ "
.
ÔÔ" #
PointToMoney
ÔÔ# /
,
ÔÔ/ 0
ProductCode
 
=
 
product
 !
.
! "
ProductCode
" -
,
- .
ProductShortCode
ÒÒ 
=
ÒÒ 
product
ÒÒ &
.
ÒÒ& '
ProductShortCode
ÒÒ' 7
,
ÒÒ7 8
StockAmount
ÚÚ 
=
ÚÚ 
product
ÚÚ !
.
ÚÚ! "
StockAmount
ÚÚ" -
,
ÚÚ- .

UnitTypeId
ÛÛ 
=
ÛÛ 
product
ÛÛ  
.
ÛÛ  !

UnitTypeId
ÛÛ! +
,
ÛÛ+ ,"
RemainingStockAmount
ÙÙ  
=
ÙÙ! "
product
ÙÙ# *
.
ÙÙ* +"
RemainingStockAmount
ÙÙ+ ?
+
ÙÙ@ A
sale
ÙÙB F
.
ÙÙF G
AmountOfSales
ÙÙG T
,
ÙÙT U
	ProductId
ıı 
=
ıı 
sale
ıı 
.
ıı 
	ProductId
ıı &
}
ˆˆ
 
)
ˆˆ 
;
ˆˆ 
var
˜˜
 

mailEnable
˜˜ 
=
˜˜ 
System
˜˜ !
.
˜˜! "
Configuration
˜˜" /
.
˜˜/ 0"
ConfigurationManager
˜˜0 D
.
˜˜D E
AppSettings
˜˜E P
[
˜˜P Q
$str
˜˜Q ]
]
˜˜] ^
;
˜˜^ _
if
¯¯
 
(
¯¯ 

mailEnable
¯¯ 
==
¯¯ 
$str
¯¯ "
)
¯¯" #
{
˘˘
 
var
˙˙ 
mail
˙˙ 
=
˙˙ 

MailHelper
˙˙ !
.
˙˙! "
SendMail
˙˙" *
(
˙˙* +
$"
˚˚ 
{
˚˚ 
sale
˚˚ 
.
˚˚ 
	InvoiceNo
˚˚ 
}
˚˚  6
( Fatura Numaralƒ± Satƒ±≈üƒ±nƒ±z <strong>
˚˚  C
{
˚˚C D
sale
˚˚D H
.
˚˚H I
Reason
˚˚I O
}
˚˚O Pf
W</strong> Gerek√ßesiyle Onaylanmadƒ±.<br/> L√ºtfen bayipuan.com √ºzerinde takip ediniz.˚˚P £
"˚˚£ §
,˚˚§ •
$"
¸¸ 
{
¸¸ 
userMail
¸¸ 
.
¸¸ 
Email
¸¸ 
}
¸¸  
"
¸¸  !
,
¸¸! "
$str
¸¸# 7
,
¸¸7 8
true
¸¸9 =
)
¸¸= >
;
¸¸> ?
if
˝˝ 
(
˝˝ 
mail
˝˝ 
)
˝˝ 
{
˛˛ !
SuccessNotification
ˇˇ !
(
ˇˇ! "
$str
ˇˇ" 3
)
ˇˇ3 4
;
ˇˇ4 5
}
ÄÄ 
else
ÅÅ 
{
ÇÇ 
ErrorNotification
ÉÉ 
(
ÉÉ  
$str
ÉÉ  5
)
ÉÉ5 6
;
ÉÉ6 7
}
ÑÑ 
}
ÖÖ
 
ErrorNotification
áá
 
(
áá 
$str
áá F
)
ááF G
;
ááG H
return
àà
 
RedirectToAction
àà !
(
àà! "
$str
àà" -
)
àà- .
;
àà. /
}
ââ 	
_saleService
ää 
.
ää 
Update
ää 
(
ää 
new
ää 
Sale
ää  $
{
ãã 	
UserId
åå
 
=
åå 
sale
åå 
.
åå 
UserId
åå 
,
åå 
InvoiceImage
çç
 
=
çç 
null
çç 
,
çç 
InvoiceDate
éé
 
=
éé 
	saleImage
éé !
.
éé! "
InvoiceDate
éé" -
,
éé- .
AddDate
èè
 
=
èè 
	saleImage
èè 
.
èè 
AddDate
èè %
,
èè% &
AmountOfSales
êê
 
=
êê 
	saleImage
êê #
.
êê# $
AmountOfSales
êê$ 1
,
êê1 2
InvoiceImageExt
ëë
 
=
ëë 
$str
ëë "
,
ëë" #
	InvoiceNo
íí
 
=
íí 
	saleImage
íí 
.
íí  
	InvoiceNo
íí  )
,
íí) *
	ProductId
ìì
 
=
ìì 
	saleImage
ìì 
.
ìì  
	ProductId
ìì  )
,
ìì) *

CustomerId
îî
 
=
îî 
	saleImage
îî  
.
îî  !

CustomerId
îî! +
,
îî+ ,
SaleId
ïï
 
=
ïï 
sale
ïï 
.
ïï 
SaleId
ïï 
,
ïï 

IsApproved
ññ
 
=
ññ 
false
ññ 
,
ññ 
ApprovedDate
óó
 
=
óó 
null
óó 
,
óó 
NotApproved
òò
 
=
òò 
true
òò 
,
òò 
InvoiceTotal
ôô
 
=
ôô 
sale
ôô 
.
ôô 
InvoiceTotal
ôô *
,
ôô* +
NotApprovedDate
öö
 
=
öö 
DateTime
öö $
.
öö$ %
Now
öö% (
,
öö( )
Reason
õõ
 
=
õõ 
sale
õõ 
.
õõ 
Reason
õõ 
}
úú 	
)
úú	 

;
úú
 
_productService
ùù 
.
ùù 
Update
ùù 
(
ùù 
new
ùù "
Product
ùù# *
{
ûû 	
ProductName
üü
 
=
üü 
product
üü 
.
üü  
ProductName
üü  +
,
üü+ ,!
CriticalStockAmount
††
 
=
†† 
product
††  '
.
††' (!
CriticalStockAmount
††( ;
,
††; <
Point
°°
 
=
°° 
product
°° 
.
°° 
Point
°° 
,
°°  
PointToMoney
¢¢
 
=
¢¢ 
product
¢¢  
.
¢¢  !
PointToMoney
¢¢! -
,
¢¢- .
ProductCode
££
 
=
££ 
product
££ 
.
££  
ProductCode
££  +
,
££+ ,
ProductShortCode
§§
 
=
§§ 
product
§§ $
.
§§$ %
ProductShortCode
§§% 5
,
§§5 6
StockAmount
••
 
=
•• 
product
•• 
.
••  
StockAmount
••  +
,
••+ ,

UnitTypeId
¶¶
 
=
¶¶ 
product
¶¶ 
.
¶¶ 

UnitTypeId
¶¶ )
,
¶¶) *"
RemainingStockAmount
ßß
 
=
ßß  
product
ßß! (
.
ßß( )"
RemainingStockAmount
ßß) =
+
ßß> ?
sale
ßß@ D
.
ßßD E
AmountOfSales
ßßE R
,
ßßR S
	ProductId
®®
 
=
®® 
sale
®® 
.
®® 
	ProductId
®® $
}
©© 	
)
©©	 

;
©©
 
var
™™ 
mailEnablex
™™ 
=
™™ 
System
™™  
.
™™  !
Configuration
™™! .
.
™™. /"
ConfigurationManager
™™/ C
.
™™C D
AppSettings
™™D O
[
™™O P
$str
™™P \
]
™™\ ]
;
™™] ^
if
´´ 

(
´´ 
mailEnablex
´´ 
==
´´ 
$str
´´ !
)
´´! "
{
¨¨ 	
var
≠≠
 
redmail
≠≠ 
=
≠≠ 

MailHelper
ÆÆ 
.
ÆÆ 
SendMail
ÆÆ 
(
ÆÆ  
$"
ØØ 
{
ØØ 
sale
ØØ 
.
ØØ 
	InvoiceNo
ØØ 
}
ØØ  6
( Fatura Numaralƒ± Satƒ±≈üƒ±nƒ±z <strong>
ØØ  C
{
ØØC D
sale
ØØD H
.
ØØH I
Reason
ØØI O
}
ØØO Pf
W</strong> Gerek√ßesiyle Onaylanmadƒ±.<br/> L√ºtfen bayipuan.com √ºzerinde takip ediniz.ØØP £
"ØØ£ §
,ØØ§ •
$"
∞∞ 
{
∞∞ 
userMail
∞∞ 
.
∞∞ 
Email
∞∞ 
}
∞∞  
"
∞∞  !
,
∞∞! "
$str
∞∞# 7
,
∞∞7 8
true
∞∞9 =
)
∞∞= >
;
∞∞> ?
if
±±
 
(
±± 
redmail
±± 
)
±± 
{
≤≤
 !
SuccessNotification
≥≥ 
(
≥≥  
$str
≥≥  1
)
≥≥1 2
;
≥≥2 3
}
¥¥
 
else
µµ
 
{
∂∂
 
ErrorNotification
∑∑ 
(
∑∑ 
$str
∑∑ 3
)
∑∑3 4
;
∑∑4 5
}
∏∏
 
}
ππ 	
ErrorNotification
ªª 
(
ªª 
$str
ªª D
)
ªªD E
;
ªªE F
return
ºº 
RedirectToAction
ºº 
(
ºº  
$str
ºº  +
)
ºº+ ,
;
ºº, -
}
ΩΩ 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ 
{
øø 
return
¿¿ 
View
¿¿ 
(
¿¿ 
ex
¿¿ 
.
¿¿ 
ToString
¿¿ 
(
¿¿  
)
¿¿  !
)
¿¿! "
;
¿¿" #
}
¡¡ 
}
¬¬ 
}
√√ 
}ƒƒ ˛•
ME:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\ScoreController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
ScoreController 
:  
BaseController! /
{ 
private 
readonly 
IScoreService "
_scoreService# 0
;0 1
private 
readonly  
IQueryableRepository )
<) *
Score* /
>/ 0 
_queryableRepository1 E
;E F
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

ScoreController 
( 
IScoreService (
scoreService) 5
,5 6 
IQueryableRepository7 K
<K L
ScoreL Q
>Q R
queryableRepositoryS f
,f g 
IQueryableRepositoryh |
<| }
vwRP_StockCount	} å
>
å ç!
totalRowsRepository
é °
)
° ¢
{ 
_scoreService 
= 
scoreService "
;" # 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
}   
["" 
SecuredOperation"" 
("" 
Roles"" 
="" 
$str"" +
)""+ ,
]"", -
public## 

ActionResult## 

ScoreIndex## "
(##" #
Int32### (
?##( )
page##* .
,##. /
Int32##0 5
?##5 6
rows##7 ;
)##; <
{$$ 
var%% 	
userId%%
 
=%% 
Convert%% 
.%% 
ToInt32%% "
(%%" #
GeneralHelpers%%# 1
.%%1 2
	GetUserId%%2 ;
(%%; <
)%%< =
)%%= >
;%%> ?
IGrid&& 
<&& 
Score&& 
>&& 
col&& 
=&& 
new&& 
Grid&& !
<&&! "
Score&&" '
>&&' (
(&&( ) 
_queryableRepository&&) =
.&&= >
Table&&> C
.&&C D
Include&&D K
(&&K L
$str&&L R
)&&R S
.&&S T
OrderByDescending&&T e
(&&e f
x&&f g
=>&&h j
x&&k l
.&&l m
ScoreId&&m t
)&&t u
.&&u v
Skip&&v z
(&&z {
(&&{ |
page	&&| Ä
-
&&Å Ç
$num
&&É Ñ
??
&&Ö á
$num
&&à â
)
&&â ä
*
&&ã å
(
&&ç é
rows
&&é í
??
&&ì ï
$num
&&ñ ò
)
&&ò ô
)
&&ô ö
.
&&ö õ
Take
&&õ ü
(
&&ü †
rows
&&† §
??
&&• ß
$num
&&® ™
)
&&™ ´
)
&&´ ¨
;
&&¨ ≠
col'' 	
.''	 

Query''
 
='' 
new'' 
NameValueCollection'' )
('') *
Request''* 1
.''1 2
QueryString''2 =
)''= >
;''> ?
if)) 
())	 

col))
 
.)) 
Query)) 
!=)) 
null)) 
))) 
{** 
col++ 
=++ 
new++ 
Grid++ 
<++ 
Score++ 
>++ 
(++  
_queryableRepository++ 2
.++2 3
Table++3 8
.++8 9
Include++9 @
(++@ A
$str++A G
)++G H
.++H I
OrderByDescending++I Z
(++Z [
x++[ \
=>++] _
x++` a
.++a b
ScoreId++b i
)++i j
)++j k
;++k l
},, 
col-- 	
.--	 

Columns--
 
.-- 
Add-- 
(-- 
x-- 
=>-- 
$str-- h
+--i j
x--k l
.--l m
ScoreId--m t
+--u v
$str	--w Ä
+
--Å Ç
$str.. p
+..q r
x..s t
...t u
ScoreId..u |
+..} ~
$str	.. à
)
..à â
.//
 
Encoded// 
(// 
false// 
)// 
.// 
Titled//  
(//  !
$str//! +
)//+ ,
.//, -

Filterable//- 7
(//7 8
false//8 =
)//= >
;//> ?
col11 	
.11	 

Columns11
 
.11 
Add11 
(11 
x11 
=>11 
x11 
.11 
ScoreId11 $
)11$ %
.11% &
Titled11& ,
(11, -
$str11- 6
)116 7
.117 8
MultiFilterable118 G
(11G H
true11H L
)11L M
;11M N
col22 	
.22	 

Columns22
 
.22 
Add22 
(22 
x22 
=>22 
x22 
.22 
User22 !
.22! "
UserName22" *
)22* +
.22+ ,
Titled22, 2
(222 3
$str223 >
)22> ?
;22? @
col33 	
.33	 

Columns33
 
.33 
Add33 
(33 
x33 
=>33 
x33 
.33 

ScoreTotal33 '
)33' (
.33( )

RenderedAs33) 3
(333 4
x334 5
=>336 8
x339 :
.33: ;

ScoreTotal33; E
)33E F
.33F G
Titled33G M
(33M N
$str33N ^
)33^ _
;33_ `
col44 	
.44	 

Columns44
 
.44 
Add44 
(44 
x44 
=>44 
x44 
.44 
	ScoreType44 &
)44& '
.44' (
Titled44( .
(44. /
$str44/ B
)44B C
;44C D
col55 	
.55	 

Columns55
 
.55 
Add55 
(55 
x55 
=>55 
x55 
.55 
	ScoreDate55 &
)55& '
.55' (
Titled55( .
(55. /
$str55/ <
)55< =
;55= >
col66 	
.66	 

Pager66
 
=66 
new66 
	GridPager66 
<66  
Score66  %
>66% &
(66& '
col66' *
)66* +
;66+ ,
col77 	
.77	 


Processors77
 
.77 
Add77 
(77 
col77 
.77 
Pager77 "
)77" #
;77# $
col88 	
.88	 

Pager88
 
.88 
RowsPerPage88 
=88 
$num88  
;88  !
col99 	
.99	 

	EmptyText99
 
=99 
$str99 1
;991 2
foreach:: 
(:: 
IGridColumn:: 
column:: !
in::" $
col::% (
.::( )
Columns::) 0
)::0 1
{;; 
column<< 
.<< 
IsFilterable<< 
=<< 
true<< "
;<<" #
column== 
.== 

IsSortable== 
=== 
true==  
;==  !
}>> 
var?? 	
total??
 
=??  
_totalRowsRepository?? &
.??& '
Table??' ,
.??, -
Where??- 2
(??2 3
x??3 4
=>??5 7
x??8 9
.??9 :
	TableName??: C
==??D F
$str??G O
)??O P
.??P Q
Select??Q W
(??W X
x??X Y
=>??Z \
x??] ^
.??^ _
	TableRows??_ h
)??h i
.??i j
First??j o
(??o p
)??p q
;??q r
ViewBag@@ 
.@@ 
	totalRows@@ 
=@@ 
Convert@@ !
.@@! "
ToInt32@@" )
(@@) *
total@@* /
)@@/ 0
;@@0 1
returnAA 
ViewAA 
(AA 
colAA 
)AA 
;AA 
}BB 
[CC 
SecuredOperationCC 
(CC 
RolesCC 
=CC 
$strCC 6
)CC6 7
]CC7 8
publicDD 

ActionResultDD 
UserScoreIndexDD &
(DD& '
Int32DD' ,
?DD, -
pageDD. 2
,DD2 3
Int32DD4 9
?DD9 :
rowsDD; ?
)DD? @
{EE 
varFF 	
userIdFF
 
=FF 
ConvertFF 
.FF 
ToInt32FF "
(FF" #
GeneralHelpersFF# 1
.FF1 2
	GetUserIdFF2 ;
(FF; <
)FF< =
)FF= >
;FF> ?
IGridGG 
<GG 
ScoreGG 
>GG 
colGG 
=GG 
newGG 
GridGG !
<GG! "
ScoreGG" '
>GG' (
(GG( ) 
_queryableRepositoryGG) =
.GG= >
TableGG> C
.GGC D
IncludeGGD K
(GGK L
$strGGL R
)GGR S
.GGS T
WhereGGT Y
(GGY Z
xGGZ [
=>GG\ ^
xGG_ `
.GG` a
UserIdGGa g
==GGh j
userIdGGk q
)GGq r
.GGr s
OrderByDescending	GGs Ñ
(
GGÑ Ö
x
GGÖ Ü
=>
GGá â
x
GGä ã
.
GGã å
ScoreId
GGå ì
)
GGì î
.
GGî ï
Skip
GGï ô
(
GGô ö
(
GGö õ
page
GGõ ü
-
GG† °
$num
GG¢ £
??
GG§ ¶
$num
GGß ®
)
GG® ©
*
GG™ ´
(
GG¨ ≠
rows
GG≠ ±
??
GG≤ ¥
$num
GGµ ∑
)
GG∑ ∏
)
GG∏ π
.
GGπ ∫
Take
GG∫ æ
(
GGæ ø
rows
GGø √
??
GGƒ ∆
$num
GG« …
)
GG…  
)
GG  À
;
GGÀ Ã
colHH 	
.HH	 

QueryHH
 
=HH 
newHH 
NameValueCollectionHH )
(HH) *
RequestHH* 1
.HH1 2
QueryStringHH2 =
)HH= >
;HH> ?
ifJJ 
(JJ	 

colJJ
 
.JJ 
QueryJJ 
!=JJ 
nullJJ 
)JJ 
{KK 
colLL 
=LL 
newLL 
GridLL 
<LL 
ScoreLL 
>LL 
(LL  
_queryableRepositoryLL 2
.LL2 3
TableLL3 8
.LL8 9
IncludeLL9 @
(LL@ A
$strLLA G
)LLG H
.LLH I
WhereLLI N
(LLN O
xLLO P
=>LLQ S
xLLT U
.LLU V
UserIdLLV \
==LL] _
userIdLL` f
)LLf g
.LLg h
OrderByDescendingLLh y
(LLy z
xLLz {
=>LL| ~
x	LL Ä
.
LLÄ Å
ScoreId
LLÅ à
)
LLà â
)
LLâ ä
;
LLä ã
}MM 
colRR 	
.RR	 

ColumnsRR
 
.RR 
AddRR 
(RR 
xRR 
=>RR 
xRR 
.RR 
ScoreIdRR $
)RR$ %
.RR% &
TitledRR& ,
(RR, -
$strRR- 6
)RR6 7
.RR7 8
MultiFilterableRR8 G
(RRG H
trueRRH L
)RRL M
;RRM N
colSS 	
.SS	 

ColumnsSS
 
.SS 
AddSS 
(SS 
xSS 
=>SS 
xSS 
.SS 
UserSS !
.SS! "
UserNameSS" *
)SS* +
.SS+ ,
TitledSS, 2
(SS2 3
$strSS3 >
)SS> ?
;SS? @
colTT 	
.TT	 

ColumnsTT
 
.TT 
AddTT 
(TT 
xTT 
=>TT 
xTT 
.TT 

ScoreTotalTT '
)TT' (
.TT( )

RenderedAsTT) 3
(TT3 4
xTT4 5
=>TT6 8
xTT9 :
.TT: ;

ScoreTotalTT; E
)TTE F
.TTF G
TitledTTG M
(TTM N
$strTTN ^
)TT^ _
;TT_ `
colUU 	
.UU	 

ColumnsUU
 
.UU 
AddUU 
(UU 
xUU 
=>UU 
xUU 
.UU 
	ScoreTypeUU &
)UU& '
.UU' (
TitledUU( .
(UU. /
$strUU/ B
)UUB C
;UUC D
colVV 	
.VV	 

ColumnsVV
 
.VV 
AddVV 
(VV 
xVV 
=>VV 
xVV 
.VV 
	ScoreDateVV &
)VV& '
.VV' (
TitledVV( .
(VV. /
$strVV/ <
)VV< =
;VV= >
colWW 	
.WW	 

PagerWW
 
=WW 
newWW 
	GridPagerWW 
<WW  
ScoreWW  %
>WW% &
(WW& '
colWW' *
)WW* +
;WW+ ,
colXX 	
.XX	 


ProcessorsXX
 
.XX 
AddXX 
(XX 
colXX 
.XX 
PagerXX "
)XX" #
;XX# $
colYY 	
.YY	 

PagerYY
 
.YY 
RowsPerPageYY 
=YY 
$numYY  
;YY  !
colZZ 	
.ZZ	 

	EmptyTextZZ
 
=ZZ 
$strZZ 1
;ZZ1 2
foreach[[ 
([[ 
IGridColumn[[ 
column[[ !
in[[" $
col[[% (
.[[( )
Columns[[) 0
)[[0 1
{\\ 
column]] 
.]] 
IsFilterable]] 
=]] 
true]] "
;]]" #
column^^ 
.^^ 

IsSortable^^ 
=^^ 
true^^  
;^^  !
}__ 
var`` 	
total``
 
=``  
_totalRowsRepository`` &
.``& '
Table``' ,
.``, -
Where``- 2
(``2 3
x``3 4
=>``5 7
x``8 9
.``9 :
	TableName``: C
==``D F
$str``G O
)``O P
.``P Q
Select``Q W
(``W X
x``X Y
=>``Z \
x``] ^
.``^ _
	TableRows``_ h
)``h i
.``i j
First``j o
(``o p
)``p q
;``q r
ViewBagaa 
.aa 
	totalRowsaa 
=aa 
Convertaa !
.aa! "
ToInt32aa" )
(aa) *
totalaa* /
)aa/ 0
;aa0 1
returnbb 
Viewbb 
(bb 
colbb 
)bb 
;bb 
}cc 
[ee 
SecuredOperationee 
(ee 
Rolesee 
=ee 
$stree +
)ee+ ,
]ee, -
publicff 

ActionResultff 
Createff 
(ff 
)ff  
{gg 
varhh 	
emptyhh
 
=hh 
newhh 
ScoreViewModelhh $
(hh$ %
)hh% &
;hh& '
varii 	
dataii
 
=ii 
emptyii 
.ii 
ToVMii 
(ii 
)ii 
;ii 
returnjj 
Viewjj 
(jj 
datajj 
)jj 
;jj 
}kk 
[mm 
HttpPostmm 
]mm 
publicnn 

ActionResultnn 
Createnn 
(nn 
ScoreViewModelnn -
scorenn. 3
)nn3 4
{oo 
ifpp 
(pp	 

!pp
 

ModelStatepp 
.pp 
IsValidpp 
)pp 
{qq 
ErrorNotificationrr 
(rr 
$strrr -
)rr- .
;rr. /
returnss 
RedirectToActionss 
(ss  
$strss  (
)ss( )
;ss) *
}tt 
_scoreServiceuu 
.uu 
Adduu 
(uu 
newuu 
Scoreuu !
{vv 
UserIdww 
=ww 
scoreww 
.ww 
UserIdww 
,ww 
	ScoreDatexx 
=xx 
DateTimexx 
.xx 
Nowxx  
,xx  !

ScoreTotalyy 
=yy 
scoreyy 
.yy 

ScoreTotalyy %
,yy% &
	ScoreTypezz 
=zz 
	ScoreTypezz 
.zz 
YoneticiPuanArtƒ±rzz /
}{{ 
){{ 
;{{ 	
SuccessNotification|| 
(|| 
$str|| *
)||* +
;||+ ,
return}} 
RedirectToAction}} 
(}} 
$str}} *
)}}* +
;}}+ ,
}~~ 
[
ÄÄ 
SecuredOperation
ÄÄ 
(
ÄÄ 
Roles
ÄÄ 
=
ÄÄ 
$str
ÄÄ +
)
ÄÄ+ ,
]
ÄÄ, -
public
ÅÅ 

ActionResult
ÅÅ 
Edit
ÅÅ 
(
ÅÅ 
int
ÅÅ  
id
ÅÅ! #
)
ÅÅ# $
{
ÇÇ 
var
ÉÉ 	
data
ÉÉ
 
=
ÉÉ 
AutoMapperHelper
ÉÉ !
.
ÉÉ! " 
MapToSameViewModel
ÉÉ" 4
<
ÉÉ4 5
Score
ÉÉ5 :
,
ÉÉ: ;
ScoreViewModel
ÉÉ< J
>
ÉÉJ K
(
ÉÉK L
_scoreService
ÉÉL Y
.
ÉÉY Z
GetById
ÉÉZ a
(
ÉÉa b
id
ÉÉb d
)
ÉÉd e
)
ÉÉe f
;
ÉÉf g
return
ÑÑ 
View
ÑÑ 
(
ÑÑ 
data
ÑÑ 
.
ÑÑ 
ToVM
ÑÑ 
(
ÑÑ 
)
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
[
áá 
HttpPost
áá 
]
áá 
public
àà 

ActionResult
àà 
Edit
àà 
(
àà 
Score
àà "
score
àà# (
)
àà( )
{
ââ 
try
ää 	
{
ãã 
_scoreService
åå 
.
åå 
Update
åå 
(
åå 
new
åå  
Score
åå! &
{
çç 	
UserId
éé
 
=
éé 
score
éé 
.
éé 
UserId
éé 
,
éé  
	ScoreDate
èè
 
=
èè 
DateTime
èè 
.
èè 
Now
èè "
,
èè" #

ScoreTotal
êê
 
=
êê 
score
êê 
.
êê 

ScoreTotal
êê '
,
êê' (
	ScoreType
ëë
 
=
ëë 
	ScoreType
ëë 
.
ëë   
YoneticiPuanArtƒ±r
ëë  1
,
ëë1 2
ScoreId
íí
 
=
íí 
score
íí 
.
íí 
ScoreId
íí !
}
ìì 	
)
ìì	 

;
ìì
 !
SuccessNotification
îî 
(
îî 
$str
îî /
)
îî/ 0
;
îî0 1
return
ïï 
RedirectToAction
ïï 
(
ïï  
$str
ïï  ,
)
ïï, -
;
ïï- .
}
ññ 
catch
óó 
{
òò 
return
ôô 
View
ôô 
(
ôô 
)
ôô 
;
ôô 
}
öö 
}
õõ 
[
ùù 
SecuredOperation
ùù 
(
ùù 
Roles
ùù 
=
ùù 
$str
ùù +
)
ùù+ ,
]
ùù, -
public
ûû 

ActionResult
ûû 
Delete
ûû 
(
ûû 
int
ûû "
id
ûû# %
,
ûû% &
Score
ûû' ,
score
ûû- 2
)
ûû2 3
{
üü 
var
†† 	
data
††
 
=
†† 
AutoMapperHelper
†† !
.
††! " 
MapToSameViewModel
††" 4
<
††4 5
Score
††5 :
,
††: ;
ScoreViewModel
††< J
>
††J K
(
††K L
_scoreService
††L Y
.
††Y Z
GetById
††Z a
(
††a b
id
††b d
)
††d e
)
††e f
;
††f g
return
°° 
View
°° 
(
°° 
data
°° 
.
°° 
ToVM
°° 
(
°° 
)
°° 
)
°° 
;
°° 
}
¢¢ 
[
§§ 
HttpPost
§§ 
]
§§ 
public
•• 

ActionResult
•• 
Delete
•• 
(
•• 
int
•• "
id
••# %
)
••% &
{
¶¶ 
try
ßß 	
{
®® 
_scoreService
©© 
.
©© 
Delete
©© 
(
©© 
_scoreService
©© *
.
©©* +
GetById
©©+ 2
(
©©2 3
id
©©3 5
)
©©5 6
)
©©6 7
;
©©7 8!
SuccessNotification
™™ 
(
™™ 
$str
™™ +
)
™™+ ,
;
™™, -
return
´´ 
RedirectToAction
´´ 
(
´´  
$str
´´  ,
)
´´, -
;
´´- .
}
¨¨ 
catch
≠≠ 
{
ÆÆ 
return
ØØ 
View
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
}
∞∞ 
}
±± 
}
≤≤ 
}≥≥ ûq
NE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\SellerController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
SellerController 
:  !
BaseController" 0
{ 
private 
readonly 
ISellerService #
_sellerService$ 2
;2 3
private 
readonly  
IQueryableRepository )
<) *
Seller* 0
>0 1 
_queryableRepository2 F
;F G
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

SellerController 
( 
ISellerService *
sellerService+ 8
,8 9 
IQueryableRepository: N
<N O
SellerO U
>U V
queryableRepositoryW j
,j k!
IQueryableRepository	l Ä
<
Ä Å
vwRP_StockCount
Å ê
>
ê ë!
totalRowsRepository
í •
)
• ¶
{ 
_sellerService 
= 
sellerService $
;$ % 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
}   
["" 
SecuredOperation"" 
("" 
Roles"" 
="" 
$str"" 1
)""1 2
]""2 3
public## 

ActionResult## 
SellerIndex## #
(### $
Int32##$ )
?##) *
page##+ /
,##/ 0
Int32##1 6
?##6 7
rows##8 <
)##< =
{$$ 
IGrid%% 
<%% 
Seller%% 
>%% 
col%% 
=%% 
new%% 
Grid%% "
<%%" #
Seller%%# )
>%%) *
(%%* + 
_queryableRepository%%+ ?
.%%? @
Table%%@ E
.%%E F
Include%%F M
(%%M N
$str%%N T
)%%T U
.%%U V
Include%%V ]
(%%] ^
$str%%^ h
)%%h i
.%%i j
OrderByDescending%%j {
(%%{ |
x%%| }
=>	%%~ Ä
x
%%Å Ç
.
%%Ç É
SellerId
%%É ã
)
%%ã å
.
%%å ç
Skip
%%ç ë
(
%%ë í
(
%%í ì
page
%%ì ó
-
%%ò ô
$num
%%ö õ
??
%%ú û
$num
%%ü †
)
%%† °
*
%%¢ £
(
%%§ •
rows
%%• ©
??
%%™ ¨
$num
%%≠ Ø
)
%%Ø ∞
)
%%∞ ±
.
%%± ≤
Take
%%≤ ∂
(
%%∂ ∑
rows
%%∑ ª
??
%%º æ
$num
%%ø ¡
)
%%¡ ¬
.
%%¬ √
AsNoTracking
%%√ œ
(
%%œ –
)
%%– —
)
%%— “
;
%%“ ”
col&& 	
.&&	 

Query&&
 
=&& 
new&& 
NameValueCollection&& )
(&&) *
Request&&* 1
.&&1 2
QueryString&&2 =
)&&= >
;&&> ?
if(( 
(((	 

col((
 
.(( 
Query(( 
!=(( 
null(( 
)(( 
{)) 
col** 
=** 
new** 
Grid** 
<** 
Seller** 
>** 
(**  
_queryableRepository** 3
.**3 4
Table**4 9
.**9 :
Include**: A
(**A B
$str**B H
)**H I
.**I J
Include**J Q
(**Q R
$str**R \
)**\ ]
.**] ^
OrderByDescending**^ o
(**o p
x**p q
=>**r t
x**u v
.**v w
SellerId**w 
)	** Ä
.
**Ä Å
AsNoTracking
**Å ç
(
**ç é
)
**é è
)
**è ê
;
**ê ë
}++ 
col,, 	
.,,	 

Columns,,
 
.,, 
Add,, 
(,, 
x,, 
=>,, 
$str,, h
+,,i j
x,,k l
.,,l m
SellerId,,m u
+,,v w
$str	,,x Å
+
,,Ç É
$str-- p
+--q r
x--s t
.--t u
SellerId--u }
+--~ 
$str
--Ä â
)
--â ä
...
 
Encoded.. 
(.. 
false.. 
).. 
... 
Titled..  
(..  !
$str..! +
)..+ ,
..., -

Filterable..- 7
(..7 8
false..8 =
)..= >
;..> ?
col00 	
.00	 

Columns00
 
.00 
Add00 
(00 
x00 
=>00 
x00 
.00 
UserType00 %
.00% &
UserTypeName00& 2
)002 3
.003 4
Titled004 :
(00: ;
$str00; F
)00F G
.00G H
MultiFilterable00H W
(00W X
true00X \
)00\ ]
;00] ^
col11 	
.11	 

Columns11
 
.11 
Add11 
(11 
x11 
=>11 
x11 
.11 

SellerName11 '
)11' (
.11( )
Titled11) /
(11/ 0
$str110 :
)11: ;
.11; <
MultiFilterable11< K
(11K L
true11L P
)11P Q
;11Q R
col22 	
.22	 

Columns22
 
.22 
Add22 
(22 
x22 
=>22 
x22 
.22 

SellerCode22 '
)22' (
.22( )
Titled22) /
(22/ 0
$str220 ;
)22; <
.22< =
MultiFilterable22= L
(22L M
true22M Q
)22Q R
;22R S
col33 	
.33	 

Columns33
 
.33 
Add33 
(33 
x33 
=>33 
x33 
.33 
City33 !
.33! "
CityName33" *
)33* +
.33+ ,
Titled33, 2
(332 3
$str333 :
)33: ;
;33; <
col88 	
.88	 

Pager88
 
=88 
new88 
	GridPager88 
<88  
Seller88  &
>88& '
(88' (
col88( +
)88+ ,
;88, -
col99 	
.99	 


Processors99
 
.99 
Add99 
(99 
col99 
.99 
Pager99 "
)99" #
;99# $
col:: 	
.::	 

Pager::
 
.:: 
RowsPerPage:: 
=:: 
$num::  
;::  !
col;; 	
.;;	 

	EmptyText;;
 
=;; 
$str;; 1
;;;1 2
foreach<< 
(<< 
IGridColumn<< 
column<< !
in<<" $
col<<% (
.<<( )
Columns<<) 0
)<<0 1
{== 
column>> 
.>> 
IsFilterable>> 
=>> 
true>> "
;>>" #
column?? 
.?? 

IsSortable?? 
=?? 
true??  
;??  !
}@@ 
varAA 	
totalAA
 
=AA  
_totalRowsRepositoryAA &
.AA& '
TableAA' ,
.AA, -
WhereAA- 2
(AA2 3
xAA3 4
=>AA5 7
xAA8 9
.AA9 :
	TableNameAA: C
==AAD F
$strAAG P
)AAP Q
.AAQ R
AsNoTrackingAAR ^
(AA^ _
)AA_ `
.AA` a
SelectAAa g
(AAg h
xAAh i
=>AAj l
xAAm n
.AAn o
	TableRowsAAo x
)AAx y
.AAy z
FirstAAz 
(	AA Ä
)
AAÄ Å
;
AAÅ Ç
ViewBagBB 
.BB 
	totalRowsBB 
=BB 
ConvertBB !
.BB! "
ToInt32BB" )
(BB) *
totalBB* /
)BB/ 0
;BB0 1
returnCC 
ViewCC 
(CC 
colCC 
)CC 
;CC 
}DD 
[FF 
SecuredOperationFF 
(FF 
RolesFF 
=FF 
$strFF 1
)FF1 2
]FF2 3
publicGG 

ActionResultGG 
CreateGG 
(GG 
)GG  
{HH 
varII 	
emptyII
 
=II 
newII 
SellerViewModelII %
(II% &
)II& '
;II' (
varJJ 	
dataJJ
 
=JJ 
emptyJJ 
.JJ 
ToVMJJ 
(JJ 
)JJ 
;JJ 
returnKK 
ViewKK 
(KK 
dataKK 
)KK 
;KK 
}LL 
[NN 
HttpPostNN 
]NN 
publicOO 

ActionResultOO 
CreateOO 
(OO 
SellerViewModelOO .
sellerOO/ 5
)OO5 6
{PP 
ifQQ 
(QQ	 

!QQ
 

ModelStateQQ 
.QQ 
IsValidQQ 
)QQ 
{RR 
ErrorNotificationSS 
(SS 
$strSS -
)SS- .
;SS. /
returnTT 
RedirectToActionTT 
(TT  
$strTT  (
)TT( )
;TT) *
}UU 
_sellerServiceVV 
.VV 
AddVV 
(VV 
newVV 
SellerVV #
{WW 
CityIdXX 
=XX 
sellerXX 
.XX 
CityIdXX 
,XX 

SellerCodeYY 
=YY 
sellerYY 
.YY 

SellerCodeYY &
,YY& '

SellerNameZZ 
=ZZ 
sellerZZ 
.ZZ 

SellerNameZZ &
,ZZ& '

UserTypeId[[ 
=[[ 
seller[[ 
.[[ 

UserTypeId[[ &
}__ 
)__ 
;__ 	
SuccessNotification`` 
(`` 
$str`` *
)``* +
;``+ ,
returnaa 
RedirectToActionaa 
(aa 
$straa +
)aa+ ,
;aa, -
}bb 
[dd 
SecuredOperationdd 
(dd 
Rolesdd 
=dd 
$strdd 1
)dd1 2
]dd2 3
publicee 

ActionResultee 
Editee 
(ee 
intee  
idee! #
)ee# $
{ff 
vargg 	
datagg
 
=gg 
AutoMapperHelpergg !
.gg! "
MapToSameViewModelgg" 4
<gg4 5
Sellergg5 ;
,gg; <
SellerViewModelgg= L
>ggL M
(ggM N
_sellerServiceggN \
.gg\ ]
GetByIdgg] d
(ggd e
idgge g
)ggg h
)ggh i
;ggi j
returnhh 
Viewhh 
(hh 
datahh 
.hh 
ToVMhh 
(hh 
)hh 
)hh 
;hh 
}ii 
[kk 
HttpPostkk 
]kk 
publicll 

ActionResultll 
Editll 
(ll 
Sellerll #
sellerll$ *
)ll* +
{mm 
trynn 	
{oo 
_sellerServiceqq 
.qq 
Updateqq 
(qq 
newqq !
Sellerqq" (
{rr 	
CityIdss
 
=ss 
sellerss 
.ss 
CityIdss  
,ss  !

SellerCodett
 
=tt 
sellertt 
.tt 

SellerCodett (
,tt( )

SellerNameuu
 
=uu 
selleruu 
.uu 

SellerNameuu (
,uu( )

UserTypeIdvv
 
=vv 
sellervv 
.vv 

UserTypeIdvv (
,vv( )
SellerIdww
 
=ww 
sellerww 
.ww 
SellerIdww $
}xx 	
)xx	 

;xx
 
SuccessNotificationyy 
(yy 
$stryy /
)yy/ 0
;yy0 1
returnzz 
RedirectToActionzz 
(zz  
$strzz  -
)zz- .
;zz. /
}{{ 
catch|| 
{}} 
return~~ 
View~~ 
(~~ 
)~~ 
;~~ 
} 
}
ÄÄ 
[
ÇÇ 
SecuredOperation
ÇÇ 
(
ÇÇ 
Roles
ÇÇ 
=
ÇÇ 
$str
ÇÇ +
)
ÇÇ+ ,
]
ÇÇ, -
public
ÉÉ 

ActionResult
ÉÉ 
Delete
ÉÉ 
(
ÉÉ 
int
ÉÉ "
id
ÉÉ# %
,
ÉÉ% &
Seller
ÉÉ' -
seller
ÉÉ. 4
)
ÉÉ4 5
{
ÑÑ 
var
ÖÖ 	
data
ÖÖ
 
=
ÖÖ 
AutoMapperHelper
ÖÖ !
.
ÖÖ! " 
MapToSameViewModel
ÖÖ" 4
<
ÖÖ4 5
Seller
ÖÖ5 ;
,
ÖÖ; <
SellerViewModel
ÖÖ= L
>
ÖÖL M
(
ÖÖM N
_sellerService
ÖÖN \
.
ÖÖ\ ]
GetById
ÖÖ] d
(
ÖÖd e
id
ÖÖe g
)
ÖÖg h
)
ÖÖh i
;
ÖÖi j
return
ÜÜ 
View
ÜÜ 
(
ÜÜ 
data
ÜÜ 
.
ÜÜ 
ToVM
ÜÜ 
(
ÜÜ 
)
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
áá 
[
ââ 
HttpPost
ââ 
]
ââ 
public
ää 

ActionResult
ää 
Delete
ää 
(
ää 
int
ää "
id
ää# %
)
ää% &
{
ãã 
try
åå 	
{
çç 
_sellerService
éé 
.
éé 
Delete
éé 
(
éé 
_sellerService
éé ,
.
éé, -
GetById
éé- 4
(
éé4 5
id
éé5 7
)
éé7 8
)
éé8 9
;
éé9 :!
SuccessNotification
èè 
(
èè 
$str
èè +
)
èè+ ,
;
èè, -
return
êê 
RedirectToAction
êê 
(
êê  
$str
êê  -
)
êê- .
;
êê. /
}
ëë 
catch
íí 
{
ìì 
return
îî 
View
îî 
(
îî 
)
îî 
;
îî 
}
ïï 
}
ññ 
}
óó 
}òò ≥a
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\UnitTypeController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
UnitTypeController !
:" #
BaseController$ 2
{ 
private 
readonly 
IUnitTypeService %
_unitTypeService& 6
;6 7
private 
readonly  
IQueryableRepository )
<) *
UnitType* 2
>2 3 
_queryableRepository4 H
;H I
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

UnitTypeController 
( 
IUnitTypeService .
unitTypeService/ >
,> ? 
IQueryableRepository@ T
<T U
UnitTypeU ]
>] ^
queryableRepository_ r
,r s!
IQueryableRepository	t à
<
à â
vwRP_StockCount
â ò
>
ò ô!
totalRowsRepository
ö ≠
)
≠ Æ
{ 
_unitTypeService 
= 
unitTypeService (
;( ) 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
} 
[   
SecuredOperation   
(   
Roles   
=   
$str   1
)  1 2
]  2 3
public!! 

ActionResult!! 
UnitTypeIndex!! %
(!!% &
Int32!!& +
?!!+ ,
page!!- 1
,!!1 2
Int32!!3 8
?!!8 9
rows!!: >
)!!> ?
{"" 
IGrid## 
<## 
UnitType## 
>## 
col## 
=## 
new## 
Grid##  $
<##$ %
UnitType##% -
>##- .
(##. / 
_queryableRepository##/ C
.##C D
Table##D I
.##I J
OrderByDescending##J [
(##[ \
x##\ ]
=>##^ `
x##a b
.##b c

UnitTypeId##c m
)##m n
.##n o
Skip##o s
(##s t
(##t u
page##u y
-##z {
$num##| }
??	##~ Ä
$num
##Å Ç
)
##Ç É
*
##Ñ Ö
(
##Ü á
rows
##á ã
??
##å é
$num
##è ë
)
##ë í
)
##í ì
.
##ì î
Take
##î ò
(
##ò ô
rows
##ô ù
??
##û †
$num
##° £
)
##£ §
.
##§ •
AsNoTracking
##• ±
(
##± ≤
)
##≤ ≥
)
##≥ ¥
;
##¥ µ
col$$ 	
.$$	 

Query$$
 
=$$ 
new$$ 
NameValueCollection$$ )
($$) *
Request$$* 1
.$$1 2
QueryString$$2 =
)$$= >
;$$> ?
if&& 
(&&	 

col&&
 
.&& 
Query&& 
!=&& 
null&& 
)&& 
{'' 
col(( 
=(( 
new(( 
Grid(( 
<(( 
UnitType(( 
>((  
(((  ! 
_queryableRepository((! 5
.((5 6
Table((6 ;
.((; <
OrderByDescending((< M
(((M N
x((N O
=>((P R
x((S T
.((T U

UnitTypeId((U _
)((_ `
.((` a
AsNoTracking((a m
(((m n
)((n o
)((o p
;((p q
})) 
col** 	
.**	 

Columns**
 
.** 
Add** 
(** 
x** 
=>** 
$str** h
+**i j
x**k l
.**l m

UnitTypeId**m w
+**x y
$str	**z É
+
**Ñ Ö
$str++ p
+++q r
x++s t
.++t u

UnitTypeId++u 
+
++Ä Å
$str
++Ç ã
)
++ã å
.,,
 
Encoded,, 
(,, 
false,, 
),, 
.,, 
Titled,,  
(,,  !
$str,,! +
),,+ ,
.,,, -

Filterable,,- 7
(,,7 8
false,,8 =
),,= >
;,,> ?
col.. 	
...	 

Columns..
 
... 
Add.. 
(.. 
x.. 
=>.. 
x.. 
... 

UnitTypeId.. '
)..' (
...( )
Titled..) /
(../ 0
$str..0 :
)..: ;
;..; <
col// 	
.//	 

Columns//
 
.// 
Add// 
(// 
x// 
=>// 
x// 
.// 
UnitTypeName// )
)//) *
.//* +
Titled//+ 1
(//1 2
$str//2 =
)//= >
;//> ?
col11 	
.11	 

Pager11
 
=11 
new11 
	GridPager11 
<11  
UnitType11  (
>11( )
(11) *
col11* -
)11- .
;11. /
col22 	
.22	 


Processors22
 
.22 
Add22 
(22 
col22 
.22 
Pager22 "
)22" #
;22# $
col33 	
.33	 

Pager33
 
.33 
RowsPerPage33 
=33 
$num33  
;33  !
col44 	
.44	 

	EmptyText44
 
=44 
$str44 1
;441 2
foreach55 
(55 
IGridColumn55 
column55 !
in55" $
col55% (
.55( )
Columns55) 0
)550 1
{66 
column77 
.77 
IsFilterable77 
=77 
true77 "
;77" #
column88 
.88 

IsSortable88 
=88 
true88  
;88  !
}99 
var:: 	
total::
 
=::  
_totalRowsRepository:: &
.::& '
Table::' ,
.::, -
Where::- 2
(::2 3
x::3 4
=>::5 7
x::8 9
.::9 :
	TableName::: C
==::D F
$str::G R
)::R S
.::S T
AsNoTracking::T `
(::` a
)::a b
.::b c
Select::c i
(::i j
x::j k
=>::l n
x::o p
.::p q
	TableRows::q z
)::z {
.::{ |
First	::| Å
(
::Å Ç
)
::Ç É
;
::É Ñ
ViewBag;; 
.;; 
	totalRows;; 
=;; 
Convert;; !
.;;! "
ToInt32;;" )
(;;) *
total;;* /
);;/ 0
;;;0 1
return<< 
View<< 
(<< 
col<< 
)<< 
;<< 
}== 
[?? 
SecuredOperation?? 
(?? 
Roles?? 
=?? 
$str?? 1
)??1 2
]??2 3
public@@ 

ActionResult@@ 
Create@@ 
(@@ 
)@@  
{AA 
varBB 	
emptyBB
 
=BB 
newBB 
UnitTypeViewModelBB '
(BB' (
)BB( )
;BB) *
varCC 	
dataCC
 
=CC 
emptyCC 
.CC 
ToVMCC 
(CC 
)CC 
;CC 
returnDD 
ViewDD 
(DD 
dataDD 
)DD 
;DD 
}EE 
[GG 
HttpPostGG 
]GG 
publicHH 

ActionResultHH 
CreateHH 
(HH 
UnitTypeViewModelHH 0
unitTypeHH1 9
)HH9 :
{II 
ifJJ 
(JJ	 

!JJ
 

ModelStateJJ 
.JJ 
IsValidJJ 
)JJ 
{KK 
ErrorNotificationLL 
(LL 
$strLL -
)LL- .
;LL. /
returnMM 
RedirectToActionMM 
(MM  
$strMM  (
)MM( )
;MM) *
}NN 
_unitTypeServiceOO 
.OO 
AddOO 
(OO 
newOO 
UnitTypeOO '
{PP 
UnitTypeNameQQ 
=QQ 
unitTypeQQ 
.QQ  
UnitTypeNameQQ  ,
}SS 
)SS 
;SS 	
SuccessNotificationTT 
(TT 
$strTT *
)TT* +
;TT+ ,
returnUU 
RedirectToActionUU 
(UU 
$strUU -
)UU- .
;UU. /
}VV 
[XX 
SecuredOperationXX 
(XX 
RolesXX 
=XX 
$strXX 1
)XX1 2
]XX2 3
publicYY 

ActionResultYY 
EditYY 
(YY 
intYY  
idYY! #
)YY# $
{ZZ 
var[[ 	
data[[
 
=[[ 
AutoMapperHelper[[ !
.[[! "
MapToSameViewModel[[" 4
<[[4 5
UnitType[[5 =
,[[= >
UnitTypeViewModel[[? P
>[[P Q
([[Q R
_unitTypeService[[R b
.[[b c
GetById[[c j
([[j k
id[[k m
)[[m n
)[[n o
;[[o p
return\\ 
View\\ 
(\\ 
data\\ 
.\\ 
ToVM\\ 
(\\ 
)\\ 
)\\ 
;\\ 
}]] 
[__ 
HttpPost__ 
]__ 
public`` 

ActionResult`` 
Edit`` 
(`` 
UnitType`` %
unitType``& .
)``. /
{aa 
trybb 	
{cc 
_unitTypeServiceee 
.ee 
Updateee 
(ee  
newee  #
UnitTypeee$ ,
{ff 	
UnitTypeNamegg
 
=gg 
unitTypegg !
.gg! "
UnitTypeNamegg" .
,gg. /

UnitTypeIdhh
 
=hh 
unitTypehh 
.hh  

UnitTypeIdhh  *
}ii 	
)ii	 

;ii
 
SuccessNotificationjj 
(jj 
$strjj /
)jj/ 0
;jj0 1
returnkk 
RedirectToActionkk 
(kk  
$strkk  /
)kk/ 0
;kk0 1
}ll 
catchmm 
{nn 
returnoo 
Viewoo 
(oo 
)oo 
;oo 
}pp 
}qq 
[ss 
SecuredOperationss 
(ss 
Rolesss 
=ss 
$strss +
)ss+ ,
]ss, -
publictt 

ActionResulttt 
Deletett 
(tt 
inttt "
idtt# %
,tt% &
UnitTypett' /
unitTypett0 8
)tt8 9
{uu 
varvv 	
datavv
 
=vv 
AutoMapperHelpervv !
.vv! "
MapToSameViewModelvv" 4
<vv4 5
UnitTypevv5 =
,vv= >
UnitTypeViewModelvv? P
>vvP Q
(vvQ R
_unitTypeServicevvR b
.vvb c
GetByIdvvc j
(vvj k
idvvk m
)vvm n
)vvn o
;vvo p
returnww 
Viewww 
(ww 
dataww 
.ww 
ToVMww 
(ww 
)ww 
)ww 
;ww 
}xx 
[zz 
HttpPostzz 
]zz 
public{{ 

ActionResult{{ 
Delete{{ 
({{ 
int{{ "
id{{# %
){{% &
{|| 
try}} 	
{~~ 
_unitTypeService 
. 
Delete 
(  
_unitTypeService  0
.0 1
GetById1 8
(8 9
id9 ;
); <
)< =
;= >!
SuccessNotification
ÄÄ 
(
ÄÄ 
$str
ÄÄ +
)
ÄÄ+ ,
;
ÄÄ, -
return
ÅÅ 
RedirectToAction
ÅÅ 
(
ÅÅ  
$str
ÅÅ  /
)
ÅÅ/ 0
;
ÅÅ0 1
}
ÇÇ 
catch
ÉÉ 
{
ÑÑ 
return
ÖÖ 
View
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 
}
áá 
}
àà 
}ââ í\
LE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\UserController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class 
UserController 
:  !
BaseController" 0
{ 
private 
readonly 
IUserService %
_userService& 2
;2 3
private 
readonly  
IQueryableRepository -
<- .
User. 2
>2 3 
_queryableRepository4 H
;H I
private 
readonly  
IQueryableRepository -
<- .
vwRP_StockCount. =
>= > 
_totalRowsRepository? S
;S T
public 
UserController 
( 
IUserService *
userService+ 6
,6 7 
IQueryableRepository8 L
<L M
UserM Q
>Q R
queryableRepositoryS f
,f g 
IQueryableRepositoryh |
<| }
vwRP_StockCount	} å
>
å ç!
totalRowsRepository
é °
)
° ¢
{ 	
_userService 
= 
userService &
;& ' 
_queryableRepository  
=! "
queryableRepository# 6
;6 7 
_totalRowsRepository  
=! "
totalRowsRepository# 6
;6 7
}   	
["" 	
SecuredOperation""	 
("" 
Roles"" 
=""  !
$str""" /
)""/ 0
]""0 1
public## 
ActionResult## 
	UserIndex## %
(##% &
Int32##& +
?##+ ,
page##- 1
,##1 2
Int32##3 8
?##8 9
rows##: >
)##> ?
{$$ 	
IGrid%% 
<%% 
User%% 
>%% 
col%% 
=%% 
new%% !
Grid%%" &
<%%& '
User%%' +
>%%+ ,
(%%, - 
_queryableRepository%%- A
.%%A B
Table%%B G
.%%G H
OrderByDescending%%H Y
(%%Y Z
x%%Z [
=>%%\ ^
x%%_ `
.%%` a
UserId%%a g
)%%g h
.%%h i
Skip%%i m
(%%m n
(%%n o
page%%o s
-%%t u
$num%%v w
??%%x z
$num%%{ |
)%%| }
*%%~ 
(
%%Ä Å
rows
%%Å Ö
??
%%Ü à
$num
%%â ã
)
%%ã å
)
%%å ç
.
%%ç é
Take
%%é í
(
%%í ì
rows
%%ì ó
??
%%ò ö
$num
%%õ ù
)
%%ù û
.
%%û ü
AsNoTracking
%%ü ´
(
%%´ ¨
)
%%¨ ≠
)
%%≠ Æ
;
%%Æ Ø
col&& 
.&& 
Query&& 
=&& 
new&& 
NameValueCollection&& /
(&&/ 0
Request&&0 7
.&&7 8
QueryString&&8 C
)&&C D
;&&D E
if(( 
((( 
col(( 
.(( 
Query(( 
!=(( 
null(( !
)((! "
{)) 
col** 
=** 
new** 
Grid** 
<** 
User** #
>**# $
(**$ % 
_queryableRepository**% 9
.**9 :
Table**: ?
.**? @
OrderByDescending**@ Q
(**Q R
x**R S
=>**T V
x**W X
.**X Y
UserId**Y _
)**_ `
.**` a
AsNoTracking**a m
(**m n
)**n o
)**o p
;**p q
}++ 
col,, 
.,, 
Columns,, 
.,, 
Add,, 
(,, 
x,, 
=>,,  
$str,,! n
+,,o p
x,,q r
.,,r s
UserId,,s y
+,,z {
$str	,,| Ö
+
,,Ü á
$str--! v
+--w x
x--y z
.--z {
UserId	--{ Å
+
--Ç É
$str
--Ñ ç
)
--ç é
... 
Encoded.. 
(.. 
false.. 
).. 
...  
Titled..  &
(..& '
$str..' 1
)..1 2
...2 3

Filterable..3 =
(..= >
false..> C
)..C D
;..D E
col00 
.00 
Columns00 
.00 
Add00 
(00 
x00 
=>00  
x00! "
.00" #
UserId00# )
)00) *
.00* +
Titled00+ 1
(001 2
$str002 :
)00: ;
.00; <
MultiFilterable00< K
(00K L
true00L P
)00P Q
;00Q R
col22 
.22 
Pager22 
=22 
new22 
	GridPager22 %
<22% &
User22& *
>22* +
(22+ ,
col22, /
)22/ 0
;220 1
col33 
.33 

Processors33 
.33 
Add33 
(33 
col33 "
.33" #
Pager33# (
)33( )
;33) *
col44 
.44 
Pager44 
.44 
RowsPerPage44 !
=44" #
$num44$ &
;44& '
col55 
.55 
	EmptyText55 
=55 
$str55 7
;557 8
foreach66 
(66 
IGridColumn66  
column66! '
in66( *
col66+ .
.66. /
Columns66/ 6
)666 7
{77 
column88 
.88 
IsFilterable88 #
=88$ %
true88& *
;88* +
column99 
.99 

IsSortable99 !
=99" #
true99$ (
;99( )
}:: 
var;; 
total;; 
=;;  
_totalRowsRepository;; ,
.;;, -
Table;;- 2
.;;2 3
AsNoTracking;;3 ?
(;;? @
);;@ A
.;;A B
Where;;B G
(;;G H
x;;H I
=>;;J L
x;;M N
.;;N O
	TableName;;O X
==;;Y [
$str;;\ c
);;c d
.;;d e
Select;;e k
(;;k l
x;;l m
=>;;n p
x;;q r
.;;r s
	TableRows;;s |
);;| }
.;;} ~
First	;;~ É
(
;;É Ñ
)
;;Ñ Ö
;
;;Ö Ü
ViewBag<< 
.<< 
	totalRows<< 
=<< 
Convert<<  '
.<<' (
ToInt32<<( /
(<</ 0
total<<0 5
)<<5 6
;<<6 7
return== 
View== 
(== 
col== 
)== 
;== 
}>> 	
[@@ 	
SecuredOperation@@	 
(@@ 
Roles@@ 
=@@  !
$str@@" /
)@@/ 0
]@@0 1
publicAA 
ActionResultAA 
CreateAA "
(AA" #
)AA# $
{BB 	
varCC 
emptyCC 
=CC 
newCC 
UserViewModelCC )
(CC) *
)CC* +
;CC+ ,
varDD 
dataDD 
=DD 
emptyDD 
.DD 
ToVMDD !
(DD! "
)DD" #
;DD# $
returnEE 
ViewEE 
(EE 
dataEE 
)EE 
;EE 
}FF 	
[HH 	
HttpPostHH	 
]HH 
publicII 
ActionResultII 
CreateII "
(II" #
UserViewModelII# 0
userII1 5
)II5 6
{JJ 	
ifKK 
(KK 
!KK 

ModelStateKK 
.KK 
IsValidKK #
)KK# $
{LL 
ErrorNotificationMM !
(MM! "
$strMM" 5
)MM5 6
;MM6 7
returnNN 
RedirectToActionNN '
(NN' (
$strNN( 0
)NN0 1
;NN1 2
}OO 
_userServicePP 
.PP 
AddPP 
(PP 
newPP  
UserPP! %
{QQ 
}UU 
)UU 
;UU 
SuccessNotificationVV 
(VV  
$strVV  0
)VV0 1
;VV1 2
returnWW 
RedirectToActionWW #
(WW# $
$strWW$ /
)WW/ 0
;WW0 1
}XX 	
[ZZ 	
SecuredOperationZZ	 
(ZZ 
RolesZZ 
=ZZ  !
$strZZ" /
)ZZ/ 0
]ZZ0 1
public[[ 
ActionResult[[ 
Edit[[  
([[  !
int[[! $
id[[% '
)[[' (
{\\ 	
var]] 
data]] 
=]] 
AutoMapperHelper]] '
.]]' (
MapToSameViewModel]]( :
<]]: ;
User]]; ?
,]]? @
UserViewModel]]A N
>]]N O
(]]O P
_userService]]P \
.]]\ ]
GetById]]] d
(]]d e
id]]e g
)]]g h
)]]h i
;]]i j
return^^ 
View^^ 
(^^ 
data^^ 
.^^ 
ToVM^^ !
(^^! "
)^^" #
)^^# $
;^^$ %
}__ 	
[aa 	
HttpPostaa	 
]aa 
publicbb 
ActionResultbb 
Editbb  
(bb  !
Userbb" &
userbb' +
)bb+ ,
{cc 	
trydd 
{ee 
_userServicegg 
.gg 
Updategg #
(gg# $
newgg$ '
Usergg) -
{hh 
}ll 
)ll 
;ll 
SuccessNotificationmm #
(mm# $
$strmm$ 7
)mm7 8
;mm8 9
returnnn 
RedirectToActionnn '
(nn' (
$strnn( 3
)nn3 4
;nn4 5
}oo 
catchpp 
{qq 
returnrr 
Viewrr 
(rr 
)rr 
;rr 
}ss 
}tt 	
[vv 	
SecuredOperationvv	 
(vv 
Rolesvv 
=vv  !
$strvv" /
)vv/ 0
]vv0 1
publicww 
ActionResultww 
Deleteww "
(ww" #
intww# &
idww' )
,ww) *
Userww+ /
userww0 4
)ww4 5
{xx 	
varyy 
datayy 
=yy 
AutoMapperHelperyy '
.yy' (
MapToSameViewModelyy( :
<yy: ;
Useryy; ?
,yy? @
UserViewModelyyA N
>yyN O
(yyO P
_userServiceyyP \
.yy\ ]
GetByIdyy] d
(yyd e
idyye g
)yyg h
)yyh i
;yyi j
returnzz 
Viewzz 
(zz 
datazz 
.zz 
ToVMzz !
(zz! "
)zz" #
)zz# $
;zz$ %
}{{ 	
[}} 	
HttpPost}}	 
]}} 
public~~ 
ActionResult~~ 
Delete~~ "
(~~" #
int~~# &
id~~' )
)~~) *
{ 	
try
ÄÄ 
{
ÅÅ 
_userService
ÇÇ 
.
ÇÇ 
Delete
ÇÇ #
(
ÇÇ# $
_userService
ÇÇ$ 0
.
ÇÇ0 1
GetById
ÇÇ1 8
(
ÇÇ8 9
id
ÇÇ9 ;
)
ÇÇ; <
)
ÇÇ< =
;
ÇÇ= >!
SuccessNotification
ÉÉ #
(
ÉÉ# $
$str
ÉÉ$ 3
)
ÉÉ3 4
;
ÉÉ4 5
return
ÑÑ 
RedirectToAction
ÑÑ '
(
ÑÑ' (
$str
ÑÑ( 3
)
ÑÑ3 4
;
ÑÑ4 5
}
ÖÖ 
catch
ÜÜ 
{
áá 
return
àà 
View
àà 
(
àà 
)
àà 
;
àà 
}
ââ 
}
ää 	
}
ãã 
}åå Œß
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\UserHomeController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
UserHomeController !
:" #
BaseController$ 2
{ 
private 
readonly 
ISaleService !
_saleService" .
;. /
private 
readonly 
IProductService $
_productService% 4
;4 5
private 
readonly 
ICustomerService %
_customerService& 6
;6 7
private 
readonly 
IUserService !
_userService" .
;. /
private   
readonly   
IGiftService   !
_giftService  " .
;  . /
private!! 
readonly!! 
IBuyService!!  
_buyService!!! ,
;!!, -
private"" 
readonly"" 
ICampaignService"" %
_campaignService""& 6
;""6 7
private## 
readonly##  
IQueryableRepository## )
<##) *
Sale##* .
>##. /$
_saleQueryableRepository##0 H
;##H I
private$$ 
readonly$$  
IQueryableRepository$$ )
<$$) *
Product$$* 1
>$$1 2'
_productQueryableRepository$$3 N
;$$N O
private%% 
readonly%%  
IQueryableRepository%% )
<%%) *
Customer%%* 2
>%%2 3(
_customerQueryableRepository%%4 P
;%%P Q
private&& 
readonly&&  
IQueryableRepository&& )
<&&) *
Gift&&* .
>&&. /$
_giftQueryableRepository&&0 H
;&&H I
private'' 
readonly''  
IQueryableRepository'' )
<'') *
Buy''* -
>''- .#
_buyQueryableRepository''/ F
;''F G
private(( 
readonly((  
IQueryableRepository(( )
<(() *
User((* .
>((. /$
_userQueryableRepository((0 H
;((H I
private)) 
readonly))  
IQueryableRepository)) )
<))) *
Campaign))* 2
>))2 3(
_campaignQueryableRepository))4 P
;))P Q
private** 
readonly**  
IQueryableRepository** )
<**) *
Score*** /
>**/ 0&
_scroreQueryableRepository**1 K
;**K L
public++ 

UserHomeController++ 
(++ 
ISaleService++ *
saleService+++ 6
,++6 7
IProductService++8 G
productService++H V
,++V W
ICustomerService++X h
customerService++i x
,++x y
IUserService	++z Ü
userService
++á í
,
++í ì
IGiftService
++î †
giftService
++° ¨
,
++¨ ≠
IBuyService
++Æ π

buyService
++∫ ƒ
,
++ƒ ≈
ICampaignService
++∆ ÷
campaignService
++◊ Ê
,
++Ê Á"
IQueryableRepository
++Ë ¸
<
++¸ ˝
Sale
++˝ Å
>
++Å Ç%
saleQueryableRepository
++É ö
,
++ö õ"
IQueryableRepository
++ú ∞
<
++∞ ±
Product
++± ∏
>
++∏ π(
productQueryableRepository
++∫ ‘
,
++‘ ’"
IQueryableRepository
++÷ Í
<
++Í Î
Customer
++Î Û
>
++Û Ù)
customerQueryableRepository
++ı ê
,
++ê ë"
IQueryableRepository
++í ¶
<
++¶ ß
Gift
++ß ´
>
++´ ¨%
giftQueryableRepository
++≠ ƒ
,
++ƒ ≈"
IQueryableRepository
++∆ ⁄
<
++⁄ €
Buy
++€ ﬁ
>
++ﬁ ﬂ$
buyQueryableRepository
++‡ ˆ
,
++ˆ ˜"
IQueryableRepository
++¯ å
<
++å ç
User
++ç ë
>
++ë í%
userQueryableRepository
++ì ™
,
++™ ´"
IQueryableRepository
++¨ ¿
<
++¿ ¡
Campaign
++¡ …
>
++…  )
campaignQueryableRepository
++À Ê
,
++Ê Á"
IQueryableRepository
++Ë ¸
<
++¸ ˝
Score
++˝ Ç
>
++Ç É'
scroreQueryableRepository
++Ñ ù
)
++ù û
{,, 
_saleService-- 
=-- 
saleService--  
;--  !
_productService.. 
=.. 
productService.. &
;..& '
_customerService// 
=// 
customerService// (
;//( )
_userService00 
=00 
userService00  
;00  !
_giftService11 
=11 
giftService11  
;11  !
_buyService22 
=22 

buyService22 
;22 
_campaignService33 
=33 
campaignService33 (
;33( )'
_productQueryableRepository44 !
=44" #&
productQueryableRepository44$ >
;44> ?(
_customerQueryableRepository55 "
=55# $'
customerQueryableRepository55% @
;55@ A$
_giftQueryableRepository66 
=66  #
giftQueryableRepository66! 8
;668 9#
_buyQueryableRepository77 
=77 "
buyQueryableRepository77  6
;776 7$
_userQueryableRepository88 
=88  #
userQueryableRepository88! 8
;888 9(
_campaignQueryableRepository99 "
=99# $'
campaignQueryableRepository99% @
;99@ A&
_scroreQueryableRepository::  
=::! "%
scroreQueryableRepository::# <
;::< =$
_saleQueryableRepository;; 
=;;  #
saleQueryableRepository;;! 8
;;;8 9
}<< 
public?? 

ActionResult?? 
Index?? 
(?? 
int?? !
id??" $
)??$ %
{@@ 
ifAA 
(AA 	
UserAA	 
.AA 
IdentityAA 
.AA 
IsAuthenticatedAA &
==AA' )
falseAA* /
||AA0 2
GeneralHelpersAA3 A
.AAA B
	GetUserIdAAB K
(AAK L
)AAL M
!=AAM O
idAAO Q
.AAQ R
ToStringAAR Z
(AAZ [
)AA[ \
)AA\ ]
{BB 
returnCC 
RedirectToActionCC 
(CC  
$strCC  )
,CC) *
$strCC+ 4
)CC4 5
;CC5 6
}DD 
ifEE 
(EE	 

GeneralHelpersEE
 
.EE 
	GetUserIdEE "
(EE" #
)EE# $
==EE$ &
nullEE& *
||EE+ -
GeneralHelpersEE. <
.EE< =
	GetUserIdEE= F
(EEF G
)EEG H
==EEH J
$strEEJ L
)EEL M
{FF 
returnGG 
RedirectToActionGG 
(GG 
$strGG '
,GG' (
$strGG) 2
)GG2 3
;GG3 4
}HH 
varII 	
productII
 
=II '
_productQueryableRepositoryII /
.II/ 0
TableII0 5
.II5 6
AsNoTrackingII6 B
(IIB C
)IIC D
.IID E
ToListIIE K
(IIK L
)IIL M
;IIM N
varJJ 	
saleJJ
 
=JJ $
_saleQueryableRepositoryJJ )
.JJ) *
TableJJ* /
.JJ/ 0
AsNoTrackingJJ0 <
(JJ< =
)JJ= >
.JJ> ?
ToListJJ? E
(JJE F
)JJF G
;JJG H
varKK 	
giftKK
 
=KK $
_giftQueryableRepositoryKK )
.KK) *
TableKK* /
.KK/ 0
AsNoTrackingKK0 <
(KK< =
)KK= >
.KK> ?
ToListKK? E
(KKE F
)KKF G
;KKG H
varLL 	
buyGiftLL
 
=LL #
_buyQueryableRepositoryLL +
.LL+ ,
TableLL, 1
.LL1 2
AsNoTrackingLL2 >
(LL> ?
)LL? @
.LL@ A
ToListLLA G
(LLG H
)LLH I
;LLI J
varMM 	
userMM
 
=MM $
_userQueryableRepositoryMM )
.MM) *
TableMM* /
.MM/ 0
AsNoTrackingMM0 <
(MM< =
)MM= >
.MM> ?
ToListMM? E
(MME F
)MMF G
;MMG H
ListNN 

<NN
 
CampaignNN 
>NN 
campaignNN 
=NN (
_campaignQueryableRepositoryNN  <
.NN< =
TableNN= B
.NNB C
AsNoTrackingNNC O
(NNO P
)NNP Q
.NNQ R
ToListNNR X
(NNX Y
)NNY Z
;NNZ [
varOO 	
scoreOO
 
=OO &
_scroreQueryableRepositoryOO ,
.OO, -
TableOO- 2
.OO2 3
AsNoTrackingOO3 ?
(OO? @
)OO@ A
.OOA B
ToListOOB H
(OOH I
)OOI J
;OOJ K
varPP 	
orderPP
 
=PP 
$numPP 
;PP 
varQQ 	
vmQQ
 
=QQ 
newQQ 
	ViewModelQQ 
{RR 
totalWonSS 
=SS 
(SS 
fromSS 
sSS 
inSS 
scoreSS #
selectUU 
newUU 
{VV 
sWW 
.WW 
UserIdWW 
,WW 
sXX 
.XX 

ScoreTotalXX "
}YY 
)YY 
.YY 
WhereYY 
(YY 
pYY 
=>YY !
pYY" #
.YY# $
UserIdYY$ *
==YY+ -
idYY. 0
)YY0 1
.ZZ 
GroupByZZ 
(ZZ 
wZZ 
=>ZZ 
wZZ 
.ZZ 
UserIdZZ $
)ZZ$ %
.[[ 
Select[[ 
([[ 
y[[ 
=>[[ 
new[[ 
ProductPoint[[ +
{\\ 
UserId]] 
=]] 
y]] 
.]] 
Key]] 
,]] 
SumPoint^^ 
=^^ 
y^^ 
.^^ 
Sum^^  
(^^  !
x^^! "
=>^^# %
x^^& '
.^^' (

ScoreTotal^^( 2
)^^2 3
,^^3 4
}`` 
)`` 
.`` 
ToList`` 
(`` 
)`` 
,`` 

spentPointbb 
=bb 
(bb 
frombb 
bbb 
inbb 
buyGiftbb  '
joincc 
gcc 
incc 
giftcc  $
oncc% '
bcc( )
.cc) *
GiftIdcc* 0
equalscc1 7
gcc8 9
.cc9 :
GiftIdcc: @
selectdd 
newdd  
{ee 
bff 
.ff 
UserIdff  
,ff  !
bgg 
.gg 

IsApprovedgg $
,gg$ %
ghh 
.hh 
	GiftPointhh #
}ii 
)ii 
.ii 
Whereii 
(ii 
xii  
=>ii! #
xii$ %
.ii% &
UserIdii& ,
==ii- /
idii0 2
&&ii3 5
xii6 7
.ii7 8

IsApprovedii8 B
==iiC E
trueiiF J
)iiJ K
.jj 
GroupByjj 
(jj 
wjj 
=>jj 
wjj 
.jj 
UserIdjj $
)jj$ %
.kk 
Selectkk 
(kk 
ykk 
=>kk 
newkk 

SpentPointkk )
(kk) *
)kk* +
{ll 
UserIdmm 
=mm 
ymm 
.mm 
Keymm 
,mm 

SpendPointnn 
=nn 
ynn 
.nn 
Sumnn "
(nn" #
xnn# $
=>nn% '
xnn( )
.nn) *
	GiftPointnn* 3
)nn3 4
}oo 
)oo 
.oo 
ToListoo 
(oo 
)oo 
,oo 
saleRankingsqq 
=qq 
(qq 
fromqq 
sqq 
inqq !
saleqq" &
joinrr 
urr 
inrr !
userrr" &
onrr' )
srr* +
.rr+ ,
UserIdrr, 2
equalsrr3 9
urr: ;
.rr; <
UserIdrr< B
selectss 
newss "
{tt 
uuu 
.uu 
UserIduu "
,uu" #
uvv 
.vv 
	FirstNamevv %
,vv% &
uww 
.ww 
LastNameww $
,ww$ %
sxx 
.xx 
AmountOfSalesxx )
,xx) *
syy 
.yy 

IsApprovedyy &
}zz 
)zz 
.zz 
Wherezz  
(zz  !
xzz! "
=>zz# %
xzz& '
.zz' (

IsApprovedzz( 2
==zz3 5
truezz6 :
)zz: ;
.zz; <
GroupByzz< C
(zzC D
xzzD E
=>zzF H
newzzI L
{zzM N
xzzO P
.zzP Q
UserIdzzQ W
,zzW X
xzzY Z
.zzZ [
	FirstNamezz[ d
,zzd e
xzzf g
.zzg h
LastNamezzh p
}zzq r
)zzr s
.{{
 
Select{{ 
({{ 
y{{ 
=>{{ 
new{{ 
SalesRanking{{ '
({{' (
){{( )
{||
 
UserId}} 
=}} 
y}} 
.}} 
Key}} 
.}} 
UserId}} !
,}}! "
	SaleOrder~~ 
=~~ 
order~~ 
+~~ 
$num~~  !
,~~! "
	FirstName 
= 
y 
. 
Key 
. 
	FirstName '
,' (
LastName
ÄÄ 
=
ÄÄ 
y
ÄÄ 
.
ÄÄ 
Key
ÄÄ 
.
ÄÄ 
LastName
ÄÄ %
,
ÄÄ% &
SumSale
ÅÅ 
=
ÅÅ 
y
ÅÅ 
.
ÅÅ 
Sum
ÅÅ 
(
ÅÅ 
x
ÅÅ 
=>
ÅÅ  
x
ÅÅ! "
.
ÅÅ" #
AmountOfSales
ÅÅ# 0
)
ÅÅ0 1
}
ÇÇ
 
)
ÇÇ 
.
ÇÇ 
ToList
ÇÇ 
(
ÇÇ 
)
ÇÇ 
.
ÇÇ 
OrderByDescending
ÇÇ '
(
ÇÇ' (
x
ÇÇ( )
=>
ÇÇ* ,
x
ÇÇ- .
.
ÇÇ. /
SumSale
ÇÇ/ 6
)
ÇÇ6 7
}
ÉÉ 
;
ÉÉ 
decimal
ãã 
	remaining
ãã 
=
ãã 
vm
ãã 
.
ãã 
totalWon
ãã %
.
ãã% &
Sum
ãã& )
(
ãã) *
t
ãã* +
=>
ãã, .
t
ãã/ 0
.
ãã0 1
SumPoint
ãã1 9
)
ãã9 :
-
ãã; <
vm
ãã= ?
.
ãã? @

spentPoint
ãã@ J
.
ããJ K
Sum
ããK N
(
ããN O
s
ããO P
=>
ããQ S
s
ããT U
.
ããU V

SpendPoint
ããV `
)
ãã` a
;
ããa b
decimal
åå 
remainingTomoney
åå 
=
åå  
vm
åå! #
.
åå# $
totalWon
åå$ ,
.
åå, -
Sum
åå- 0
(
åå0 1
t
åå1 2
=>
åå3 5
t
åå6 7
.
åå7 8
SumPointToMoney
åå8 G
)
ååG H
-
ååI J
vm
ååK M
.
ååM N

spentPoint
ååN X
.
ååX Y
Sum
ååY \
(
åå\ ]
s
åå] ^
=>
åå_ a
s
ååb c
.
ååc d
SumPointToMoney
ååd s
)
åås t
;
ååt u
vm
éé 
.
éé 	
remainingScore
éé	 
=
éé 
	remaining
éé #
;
éé# $
vm
èè 
.
èè 	#
remainingScoreToMoney
èè	 
=
èè  
remainingTomoney
èè! 1
;
èè1 2
vm
íí 
.
íí 	
CampaignView
íí	 
=
íí 
campaign
íí  
;
íí  !
var
ïï 	
table
ïï
 
=
ïï 
new
ïï 
	DataTable
ïï 
(
ïï  
)
ïï  !
;
ïï! "
var
ññ 	
dt
ññ
 
=
ññ 
$str
ñô 0
;
ôô0 1
using
öö 
(
öö 
var
öö 
dbx
öö 
=
öö 
new
öö 
BayiPuanContext
öö *
(
öö* +
)
öö+ ,
)
öö, -
{
õõ 
var
úú 
cmd
úú 
=
úú 
dbx
úú 
.
úú 
Database
úú 
.
úú 

Connection
úú )
.
úú) *
CreateCommand
úú* 7
(
úú7 8
)
úú8 9
;
úú9 :
var
ùù 
sql
ùù 
=
ùù 
dt
ùù 
;
ùù 
cmd
ûû 
.
ûû 
CommandText
ûû 
=
ûû 
sql
ûû 
;
ûû 
cmd
üü 
.
üü 

Connection
üü 
.
üü 
Open
üü 
(
üü 
)
üü 
;
üü 
table
†† 
.
†† 
Load
†† 
(
†† 
cmd
†† 
.
†† 
ExecuteReader
†† $
(
††$ %
)
††% &
)
††& '
;
††' (
DataSet
°° 
ds
°° 
=
°° 
new
°° 
DataSet
°°  
(
°°  !
)
°°! "
;
°°" #
ds
¢¢ 

.
¢¢
 
Tables
¢¢ 
.
¢¢ 
Add
¢¢ 
(
¢¢ 
table
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 
DotNet
§§ 
.
§§ 

Highcharts
§§ 
.
§§ 

Highcharts
§§ "
chart
§§# (
=
§§) *
new
§§+ .
DotNet
§§/ 5
.
§§5 6

Highcharts
§§6 @
.
§§@ A

Highcharts
§§A K
(
§§K L
$str
§§L S
)
§§S T
.
•• 	
	InitChart
••	 
(
•• 
new
•• 
Chart
•• 
{
¶¶ 	
DefaultSeriesType
ßß
 
=
ßß 

ChartTypes
ßß (
.
ßß( )
Column
ßß) /
,
ßß/ 0
}
©© 	
)
©©	 

.
™™ 	
SetTitle
™™	 
(
™™ 
new
™™ 
Title
™™ 
{
´´ 	
Text
¨¨
 
=
¨¨ 
$str
¨¨  
}
≠≠ 	
)
≠≠	 

.
ÆÆ 	
SetXAxis
ÆÆ	 
(
ÆÆ 
new
ÆÆ 
XAxis
ÆÆ 
{
ØØ 	

Categories
±±
 
=
±± 
table
±± 
.
±± 
AsEnumerable
±± )
(
±±) *
)
±±* +
.
±±+ ,
Select
±±, 2
(
±±2 3
r
±±3 4
=>
±±5 7
r
±±8 9
.
±±9 :
Field
±±: ?
<
±±? @
string
±±@ F
>
±±F G
(
±±G H
$str
±±H R
)
±±R S
.
±±S T
ToString
±±T \
(
±±\ ]
)
±±] ^
)
±±^ _
.
±±_ `
ToArray
±±` g
(
±±g h
)
±±h i
}
≤≤ 	
)
≤≤	 

.
≥≥ 	
SetYAxis
≥≥	 
(
≥≥ 
new
≥≥ 
YAxis
≥≥ 
{
¥¥ 	
Title
µµ
 
=
µµ 
new
µµ 

YAxisTitle
µµ  
{
µµ! "
Text
µµ# '
=
µµ( )
$str
µµ* @
}
µµA B
,
µµB C
	PlotLines
∂∂
 
=
∂∂ 
new
∂∂ 
[
∂∂ 
]
∂∂ 
{
∑∑
 
new
∏∏ 
YAxisPlotLines
∏∏ 
{
ππ 
Value
∫∫ 
=
∫∫ 
$num
∫∫ 
,
∫∫ 
Width
ªª 
=
ªª 
$num
ªª 
,
ªª 
Color
ºº 
=
ºº 
ColorTranslator
ºº %
.
ºº% &
FromHtml
ºº& .
(
ºº. /
$str
ºº/ 8
)
ºº8 9
}
ΩΩ 
}
ææ
 
}
øø 	
)
øø	 

.
¿¿ 	
	SetSeries
¿¿	 
(
¿¿ 
new
¡¡
 
Series
¡¡ 
[
¡¡ 
]
¡¡ 
{
¡¡ 
new
¬¬ 
Series
¬¬ 
{
√√ 
Name
ƒƒ 
=
ƒƒ 
$str
ƒƒ 1
,
ƒƒ1 2
Data
ƒƒ3 7
=
ƒƒ8 9
new
ƒƒ: =
Data
ƒƒ> B
(
ƒƒB C
table
≈≈ 
.
≈≈ 
AsEnumerable
≈≈ "
(
≈≈" #
)
≈≈# $
.
≈≈$ %
Select
≈≈% +
(
≈≈+ ,
r
≈≈, -
=>
≈≈- /
r
≈≈/ 0
.
≈≈0 1
Field
≈≈1 6
<
≈≈6 7
int
≈≈7 :
>
≈≈: ;
(
≈≈; <
$str
≈≈< C
)
≈≈C D
)
≈≈D E
.
≈≈E F
Cast
≈≈F J
<
≈≈J K
object
≈≈K Q
>
≈≈Q R
(
≈≈R S
)
≈≈S T
.
≈≈T U
ToArray
≈≈U \
(
≈≈\ ]
)
≈≈] ^
)
∆∆ 
}
«« 
}
»»
 
)
…… 	
;
……	 

ViewData
   
[
   
$str
   
]
   
=
   
chart
   
.
    
ToHtmlString
    ,
(
  , -
)
  - .
;
  . /
return
ÀÀ 
View
ÀÀ 
(
ÀÀ 
vm
ÀÀ 
)
ÀÀ 
;
ÀÀ 
}
ÃÃ 
}
ÕÕ 
}ŒŒ ‰f
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\UserRoleController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 
class	 
UserRoleController !
:" #
BaseController$ 2
{ 
private 
readonly 
IUserRoleService %
_userRoleService& 6
;6 7
private 
readonly  
IQueryableRepository )
<) *
UserRole* 2
>2 3 
_queryableRepository4 H
;H I
private 
readonly  
IQueryableRepository )
<) *
vwRP_StockCount* 9
>9 : 
_totalRowsRepository; O
;O P
public 

UserRoleController 
( 
IUserRoleService .
userRoleService/ >
,> ? 
IQueryableRepository@ T
<T U
UserRoleU ]
>] ^
queryableRepository_ r
,r s!
IQueryableRepository	t à
<
à â
vwRP_StockCount
â ò
>
ò ô!
totalRowsRepository
ö ≠
)
≠ Æ
{ 
_userRoleService 
= 
userRoleService (
;( ) 
_queryableRepository 
= 
queryableRepository 0
;0 1 
_totalRowsRepository 
= 
totalRowsRepository 0
;0 1
}   
[!! 
SecuredOperation!! 
(!! 
Roles!! 
=!! 
$str!! +
)!!+ ,
]!!, -
public"" 

ActionResult"" 
UserRoleIndex"" %
(""% &
Int32""& +
?""+ ,
page""- 1
,""1 2
Int32""3 8
?""8 9
rows"": >
)""> ?
{## 
IGrid$$ 
<$$ 
UserRole$$ 
>$$ 
col$$ 
=$$ 
new$$ 
Grid$$  $
<$$$ %
UserRole$$% -
>$$- .
($$. / 
_queryableRepository$$/ C
.$$C D
Table$$D I
.$$I J
Include$$J Q
($$Q R
$str$$R X
)$$X Y
.$$Y Z
Include$$Z a
($$a b
$str$$b h
)$$h i
.$$i j
OrderByDescending$$j {
($${ |
x$$| }
=>	$$~ Ä
x
$$Å Ç
.
$$Ç É
RoleId
$$É â
)
$$â ä
.
$$ä ã
Skip
$$ã è
(
$$è ê
(
$$ê ë
page
$$ë ï
-
$$ñ ó
$num
$$ò ô
??
$$ö ú
$num
$$ù û
)
$$û ü
*
$$† °
(
$$¢ £
rows
$$£ ß
??
$$® ™
$num
$$´ ≠
)
$$≠ Æ
)
$$Æ Ø
.
$$Ø ∞
Take
$$∞ ¥
(
$$¥ µ
rows
$$µ π
??
$$∫ º
$num
$$Ω ø
)
$$ø ¿
.
$$¿ ¡
AsNoTracking
$$¡ Õ
(
$$Õ Œ
)
$$Œ œ
)
$$œ –
;
$$– —
col%% 	
.%%	 

Query%%
 
=%% 
new%% 
NameValueCollection%% )
(%%) *
Request%%* 1
.%%1 2
QueryString%%2 =
)%%= >
;%%> ?
if'' 
(''	 

col''
 
.'' 
Query'' 
!='' 
null'' 
)'' 
{(( 
col)) 
=)) 
new)) 
Grid)) 
<)) 
UserRole)) 
>))  
())  ! 
_queryableRepository))! 5
.))5 6
Table))6 ;
.)); <
Include))< C
())C D
$str))D J
)))J K
.))K L
Include))L S
())S T
$str))T Z
)))Z [
.))[ \
OrderByDescending))\ m
())m n
x))n o
=>))p r
x))s t
.))t u
RoleId))u {
))){ |
.))| }
AsNoTracking	))} â
(
))â ä
)
))ä ã
)
))ã å
;
))å ç
}** 
col++ 	
.++	 

Columns++
 
.++ 
Add++ 
(++ 
x++ 
=>++ 
$str++ h
+++i j
x++k l
.++l m
RoleId++m s
+++t u
$str++v 
+
++Ä Å
$str,, p
+,,q r
x,,s t
.,,t u
RoleId,,u {
+,,| }
$str	,,~ á
)
,,á à
.-- 	
Encoded--	 
(-- 
false-- 
)-- 
.-- 
Titled-- 
(-- 
$str-- )
)--) *
.--* +

Filterable--+ 5
(--5 6
false--6 ;
)--; <
;--< =
col// 	
.//	 

Columns//
 
.// 
Add// 
(// 
x// 
=>// 
x// 
.// 
User// !
.//! "
UserName//" *
)//* +
.//+ ,
Titled//, 2
(//2 3
$str//3 >
)//> ?
;//? @
col00 	
.00	 

Columns00
 
.00 
Add00 
(00 
x00 
=>00 
x00 
.00 
Role00 !
.00! "
RoleName00" *
)00* +
.00+ ,
Titled00, 2
(002 3
$str003 8
)008 9
;009 :
col22 	
.22	 

Pager22
 
=22 
new22 
	GridPager22 
<22  
UserRole22  (
>22( )
(22) *
col22* -
)22- .
;22. /
col33 	
.33	 


Processors33
 
.33 
Add33 
(33 
col33 
.33 
Pager33 "
)33" #
;33# $
col44 	
.44	 

Pager44
 
.44 
RowsPerPage44 
=44 
$num44  
;44  !
col55 	
.55	 

	EmptyText55
 
=55 
$str55 1
;551 2
foreach66 
(66 
IGridColumn66 
column66 !
in66" $
col66% (
.66( )
Columns66) 0
)660 1
{77 
column88 
.88 
IsFilterable88 
=88 
true88 "
;88" #
column99 
.99 

IsSortable99 
=99 
true99  
;99  !
}:: 
var;; 	
total;;
 
=;;  
_totalRowsRepository;; &
.;;& '
Table;;' ,
.;;, -
AsNoTracking;;- 9
(;;9 :
);;: ;
.;;; <
Where;;< A
(;;A B
x;;B C
=>;;D F
x;;G H
.;;H I
	TableName;;I R
==;;S U
$str;;V a
);;a b
.;;b c
Select;;c i
(;;i j
x;;j k
=>;;l n
x;;o p
.;;p q
	TableRows;;q z
);;z {
.;;{ |
First	;;| Å
(
;;Å Ç
)
;;Ç É
;
;;É Ñ
ViewBag<< 
.<< 
	totalRows<< 
=<< 
Convert<< !
.<<! "
ToInt32<<" )
(<<) *
total<<* /
)<</ 0
;<<0 1
return== 
View== 
(== 
col== 
)== 
;== 
}>> 
[@@ 
SecuredOperation@@ 
(@@ 
Roles@@ 
=@@ 
$str@@ +
)@@+ ,
]@@, -
publicAA 

ActionResultAA 
CreateAA 
(AA 
)AA  
{BB 
varCC 	
emptyCC
 
=CC 
newCC 
UserRoleViewModelCC '
(CC' (
)CC( )
;CC) *
varEE 	
dataEE
 
=EE 
emptyEE 
.EE 
ToVMEE 
(EE 
)EE 
;EE 
returnGG 
ViewGG 
(GG 
dataGG 
)GG 
;GG 
}HH 
[KK 
HttpPostKK 
]KK 
publicLL 

ActionResultLL 
CreateLL 
(LL 
UserRoleViewModelLL 0
userroleLL1 9
)LL9 :
{MM 
ifNN 
(NN	 

!NN
 

ModelStateNN 
.NN 
IsValidNN 
)NN 
{OO 
ErrorNotificationPP 
(PP 
$strPP -
)PP- .
;PP. /
returnQQ 
RedirectToActionQQ 
(QQ  
$strQQ  (
)QQ( )
;QQ) *
}RR 
_userRoleServiceSS 
.SS 
AddSS 
(SS 
newSS 
UserRoleSS '
{TT 
UserIdUU 
=UU 
userroleUU 
.UU 
UserIdUU  
,UU  !
RoleIdVV 
=VV 
userroleVV 
.VV 
RoleIdVV  
}XX 
)XX 
;XX 	
SuccessNotificationYY 
(YY 
$strYY *
)YY* +
;YY+ ,
returnZZ 
RedirectToActionZZ 
(ZZ 
$strZZ &
)ZZ& '
;ZZ' (
}\\ 
[^^ 
SecuredOperation^^ 
(^^ 
Roles^^ 
=^^ 
$str^^ +
)^^+ ,
]^^, -
public__ 

ActionResult__ 
Edit__ 
(__ 
int__  
id__! #
)__# $
{`` 
varaa 	
dataaa
 
=aa 
AutoMapperHelperaa !
.aa! "
MapToSameViewModelaa" 4
<aa4 5
UserRoleaa5 =
,aa= >
UserRoleViewModelaa? P
>aaP Q
(aaQ R
_userRoleServiceaaR b
.aab c
GetByIdaac j
(aaj k
idaak m
)aam n
)aan o
;aao p
returnbb 
Viewbb 
(bb 
databb 
.bb 
ToVMbb 
(bb 
)bb 
)bb 
;bb 
}cc 
[ff 
HttpPostff 
]ff 
publicgg 

ActionResultgg 
Editgg 
(gg 
UserRoleViewModelgg .
userrolegg/ 7
)gg7 8
{hh 
tryii 	
{jj 
_userRoleServicell 
.ll 
Updatell 
(ll  
newll  #
UserRolell$ ,
{mm 	
UserIdnn
 
=nn 
userrolenn 
.nn 
UserIdnn "
,nn" #
RoleIdoo
 
=oo 
userroleoo 
.oo 
RoleIdoo "
,oo" #

UserRoleIdpp
 
=pp 
userrolepp 
.pp  

UserRoleIdpp  *
}qq 	
)qq	 

;qq
 
SuccessNotificationrr 
(rr 
$strrr /
)rr/ 0
;rr0 1
returnss 
RedirectToActionss 
(ss  
$strss  /
)ss/ 0
;ss0 1
}tt 
catchuu 
{vv 
returnww 
Viewww 
(ww 
)ww 
;ww 
}xx 
}yy 
[|| 
SecuredOperation|| 
(|| 
Roles|| 
=|| 
$str|| +
)||+ ,
]||, -
public}} 

ActionResult}} 
Delete}} 
(}} 
int}} "
id}}# %
,}}% &
UserRoleViewModel}}' 8
userrole}}9 A
)}}A B
{~~ 
var 	
data
 
= 
AutoMapperHelper !
.! "
MapToSameViewModel" 4
<4 5
UserRole5 =
,= >
UserRoleViewModel? P
>P Q
(Q R
_userRoleServiceR b
.b c
GetByIdc j
(j k
idk m
)m n
)n o
;o p
return
ÅÅ 
View
ÅÅ 
(
ÅÅ 
data
ÅÅ 
.
ÅÅ 
ToVM
ÅÅ 
(
ÅÅ 
)
ÅÅ 
)
ÅÅ 
;
ÅÅ 
}
ÇÇ 
[
ÖÖ 
HttpPost
ÖÖ 
]
ÖÖ 
public
ÜÜ 

ActionResult
ÜÜ 
Delete
ÜÜ 
(
ÜÜ 
int
ÜÜ "
id
ÜÜ# %
)
ÜÜ% &
{
áá 
try
àà 	
{
ââ 
_userRoleService
ãã 
.
ãã 
Delete
ãã 
(
ãã  
_userRoleService
ãã  0
.
ãã0 1
GetById
ãã1 8
(
ãã8 9
id
ãã9 ;
)
ãã; <
)
ãã< =
;
ãã= >!
SuccessNotification
åå 
(
åå 
$str
åå +
)
åå+ ,
;
åå, -
return
éé 
RedirectToAction
éé 
(
éé  
$str
éé  /
)
éé/ 0
;
éé0 1
}
èè 
catch
êê 
{
ëë 
return
íí 
View
íí 
(
íí 
)
íí 
;
íí 
}
ìì 
}
îî 
}
ïï 
}ññ À]
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Controllers\UserTypeController.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Controllers '
{ 
[ 
AuthorizationFilter 
] 
public 

class 
UserTypeController #
:$ %
BaseController& 4
{ 
private 
readonly 
IUserTypeService )
_userTypeService* :
;: ;
private 
readonly  
IQueryableRepository -
<- .
UserType. 6
>6 7 
_queryableRepository8 L
;L M
private 
readonly  
IQueryableRepository -
<- .
vwRP_StockCount. =
>= > 
_totalRowsRepository? S
;S T
public 
UserTypeController !
(! "
IUserTypeService" 2
userTypeService3 B
,B C 
IQueryableRepositoryD X
<X Y
UserTypeY a
>a b
queryableRepositoryc v
,v w!
IQueryableRepository	x å
<
å ç
vwRP_StockCount
ç ú
>
ú ù!
totalRowsRepository
û ±
)
± ≤
{ 	
_userTypeService 
= 
userTypeService .
;. / 
_queryableRepository  
=! "
queryableRepository# 6
;6 7 
_totalRowsRepository  
=! "
totalRowsRepository# 6
;6 7
}   	
[## 	
SecuredOperation##	 
(## 
Roles## 
=##  !
$str##" 5
)##5 6
]##6 7
public$$ 
ActionResult$$ 
UserTypeIndex$$ )
($$) *
Int32$$* /
?$$/ 0
page$$1 5
,$$5 6
Int32$$7 <
?$$< =
rows$$> B
)$$B C
{%% 	
IGrid&& 
<&& 
UserType&& 
>&& 
col&& 
=&&  !
new&&" %
Grid&&& *
<&&* +
UserType&&+ 3
>&&3 4
(&&4 5 
_queryableRepository&&5 I
.&&I J
Table&&J O
.&&O P
OrderByDescending&&P a
(&&a b
x&&b c
=>&&d f
x&&g h
.&&h i

UserTypeId&&i s
)&&s t
.&&t u
Skip&&u y
(&&y z
(&&z {
page&&{ 
-
&&Ä Å
$num
&&Ç É
??
&&Ñ Ü
$num
&&á à
)
&&à â
*
&&ä ã
(
&&å ç
rows
&&ç ë
??
&&í î
$num
&&ï ó
)
&&ó ò
)
&&ò ô
.
&&ô ö
Take
&&ö û
(
&&û ü
rows
&&ü £
??
&&§ ¶
$num
&&ß ©
)
&&© ™
.
&&™ ´
AsNoTracking
&&´ ∑
(
&&∑ ∏
)
&&∏ π
)
&&π ∫
;
&&∫ ª
col'' 
.'' 
Query'' 
='' 
new'' 
NameValueCollection'' /
(''/ 0
Request''0 7
.''7 8
QueryString''8 C
)''C D
;''D E
if)) 
()) 
col)) 
.)) 
Query)) 
!=)) 
null)) !
)))! "
{** 
col++ 
=++ 
new++ 
Grid++ 
<++ 
UserType++ '
>++' (
(++( ) 
_queryableRepository++) =
.++= >
Table++> C
.++C D
OrderByDescending++D U
(++U V
x++V W
=>++X Z
x++[ \
.++\ ]

UserTypeId++] g
)++g h
.++h i
AsNoTracking++i u
(++u v
)++v w
)++w x
;++x y
},, 
col-- 
.-- 
Columns-- 
.-- 
Add-- 
(-- 
x-- 
=>--  
$str--! n
+--o p
x--q r
.--r s

UserTypeId--s }
+--~ 
$str
--Ä â
+
--ä ã
$str..! v
+..w x
x..y z
...z {

UserTypeId	..{ Ö
+
..Ü á
$str
..à ë
)
..ë í
.// 
Encoded// 
(// 
false// 
)// 
.//  
Titled//  &
(//& '
$str//' 1
)//1 2
.//2 3

Filterable//3 =
(//= >
false//> C
)//C D
;//D E
col11 
.11 
Columns11 
.11 
Add11 
(11 
x11 
=>11  
x11! "
.11" #

UserTypeId11# -
)11- .
.11. /
Titled11/ 5
(115 6
$str116 B
)11B C
.11C D
MultiFilterable11D S
(11S T
true11T X
)11X Y
;11Y Z
col33 
.33 
Pager33 
=33 
new33 
	GridPager33 %
<33% &
UserType33& .
>33. /
(33/ 0
col330 3
)333 4
;334 5
col44 
.44 

Processors44 
.44 
Add44 
(44 
col44 "
.44" #
Pager44# (
)44( )
;44) *
col55 
.55 
Pager55 
.55 
RowsPerPage55 !
=55" #
$num55$ &
;55& '
col66 
.66 
	EmptyText66 
=66 
$str66 7
;667 8
foreach77 
(77 
IGridColumn77  
column77! '
in77( *
col77+ .
.77. /
Columns77/ 6
)776 7
{88 
column99 
.99 
IsFilterable99 #
=99$ %
true99& *
;99* +
column:: 
.:: 

IsSortable:: !
=::" #
true::$ (
;::( )
};; 
var<< 
total<< 
=<<  
_totalRowsRepository<< ,
.<<, -
Table<<- 2
.<<2 3
AsNoTracking<<3 ?
(<<? @
)<<@ A
.<<A B
Where<<B G
(<<G H
x<<H I
=><<J L
x<<M N
.<<N O
	TableName<<O X
==<<Y [
$str<<\ g
)<<g h
.<<h i
Select<<i o
(<<o p
x<<p q
=><<r t
x<<u v
.<<v w
	TableRows	<<w Ä
)
<<Ä Å
.
<<Å Ç
First
<<Ç á
(
<<á à
)
<<à â
;
<<â ä
ViewBag== 
.== 
	totalRows== 
=== 
Convert==  '
.==' (
ToInt32==( /
(==/ 0
total==0 5
)==5 6
;==6 7
return>> 
View>> 
(>> 
col>> 
)>> 
;>> 
}?? 	
[AA 	
SecuredOperationAA	 
(AA 
RolesAA 
=AA  !
$strAA" 5
)AA5 6
]AA6 7
publicBB 
ActionResultBB 
CreateBB "
(BB" #
)BB# $
{CC 	
varDD 
emptyDD 
=DD 
newDD 
UserTypeViewModelDD -
(DD- .
)DD. /
;DD/ 0
varEE 
dataEE 
=EE 
emptyEE 
.EE 
ToVMEE !
(EE! "
)EE" #
;EE# $
returnFF 
ViewFF 
(FF 
dataFF 
)FF 
;FF 
}GG 	
[II 	
HttpPostII	 
]II 
publicJJ 
ActionResultJJ 
CreateJJ "
(JJ" #
UserTypeViewModelJJ# 4
userTypeJJ5 =
)JJ= >
{KK 	
ifLL 
(LL 
!LL 

ModelStateLL 
.LL 
IsValidLL #
)LL# $
{MM 
ErrorNotificationNN !
(NN! "
$strNN" 5
)NN5 6
;NN6 7
returnOO 
RedirectToActionOO '
(OO' (
$strOO( 0
)OO0 1
;OO1 2
}PP 
_userTypeServiceQQ 
.QQ 
AddQQ  
(QQ  !
newQQ! $
UserTypeQQ% -
{RR 
}VV 
)VV 
;VV 
SuccessNotificationWW 
(WW  
$strWW  0
)WW0 1
;WW1 2
returnXX 
RedirectToActionXX #
(XX# $
$strXX$ 3
)XX3 4
;XX4 5
}YY 	
[[[ 	
SecuredOperation[[	 
([[ 
Roles[[ 
=[[  !
$str[[" 5
)[[5 6
][[6 7
public\\ 
ActionResult\\ 
Edit\\  
(\\  !
int\\! $
id\\% '
)\\' (
{]] 	
var^^ 
data^^ 
=^^ 
AutoMapperHelper^^ '
.^^' (
MapToSameViewModel^^( :
<^^: ;
UserType^^; C
,^^C D
UserTypeViewModel^^E V
>^^V W
(^^W X
_userTypeService^^X h
.^^h i
GetById^^i p
(^^p q
id^^q s
)^^s t
)^^t u
;^^u v
return__ 
View__ 
(__ 
data__ 
.__ 
ToVM__ !
(__! "
)__" #
)__# $
;__$ %
}`` 	
[bb 	
HttpPostbb	 
]bb 
publiccc 
ActionResultcc 
Editcc  
(cc  !
UserTypecc" *
userTypecc+ 3
)cc3 4
{dd 	
tryee 
{ff 
_userTypeServicehh  
.hh  !
Updatehh! '
(hh' (
newhh( +
UserTypehh- 5
{ii 
}mm 
)mm 
;mm 
SuccessNotificationnn #
(nn# $
$strnn$ 7
)nn7 8
;nn8 9
returnoo 
RedirectToActionoo '
(oo' (
$stroo( 7
)oo7 8
;oo8 9
}pp 
catchqq 
{rr 
returnss 
Viewss 
(ss 
)ss 
;ss 
}tt 
}uu 	
[ww 	
SecuredOperationww	 
(ww 
Rolesww 
=ww  !
$strww" /
)ww/ 0
]ww0 1
publicxx 
ActionResultxx 
Deletexx "
(xx" #
intxx# &
idxx' )
,xx) *
UserTypexx+ 3
userTypexx4 <
)xx< =
{yy 	
varzz 
datazz 
=zz 
AutoMapperHelperzz '
.zz' (
MapToSameViewModelzz( :
<zz: ;
UserTypezz; C
,zzC D
UserTypeViewModelzzE V
>zzV W
(zzW X
_userTypeServicezzX h
.zzh i
GetByIdzzi p
(zzp q
idzzq s
)zzs t
)zzt u
;zzu v
return{{ 
View{{ 
({{ 
data{{ 
.{{ 
ToVM{{ !
({{! "
){{" #
){{# $
;{{$ %
}|| 	
[~~ 	
HttpPost~~	 
]~~ 
public 
ActionResult 
Delete "
(" #
int# &
id' )
)) *
{
ÄÄ 	
try
ÅÅ 
{
ÇÇ 
_userTypeService
ÉÉ  
.
ÉÉ  !
Delete
ÉÉ! '
(
ÉÉ' (
_userTypeService
ÉÉ( 8
.
ÉÉ8 9
GetById
ÉÉ9 @
(
ÉÉ@ A
id
ÉÉA C
)
ÉÉC D
)
ÉÉD E
;
ÉÉE F!
SuccessNotification
ÑÑ #
(
ÑÑ# $
$str
ÑÑ$ 3
)
ÑÑ3 4
;
ÑÑ4 5
return
ÖÖ 
RedirectToAction
ÖÖ '
(
ÖÖ' (
$str
ÖÖ( 7
)
ÖÖ7 8
;
ÖÖ8 9
}
ÜÜ 
catch
áá 
{
àà 
return
ââ 
View
ââ 
(
ââ 
)
ââ 
;
ââ 
}
ää 
}
ãã 	
}
åå 
}çç Á
ME:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Filters\AuthorizationFilter.cs
	namespace

 	
BayiPuan


 
.

 
MvcWebUi

 
.

 
Filters

 #
{ 
public 
class	 
AuthorizationFilter "
:# $
FilterAttribute% 4
,4 5 
IAuthorizationFilter6 J
{ 
public 

void 
OnAuthorization 
(   
AuthorizationContext  4
filterContext5 B
)B C
{ 
try 	
{ 
var 

authCookie 
= 
HttpContext $
.$ %
Current% ,
., -
Request- 4
.4 5
Cookies5 <
[< =
FormsAuthentication= P
.P Q
FormsCookieNameQ `
]` a
;a b
var 
	encTicket 
= 

authCookie "
?" #
.# $
Value$ )
;) *
if 

( 
String 
. 
IsNullOrEmpty  
(  !
	encTicket! *
)* +
)+ ,
{ 	
filterContext
 
. 
Result 
=  
new! $!
RedirectToRouteResult% :
(: ;
new  
RouteValueDictionary $
{% &
{' (
$str) 5
,5 6
$str7 @
}A B
,B C
{ 
$str 
, 
$str "
}# $
} 
) 
; 
return
 
; 
} 	
var 
ticket 
= 
FormsAuthentication (
.( )
Decrypt) 0
(0 1
	encTicket1 :
): ;
;; <
var   
securityUtilities   
=   
new    #
SecurityUtilities  $ 5
(  5 6
)  6 7
;  7 8
var!! 
identity!! 
=!! 
securityUtilities!! (
.!!( )%
FormsAuthTicketToIdentity!!) B
(!!B C
ticket!!C I
)!!I J
;!!J K
var"" 
	principal"" 
="" 
new"" 
GenericPrincipal"" ,
("", -
identity""- 5
,""5 6
identity""7 ?
.""? @
Roles""@ E
)""E F
;""F G
HttpContext## 
.## 
Current## 
.## 
User##  
=##! "
	principal### ,
;##, -
Thread$$ 
.$$ 
CurrentPrincipal$$ 
=$$  !
	principal$$" +
;$$+ ,
}%% 
catch&& 
(&& 
	Exception&& 
)&& 
{'' 
})) 
}** 
}++ 
},, æ
IE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Filters\ExceptionFilter.cs
	namespace		 	
BayiPuan		
 
.		 
MvcWebUi		 
.		 
Filters		 #
{

 
public 
class	 
ExceptionFilter 
:  !
ActionFilterAttribute! 6
,6 7
IExceptionFilter8 H
{ 
public 

void 
OnException 
( 
ExceptionContext ,
filterContext- :
): ;
{ 
filterContext 
. 
ExceptionHandled $
=% &
true' +
;+ ,
if 
(	 

filterContext
 
. 
	Exception !
is" $!
NotificationException% :
): ;
{ 
filterContext 
. 
Result 
= 
new "

ViewResult# -
{ 	
TempData
 
= 
new 
TempDataDictionary +
{
 
{ 
$" *
NewGenFramework.notifications. -
{- .

NotifyType. 8
.8 9
Error9 >
}> ?
"? @
,@ A
filterContextA N
.N O
	ExceptionO X
.X Y
MessageY `
}a b
}
 
} 	
;	 

} 
else 

{ 
filterContext 
. 
Result 
= 
new "

ViewResult# -
(- .
). /
{ 	
ViewName
 
= 
$str "
," #
ViewData  
 
=   
new   
ViewDataDictionary   +
(  + ,
filterContext  , 9
.  9 :
	Exception  : C
)  C D
}!! 	
;!!	 

}"" 
}$$ 
}%% 
}&& ï
FE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\ColumnMeta.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 
class 

ColumnMeta 
{		 
public

 
PropertyInfo

	 
Property

 
{

  
get

! $
;

$ %
private

& -
set

. 1
;

1 2
}

3 4
public 
DisplayAttribute	 
Display !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
bool	 
Required 
{ 
get 
; 
internal &
set' *
;* +
}, -
public 
Type	 
	InnerType 
{ 
get 
; 
internal '
set( +
;+ ,
}- .
public 
	TableMeta	 
PrimaryTable 
{  !
get" %
;% &
internal' /
set0 3
;3 4
}5 6
public 
DataTypeAttribute	 
DataType #
{$ %
get& )
;) *
internal+ 3
set4 7
;7 8
}9 :
public 
bool	 
	IsVisible 
{ 
get 
; 
internal '
set( +
;+ ,
}- .
=/ 0
true1 5
;5 6
public 

bool 

IsReadonly 
{ 
get  
;  !
internal" *
set+ .
;. /
}0 1
public 
UIHintAttribute	 
UIHint 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string	 
Template 
{ 
get 
; 
set  #
;# $
}% &
public 
List	 
< 
ListItem 
> 
ManualLookup $
{% &
get' *
;* +
private, 3
set4 7
;7 8
}9 :
public 

bool 
	NotMapped 
{ 
get 
;  
set! $
;$ %
}& '
public 


ColumnMeta 
ParentColumn "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 

ColumnMeta	 
( 
PropertyInfo  
property! )
)) *
{ 
Property 
= 
property 
; 
}   
public"" 
void""	 
SetManualLookup"" 
("" 
List"" "
<""" #
ListItem""# +
>""+ ,
items""- 2
)""2 3
{## 
ManualLookup$$ 
=$$ 
items$$ 
;$$ 
Template%% 
=%% 
$str%% 
;%% 
}&& 
public(( 	
override((
 
string(( 
ToString(( "
(((" #
)((# $
{)) 
return** 
Property** 
.** 
Name** 
;** 
}++ 
},, 
}-- ∫π
JE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\CrudExtensions.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 
static 
class 
CrudExtensions #
{ 
private 	
static
  
ConcurrentDictionary %
<% &
Type& *
,* +
	TableMeta, 5
>5 6

_metaCache7 A
=B C
new  
ConcurrentDictionary 
< 
Type !
,! "
	TableMeta# ,
>, -
(- .
). /
;/ 0
private 	
static
 

Dictionary 
< 
string "
," #
	TableMeta$ -
>- .
_metaCacheByName/ ?
=@ A
new 

Dictionary 
< 
string 
, 
	TableMeta #
># $
($ %
)% &
;& '
public 
static	 
IDictionary 
< 
string "
," #
object$ *
>* +
	ToDynamic, 5
(5 6
this6 :
object; A
valueB G
)G H
{ 
IDictionary 
< 
string 
, 
object 
> 
expando &
=' (
new) ,
ExpandoObject- :
(: ;
); <
;< =
foreach 

( 
PropertyDescriptor 
property '
in( *
TypeDescriptor+ 9
.9 :
GetProperties: G
(G H
valueH M
.M N
GetTypeN U
(U V
)V W
)W X
)X Y
expando 
. 
Add 
( 
property 
. 
Name 
, 
property '
.' (
GetValue( 0
(0 1
value1 6
)6 7
)7 8
;8 9
expando 

.
 
Add 
( 
$str 
, 
value 
. 
GetType %
(% &
)& '
)' (
;( )
return 	
expando
 
; 
} 
public   
static  	 
void   
ResolveFkAttributes   (
(  ( )
Type  ) -
foreignType  . 9
,  9 :

ColumnMeta  ; E
fkColumn  F N
)  N O
{!! 
var"" 
foreignMeta"" 
="" 

_metaCache"" 
.""  
GetOrAdd""  (
(""( )
foreignType"") 4
,""4 5
AddMeta""6 =
)""= >
;""> ?
fkColumn## 
.## 
PrimaryTable## 
=## 
foreignMeta## &
;##& '
fkColumn$$ 
.$$ 
Template$$ 
=$$ 
$str$$ 
;$$  
}%% 
private'' 	
static''
 

Dictionary'' 
<'' 
Type''  
,''  !
DataType''" *
>''* +
_type2dt'', 4
=''5 6
new''7 :

Dictionary''; E
<''E F
Type''F J
,''J K
DataType''L T
>''T U
{(( 
{)) 
typeof)) 
()) 
string)) 
))) 
,)) 
DataType)) 
.)) 
Text)) "
}))# $
,))$ %
{** 
typeof** 
(** 
DateTime** 
)** 
,** 
DataType** 
.**  
DateTime**  (
}**) *
}++ 
;++ 
class-- 
OrderComparer-- 
:-- 
	IComparer-- !
<--! "

ColumnMeta--" ,
>--, -
{.. 
public// 	
int//
 
Compare// 
(// 

ColumnMeta//  
x//! "
,//" #

ColumnMeta//$ .
y/// 0
)//0 1
{00 
var11 
xo11 

=11 
x11 
?11 
.11 
Display11 
.11 
GetOrder11  
(11  !
)11! "
??11# %
$num11& '
;11' (
var22 
yo22 

=22 
y22 
?22 
.22 
Display22 
.22 
GetOrder22  
(22  !
)22! "
??22# %
$num22& '
;22' (
if33 
(33 
xo33 

<33 
yo33 
)33 
return33 
-33 
$num33 
;33 
if44 
(44 
xo44 

>44 
yo44 
)44 
return44 
$num44 
;44 
return55 

$num55 
;55 
}66 
}77 
private99 	
static99
 
OrderComparer99 
defaultComparer99 .
=99/ 0
new991 4
OrderComparer995 B
(99B C
)99C D
;99D E
public;; 
static;;	 
	TableMeta;; 
Register;; "
<;;" #
T;;# $
>;;$ %
(;;% &
);;& '
{<< 
var== 
meta== 
=== 

_metaCache== 
.== 
GetOrAdd== !
(==! "
typeof==" (
(==( )
T==) *
)==* +
,==+ ,
AddMeta==- 4
)==4 5
;==5 6
return>> 	
meta>>
 
;>> 
}?? 
private@@ 	
static@@
 
	TableMeta@@ 
AddMeta@@ "
(@@" #
Type@@# '
_type@@( -
)@@- .
{AA 
varBB 
tmBB 	
=BB
 
newBB 
	TableMetaBB 
(BB 
)BB 
;BB 
tmDD 
.DD 
CaptionDD 
=DD 
_typeDD 
.DD 
GetCustomAttributeDD (
<DD( ) 
DisplayNameAttributeDD) =
>DD= >
(DD> ?
)DD? @
;DD@ A
tmEE 
.EE 
DisplayColumnEE 
=EE 
_typeEE 
.EE 
GetCustomAttributeEE .
<EE. /"
DisplayColumnAttributeEE/ E
>EEE F
(EEF G
)EEG H
;EEH I
tmFF 
.FF 
ActualTableNameFF 
=FF 
_typeFF 
.FF 
GetCustomAttributeFF 0
<FF0 1
TableAttributeFF1 ?
>FF? @
(FF@ A
)FFA B
?FFB C
.FFC D
NameFFD H
??FFI K
_typeFFL Q
.FFQ R
NameFFR V
;FFV W
ListHH 
<HH 
PropertyInfoHH 
>HH 
ShowColumnsHH !
=HH" #
newHH$ '
ListHH( ,
<HH, -
PropertyInfoHH- 9
>HH9 :
(HH: ;
)HH; <
;HH< =
PropertyInfoII 
[II 
]II 
columnsII 
=II 
_typeII !
.II! "
GetPropertiesII" /
(II/ 0
)II0 1
;II1 2

ColumnMetaJJ 
actualMasterJJ 
=JJ 
nullJJ  $
;JJ$ %
foreachLL 

(LL 
varLL 
colLL 
inLL 
columnsLL 
)LL 
{MM 
varNN 
colMetaNN 
=NN 
newNN 

ColumnMetaNN  
(NN  !
colNN! $
)NN$ %
;NN% &
tmOO 
.OO 
AddOO 

(OO
 
colMetaOO 
)OO 
;OO 
}PP 
varRR 

removeListRR 
=RR 
newRR 
ListRR 
<RR 

ColumnMetaRR '
>RR' (
(RR( )
)RR) *
;RR* +
foreachTT 

(TT 
varTT 
colMetaTT 
inTT 
tmTT 
.TT 
ColumnsTT %
)TT% &
{UU 
varVV 
colVV 
=VV 
colMetaVV 
.VV 
PropertyVV 
;VV 
varWW 

skipColumnWW 
=WW 
falseWW 
;WW 
foreachXX 
(XX 
varXX 
attrXX 
inXX 
colXX 
.XX 
GetCustomAttributesXX 0
(XX0 1
)XX1 2
)XX2 3
{YY 
ifZZ 
(ZZ 	
attrZZ	 
isZZ 
KeyAttributeZZ 
)ZZ 
{[[ 
tm\\ 
.\\ 	
PrimaryColumn\\	 
=\\ 
col\\ 
;\\ 
}]] 
else^^ 	
if^^
 
(^^ 
attr^^ 
is^^ 
DisplayAttribute^^ &
)^^& '
{__ 
colMeta`` 
.`` 
Display`` 
=`` 
attr`` 
as`` 
DisplayAttribute``  0
;``0 1
}aa 
elsebb 	
ifbb
 
(bb 
attrbb 
isbb 
RequiredAttributebb '
)bb' (
{cc 
colMetadd 
.dd 
Requireddd 
=dd 
truedd 
;dd 
}ee 
elseff 	
ifff
 
(ff 
attrff 
isff 
NotMappedAttributeff (
)ff( )
{gg 
colMetahh	 
.hh 
	NotMappedhh 
=hh 
truehh !
;hh! "
}ii 
elsejj 	
ifjj
 
(jj 
attrjj 
isjj 
ReadOnlyAttributejj '
)jj' (
{kk 
colMetall	 
.ll 

IsReadonlyll 
=ll 
truell "
;ll" #
}mm 
elsenn 	
ifnn
 
(nn 
attrnn 
isnn 
ForeignKeyAttributenn )
)nn) *
{oo 
varpp 	
fkAttrpp
 
=pp 
attrpp 
aspp 
ForeignKeyAttributepp .
;pp. /
ifqq 
(qq	 

fkAttrqq
 
!=qq 
nullqq 
)qq 
{rr 
vartt 

fkColtt 
=tt 
tmtt 
.tt 
Columnstt 
.tt 
Firsttt #
(tt# $
ctt$ %
=>tt& (
ctt) *
.tt* +
Propertytt+ 3
.tt3 4
Namett4 8
==tt9 ;
(tt< =
fkAttrtt= C
asttD F
ForeignKeyAttributettG Z
)ttZ [
.tt[ \
Namett\ `
)tt` a
;tta b
ResolveFkAttributesvv 
(vv 
colvv 
.vv 
PropertyTypevv +
,vv+ ,
fkColvv- 2
)vv2 3
;vv3 4

skipColumnxx 
=xx 
truexx 
;xx 
}yy 
}zz 
else{{ 	
if{{
 
({{ 
attr{{ 
is{{ 
DataTypeAttribute{{ '
){{' (
{|| 
colMeta}} 
.}} 
DataType}} 
=}} 
attr}} 
as}}  
DataTypeAttribute}}! 2
;}}2 3
}~~ 
else 	
if
 
( 
attr 
is #
ScaffoldColumnAttribute -
)- .
{
ÄÄ 
colMeta
ÅÅ 
.
ÅÅ 
	IsVisible
ÅÅ 
=
ÅÅ 
(
ÅÅ 
attr
ÅÅ 
as
ÅÅ  "%
ScaffoldColumnAttribute
ÅÅ# :
)
ÅÅ: ;
.
ÅÅ; <
Scaffold
ÅÅ< D
;
ÅÅD E
}
ÇÇ 
else
ÉÉ 	
if
ÉÉ
 
(
ÉÉ 
attr
ÉÉ 
is
ÉÉ 
UIHintAttribute
ÉÉ %
)
ÉÉ% &
{
ÑÑ 
colMeta
ÖÖ 
.
ÖÖ 
UIHint
ÖÖ 
=
ÖÖ 
(
ÖÖ 
attr
ÖÖ 
as
ÖÖ 
UIHintAttribute
ÖÖ  /
)
ÖÖ/ 0
;
ÖÖ0 1
}
ÜÜ 
else
áá 	
if
áá
 
(
áá 
attr
áá 
is
áá 
UIAttribute
áá !
)
áá! "
{
àà 
var
ââ 	
cpcn
ââ
 
=
ââ 
(
ââ 
attr
ââ 
as
ââ 
UIAttribute
ââ %
)
ââ% &
.
ââ& '%
CascadeParentColumnName
ââ' >
;
ââ> ?
colMeta
ãã 
.
ãã 
ParentColumn
ãã 
=
ãã 
tm
ãã 
.
ãã  
Columns
ãã  '
.
ãã' (
First
ãã( -
(
ãã- .
c
ãã. /
=>
ãã0 2
c
ãã3 4
.
ãã4 5
Property
ãã5 =
.
ãã= >
Name
ãã> B
==
ããC E
cpcn
ããF J
)
ããJ K
;
ããK L
if
åå	 
(
åå 
(
åå 
attr
åå 
as
åå 
UIAttribute
åå !
)
åå! "
.
åå" #
IsMaster
åå# +
)
åå+ ,
actualMaster
åå- 9
=
åå: ;
colMeta
åå< C
;
ååC D
}
çç 
}
éé 
if
èè 
(
èè 

skipColumn
èè 
)
èè 
{
êê 

removeList
ëë 
.
ëë 
Add
ëë 
(
ëë 
colMeta
ëë 
)
ëë 
;
ëë 
continue
íí 
;
íí 
}
ìì 
colMeta
îî 
.
îî 
	InnerType
îî 
=
îî 
Nullable
îî  
.
îî  !
GetUnderlyingType
îî! 2
(
îî2 3
col
îî3 6
.
îî6 7
PropertyType
îî7 C
)
îîC D
;
îîD E
if
ïï 
(
ïï 
colMeta
ïï 
.
ïï 
	InnerType
ïï 
!=
ïï 
null
ïï !
)
ïï! "
{
ññ 
colMeta
óó 
.
óó 
Required
óó 
=
óó 
false
óó 
;
óó 
}
òò 
else
ôô 
{
öö 
colMeta
õõ 
.
õõ 
	InnerType
õõ 
=
õõ 
col
õõ 
.
õõ 
PropertyType
õõ )
;
õõ) *
}
úú 
if
ûû 
(
ûû 
colMeta
ûû 
.
ûû 
	InnerType
ûû 
.
ûû 
IsEnum
ûû 
)
ûû  
{
üü 
var
†† 
names
††	 
=
†† 
Enum
†† 
.
†† 
GetNames
†† 
(
†† 
colMeta
†† &
.
††& '
	InnerType
††' 0
)
††0 1
.
††1 2
AsQueryable
††2 =
(
††= >
)
††> ?
;
††? @
var
°° 
values
°°	 
=
°° 
Enum
°° 
.
°° 
	GetValues
°°  
(
°°  !
colMeta
°°! (
.
°°( )
	InnerType
°°) 2
)
°°2 3
.
°°3 4
Cast
°°4 8
<
°°8 9
int
°°9 <
>
°°< =
(
°°= >
)
°°> ?
.
°°? @
AsQueryable
°°@ K
(
°°K L
)
°°L M
;
°°M N
colMeta
££ 
.
££ 
SetManualLookup
££ 
(
££ 
names
§§ 
.
§§ 
Zip
§§ 
(
§§ 
values
§§ 
,
§§ 
(
§§ 
n
§§ 
,
§§ 
v
§§ 
)
§§ 
=>
§§ !
new
§§" %
ListItem
§§& .
{
§§/ 0
Id
§§1 3
=
§§4 5
Convert
§§6 =
.
§§= >
ToInt32
§§> E
(
§§E F
v
§§F G
)
§§G H
,
§§H I
Text
§§J N
=
§§O P
n
§§Q R
}
§§S T
)
§§T U
.
§§U V
ToList
§§V \
(
§§\ ]
)
§§] ^
)
•• 
;
•• 
}
¶¶ 
if
©© 
(
©© 
colMeta
©© 
.
©© 
DataType
©© 
==
©© 
null
©© 
)
©©  
{
™™ 
DataType
´´ 
dt
´´ 
;
´´ 
if
¨¨ 
(
¨¨ 
_type2dt
¨¨ 
.
¨¨ 
TryGetValue
¨¨ 
(
¨¨ 
colMeta
¨¨ $
.
¨¨$ %
	InnerType
¨¨% .
,
¨¨. /
out
¨¨0 3
dt
¨¨4 6
)
¨¨6 7
)
¨¨7 8
{
¨¨9 :
colMeta
≠≠ 
.
≠≠ 
DataType
≠≠ 
=
≠≠ 
new
≠≠ 
DataTypeAttribute
≠≠ .
(
≠≠. /
dt
≠≠/ 1
)
≠≠1 2
;
≠≠2 3
}
ÆÆ 
}
ØØ 
}
±± 

removeList
≤≤ 
.
≤≤ 
ForEach
≤≤ 
(
≤≤ 
c
≤≤ 
=>
≤≤ 
tm
≤≤ 
.
≤≤ 
Columns
≤≤ %
.
≤≤% &
Remove
≤≤& ,
(
≤≤, -
c
≤≤- .
)
≤≤. /
)
≤≤/ 0
;
≤≤0 1
tm
µµ 
.
µµ 
Columns
µµ 
.
µµ 
Sort
µµ 
(
µµ 
defaultComparer
µµ "
)
µµ" #
;
µµ# $
var
∑∑ 
fks
∑∑ 

=
∑∑ 
tm
∑∑ 
.
∑∑ 
Columns
∑∑ 
.
∑∑ 
Where
∑∑ 
(
∑∑ 
c
∑∑ 
=>
∑∑  "
c
∑∑# $
.
∑∑$ %
PrimaryTable
∑∑% 1
!=
∑∑2 4
null
∑∑5 9
)
∑∑9 :
.
∑∑: ;
ToArray
∑∑; B
(
∑∑B C
)
∑∑C D
;
∑∑D E
switch
∏∏ 	
(
∏∏
 
fks
∏∏ 
.
∏∏ 
Length
∏∏ 
)
∏∏ 
{
ππ 
case
∫∫ 
$num
∫∫ 
:
∫∫ 
break
ªª 
;
ªª 
case
ºº 
$num
ºº	 

:
ºº
 
tm
ΩΩ 
.
ΩΩ 
MasterFk
ΩΩ 
=
ΩΩ 
fks
ΩΩ 
[
ΩΩ 
$num
ΩΩ 
]
ΩΩ 
;
ΩΩ 
break
ææ 

;
ææ
 
default
øø 
:
øø 
tm
¿¿ 
.
¿¿ 
MasterFk
¿¿ 
=
¿¿  !
actualMaster
¿¿" .
;
¿¿. /
break
¡¡ 
;
¡¡ 
}
¬¬ 
if
√√ 
(
√√ 
!
√√ 
_metaCacheByName
√√ 
.
√√ 
ContainsKey
√√ #
(
√√# $
tm
√√$ &
.
√√& '
ActualTableName
√√' 6
)
√√6 7
)
√√7 8
_metaCacheByName
ƒƒ 
.
ƒƒ 
Add
ƒƒ 
(
ƒƒ 
tm
ƒƒ 
.
ƒƒ 
ActualTableName
ƒƒ +
,
ƒƒ+ ,
tm
ƒƒ- /
)
ƒƒ/ 0
;
ƒƒ0 1
return
∆∆ 	
tm
∆∆
 
;
∆∆ 
}
»» 
public
   
static
  	 
GenericListVM
   
ToListVM
   &
<
  & '
T
  ' (
>
  ( )
(
  ) *
this
  * .
List
  / 3
<
  3 4
T
  4 5
>
  5 6
values
  7 =
)
  = >
where
  ? D
T
  E F
:
  G H
class
  I N
{
ÀÀ 
var
ÃÃ 
_type
ÃÃ 
=
ÃÃ 
typeof
ÃÃ 
(
ÃÃ 
T
ÃÃ 
)
ÃÃ 
;
ÃÃ 
	TableMeta
ŒŒ 
meta
ŒŒ 
=
ŒŒ 

_metaCache
ŒŒ 
.
ŒŒ 
GetOrAdd
ŒŒ '
(
ŒŒ' (
_type
ŒŒ( -
,
ŒŒ- .
AddMeta
ŒŒ/ 6
)
ŒŒ6 7
;
ŒŒ7 8
var
—— 
result
—— 
=
—— 
new
—— 
GenericListVM
—— !
(
——! "
meta
——" &
)
——& '
;
——' (
result
‘‘ 	
.
‘‘	 

Items
‘‘
 
=
‘‘ 
new
‘‘ 
List
‘‘ 
<
‘‘ 
IDictionary
‘‘ &
<
‘‘& '
string
‘‘' -
,
‘‘- .
object
‘‘/ 5
>
‘‘5 6
>
‘‘6 7
(
‘‘7 8
)
‘‘8 9
;
‘‘9 :
foreach
÷÷ 

(
÷÷ 
var
÷÷ 
v
÷÷ 
in
÷÷ 
values
÷÷ 
)
÷÷ 
result
◊◊ 

.
◊◊
 
Items
◊◊ 
.
◊◊ 
Add
◊◊ 
(
◊◊ 
v
◊◊ 
.
◊◊ 
	ToDynamic
◊◊  
(
◊◊  !
)
◊◊! "
)
◊◊" #
;
◊◊# $
return
ŸŸ 	
result
ŸŸ
 
;
ŸŸ 
}
€€ 
public
›› 
static
››	 
	GenericVM
›› 
ToVM
›› 
(
›› 
this
›› #
object
››$ *
value
››+ 0
)
››0 1
{
ﬁﬁ 
var
ﬂﬂ 
_type
ﬂﬂ 
=
ﬂﬂ 
value
ﬂﬂ 
.
ﬂﬂ 
GetType
ﬂﬂ 
(
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
	TableMeta
·· 
meta
·· 
=
·· 

_metaCache
·· 
.
·· 
GetOrAdd
·· '
(
··' (
_type
··( -
,
··- .
AddMeta
··/ 6
)
··6 7
;
··7 8
var
‰‰ 
result
‰‰ 
=
‰‰ 
new
‰‰ 
	GenericVM
‰‰ 
(
‰‰ 
meta
‰‰ "
)
‰‰" #
;
‰‰# $
result
ÂÂ 	
.
ÂÂ	 

Data
ÂÂ
 
=
ÂÂ 
value
ÂÂ 
.
ÂÂ 
	ToDynamic
ÂÂ  
(
ÂÂ  !
)
ÂÂ! "
;
ÂÂ" #
return
ËË 	
result
ËË
 
;
ËË 
}
ÈÈ 
public
ÎÎ 
static
ÎÎ	 
	GenericVM
ÎÎ 
ToVM
ÎÎ 
(
ÎÎ 
this
ÎÎ #
Type
ÎÎ$ (
type
ÎÎ) -
,
ÎÎ- .
object
ÎÎ/ 5
data
ÎÎ6 :
)
ÎÎ: ;
{
ÏÏ 
	TableMeta
ÌÌ 
meta
ÌÌ 
=
ÌÌ 

_metaCache
ÌÌ 
.
ÌÌ 
GetOrAdd
ÌÌ '
(
ÌÌ' (
type
ÌÌ( ,
,
ÌÌ, -
AddMeta
ÌÌ. 5
)
ÌÌ5 6
;
ÌÌ6 7
var
 
result
 
=
 
new
 
	GenericVM
 
(
 
meta
 "
)
" #
;
# $
result
ÒÒ 	
.
ÒÒ	 

Data
ÒÒ
 
=
ÒÒ 
data
ÒÒ 
.
ÒÒ 
	ToDynamic
ÒÒ 
(
ÒÒ  
)
ÒÒ  !
;
ÒÒ! "
return
ÙÙ 	
result
ÙÙ
 
;
ÙÙ 
}
ıı 
public
˜˜ 
static
˜˜	 
	TableMeta
˜˜ 
Get
˜˜ 
(
˜˜ 
Type
˜˜ "
type
˜˜# '
)
˜˜' (
{
¯¯ 
try
˘˘ 
{
˙˙ 
return
˚˚ 

_metaCache
˚˚ 
[
˚˚ 
type
˚˚ 
]
˚˚ 
;
˚˚ 
}
¸¸ 
catch
˝˝ 	
(
˝˝
 
	Exception
˝˝ 
e
˝˝ 
)
˝˝ 
{
˛˛ 
Console
ˇˇ 
.
ˇˇ 
	WriteLine
ˇˇ 
(
ˇˇ 
e
ˇˇ 
)
ˇˇ 
;
ˇˇ 
throw
ÄÄ 
;
ÄÄ 
}
ÅÅ 
}
ÉÉ 
public
ÖÖ 
static
ÖÖ	 
	TableMeta
ÖÖ 
Get
ÖÖ 
(
ÖÖ 
string
ÖÖ $
typeName
ÖÖ% -
)
ÖÖ- .
{
ÜÜ 
return
áá 	
_metaCacheByName
áá
 
[
áá 
typeName
áá #
]
áá# $
;
áá$ %
}
àà 
}
ââ 
}ää §
ME:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\CustomModelBinder.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

class 
CustomModelBinder "
:# $
DefaultModelBinder% 7
{ 
	protected 
override 
void 
OnModelUpdated  .
(. /
ControllerContext/ @
ccA C
,C D
ModelBindingContextE X
bcY [
)[ \
{		 	
base

 
.

 
OnModelUpdated

 
(

  
cc

  "
,

" #
bc

$ &
)

& '
;

' (
object 
v 
; 
if 
( 
cc 
. 

Controller 
. 
ViewData %
.% &
TryGetValue& 1
(1 2
$str2 I
,I J
outK N
vO P
)P Q
)Q R
{ 
var 
gbm 
= 
( !
GenericBindingMessage 0
)0 1
v1 2
;2 3
var 
meta 
= 
CrudExtensions )
.) *
Get* -
(- .
bc. 0
.0 1
	ModelType1 :
): ;
;; <
var 
ec 
= 
gbm 
. 
PropertyName )
+* +
$str, 1
;1 2
var 
prop 
= 
meta 
.  
Columns  '
.' (
FirstOrDefault( 6
(6 7
c7 8
=>9 ;
c< =
.= >
Property> F
.F G
NameG K
==L N
ecO Q
)Q R
.R S
PropertyS [
;[ \
if 
( 
prop 
!= 
null 
) 
prop 
. 
SetValue !
(! "
bc" $
.$ %
Model% *
,* +
gbm, /
./ 0
	Extension0 9
)9 :
;: ;
} 
} 	
} 
} ù	
IE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\GenericListVM.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

class 
GenericListVM 
{ 
public 
	TableMeta 
Meta 
{ 
get  #
;# $
private% ,
set- 0
;0 1
}2 3
public 
PageVM 
Page 
{ 
get  
;  !
set" %
;% &
}' (
public

 
GenericListVM

 
(

 
	TableMeta

 &
meta

' +
)

+ ,
{ 	
this 
. 
Meta 
= 
meta 
; 
} 	
public 
List 
< 
IDictionary 
<  
string  &
,& '
object( .
>. /
>/ 0
Items1 6
{7 8
get9 <
;< =
set> A
;A B
}C D
} 
} »
EE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\GenericVM.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

class 
	GenericVM 
{ 
public 
	TableMeta 
Meta 
{ 
get  #
;# $
private% ,
set- 0
;0 1
}2 3
public		 
	GenericVM		 
(		 
	TableMeta		 "
meta		# '
)		' (
{

 	
this 
. 
Meta 
= 
meta 
; 
} 	
public 
IDictionary 
< 
string !
,! "
object# )
>) *
Data+ /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
} 
} ¨
DE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\ListItem.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

class 
ListItem 
{ 
[ 	
JsonProperty	 
( 
$str 
) 
] 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[		 	
JsonProperty			 
(		 
$str		 
)		 
]		 
public

 
string

 
Text

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
} 
} à
HE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\PageFeatures.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

class 
PageFeatures 
: 
	Attribute '
{ 
public 
PageFeatures 
( 
) 
{ 	
Caption		 
=		 
$str		 
;		 
Visible

 
=

 
false

 
;

 
} 	
public 
string 
Caption 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
Visible 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ò
BE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\PageVM.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

class 
PageVM 
{ 
public 
int 

ActivePage 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
	PageCount 
{ 
get "
;" #
}$ %
public 
int 
TotalRowCount  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
PageSize 
{ 
get !
;! "
set# &
;& '
}( )
public		 
	GenericVM		 
SearchVM		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
}

 
} ‚
EE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\TableMeta.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 
class 
	TableMeta 
{		 
public

 
List

	 
<

 

ColumnMeta

 
>

 
Columns

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
PropertyInfo	 
PrimaryColumn #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
PropertyInfo	 
IdentityColumn $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string	 
ControllerName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string	 
ActualTableName 
{  !
get" %
;% &
set' *
;* +
}, -
public "
DisplayColumnAttribute	 
DisplayColumn  -
{. /
get0 3
;3 4
internal5 =
set> A
;A B
}C D
public  
DisplayNameAttribute	 
Caption %
{& '
get( +
;+ ,
internal- 5
set6 9
;9 :
}; <
public 

ColumnMeta 
MasterFk "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
	TableMeta	 
( 
) 
{ 
Columns 

= 
new 
List 
< 

ColumnMeta  
>  !
(! "
)" #
;# $
} 
public 
void	 
Add 
( 

ColumnMeta 
column #
)# $
{ 
Columns 

.
 
Add 
( 
column 
) 
; 
} 
} 
}   ô	
IE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\TemplateModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 
class 
TemplateItemModel 
{ 
public 
	GenericVM	 
Model 
{ 
get 
; 
set  #
;# $
}% &
public 
GenericListVM	 
	ModelList  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

ColumnMeta	 
CurrentColumn !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

RenderMode	 
Mode 
{ 
get 
; 
set  #
;# $
}% &
}		 
public 
enum 

RenderMode 
{ 
Readonly 

,
 
Create 
, 	
Edit 
, 
Delete 
} 
} µ	
AE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\Tools.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public		 
static		 
class		 
Tools		 
{

 
public 
static	 
List 
< 
T 
> 
Select 
< 
T  
>  !
(! "
string" (
sql) ,
,, -
params. 4
object5 ;
[; <
]< =
args> B
)B C
{ 
using 	
(
 
var 
db 
= 
new 
BayiPuanContext '
(' (
)( )
)) *
{ 
return 
db 
. 
Database 
. 
SqlQuery  
<  !
T! "
>" #
(# $
sql$ '
,' (
args) -
)- .
.. /
ToList/ 5
(5 6
)6 7
;7 8
} 
} 
} 
} ›
GE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\UIAttribute.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

class 
UIAttribute 
: 
	Attribute (
{ 
public 
string #
CascadeParentColumnName -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
bool 
IsMaster 
; 
public

 
UIAttribute

 
(

 
string

 !#
cascadeParentColumnName

" 9
)

9 :
{ 	#
CascadeParentColumnName #
=$ %#
cascadeParentColumnName& =
;= >
} 	
} 
} Ã
ME:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\UploadModelBinder.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

class 
UploadModelBinder "
:# $ 
ByteArrayModelBinder% 9
{ 
public 
override 
object 
	BindModel (
(( )
ControllerContext) :
cc; =
,= >
ModelBindingContext? R
bcS U
)U V
{		 	
var

 
file

 
=

 
cc

 
.

 
HttpContext

 %
.

% &
Request

& -
.

- .
Files

. 3
[

3 4
bc

4 6
.

6 7
	ModelName

7 @
]

@ A
;

A B
if 
( 
file 
!= 
null 
) 
{ 
if 
( 
file 
. 
ContentLength &
>' (
$num) *
)* +
{ 
var 
ext 
= 
Path "
." #
GetExtension# /
(/ 0
file0 4
.4 5
FileName5 =
)= >
;> ?
cc 
. 

Controller !
.! "
ViewData" *
[* +
$str+ B
]B C
=D E
newF I!
GenericBindingMessageJ _
{ 
PropertyName $
=% &
bc' )
.) *
	ModelName* 3
,3 4
	Extension !
=" #
ext$ '
,' (
ContentType #
=$ %
file& *
.* +
ContentType+ 6
} 
; 
var 
	fileBytes !
=" #
new$ '
byte( ,
[, -
file- 1
.1 2
ContentLength2 ?
]? @
;@ A
file 
. 
InputStream $
.$ %
Read% )
() *
	fileBytes* 3
,3 4
$num5 6
,6 7
	fileBytes8 A
.A B
LengthB H
)H I
;I J
return 
	fileBytes $
;$ %
} 
return 
null 
; 
} 
return 
base 
. 
	BindModel !
(! "
cc" $
,$ %
bc& (
)( )
;) *
} 	
} 
public!! 

class!! !
GenericBindingMessage!! &
{"" 
public## 
string## 
PropertyName## "
;##" #
public$$ 
string$$ 
ContentType$$ !
;$$! "
public%% 
string%% 
	Extension%% 
;%%  
}&& 
}'' „
GE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\GenericVM\UploadUtils.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
	GenericVM %
{ 
public 

static 
class 
UploadUtils #
{ 
static 
HashSet 
< 
string 
> 
kabulEdilenTurler 0
=1 2
new3 6
HashSet7 >
<> ?
string? E
>E F
{ 	
$str		 
,		 
$str		 
,		 
$str		 #
,		# $
$str		% +
}

 	
;

	 

static 
HashSet 
< 
string 
> #
kabulEdilenDosyaTurleri 6
=7 8
new9 <
HashSet= D
<D E
stringE K
>K L
{ 	
$str 
, 
$str 
, 
$str !
," #
$str# )
,) *
$str* 1
,2 3
$str4 :
,: ;
$str; B
} 	
;	 

public 
static 
bool 
IsImage "
(" #
string# )
	extension* 3
)3 4
{ 	
return 
kabulEdilenTurler $
.$ %
Contains% -
(- .
	extension. 7
)7 8
;8 9
} 	
public 
static 
bool 
IsFile !
(! "
string" (
	extension) 2
)2 3
{ 	
return #
kabulEdilenDosyaTurleri *
.* +
Contains+ 3
(3 4
	extension4 =
)= >
;> ?
} 	
} 
} ÈD
=E:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Global.asax.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
{ 
public 
class	 
Global 
: 
System 
. 
Web "
." #
HttpApplication# 2
{ 
	protected 
void 
Application_Start $
($ %
)% &
{ "
ModelMetadataProviders 
. 
Current $
=% &
new' *6
*CachedDataAnnotationsModelMetadataProvider+ U
(U V
)V W
;W X
ViewEngines 
. 
Engines 
. 
Clear 
(  
)  !
;! "
ViewEngines 
. 
Engines 
. 
Add 
( 
new !
RazorViewEngine" 1
(1 2
)2 3
)3 4
;4 5
AreaRegistration 
. 
RegisterAllAreas '
(' (
)( )
;) *
RouteConfig!! 
.!! 
RegisterRoutes!!  
(!!  !

RouteTable!!! +
.!!+ ,
Routes!!, 2
)!!2 3
;!!3 4
FilterConfig"" 
."" !
RegisterGlobalFilters"" (
(""( )
GlobalFilters"") 6
.""6 7
Filters""7 >
)""> ?
;""? @
ModelBinders%% 
.%% 
Binders%% 
.%% 
Remove%% !
(%%! "
typeof%%" (
(%%( )
byte%%) -
[%%- .
]%%. /
)%%/ 0
)%%0 1
;%%1 2
ModelBinders&& 
.&& 
Binders&& 
.&& 
Add&& 
(&& 
typeof&& %
(&&% &
byte&&& *
[&&* +
]&&+ ,
)&&, -
,&&- .
new&&/ 2
UploadModelBinder&&3 D
(&&D E
)&&E F
)&&F G
;&&G H
ModelBinders'' 
.'' 
Binders'' 
.'' 
DefaultBinder'' (
='') *
new''+ .
CustomModelBinder''/ @
(''@ A
)''A B
;''B C
ControllerBuilder)) 
.)) 
Current)) 
.))   
SetControllerFactory))  4
())4 5
new))5 8$
NinjectControllerFactory))9 Q
())Q R
new))R U
BusinessModule))V d
())d e
)))e f
,))f g
new**" %
AutoMapperModule**& 6
(**6 7
)**7 8
)**8 9
)**9 :
;**: ;#
ModelValidatorProviders,, 
.,, 
	Providers,, '
.,,' (
Clear,,( -
(,,- .
),,. /
;,,/ 02
&FluentValidationModelValidatorProvider.. ,
..., -
	Configure..- 6
(..6 7
provider..7 ?
=>..@ B
{// 
provider00 
.00 
ValidatorFactory00 !
=00" #
new00$ '$
NinjectValidatoryFactory00( @
(00@ A
)00A B
;00B C
provider11 
.11 (
AddImplicitRequiredValidator11 -
=11. /
false110 5
;115 6
}22 
)22 
;22 	
}77 
public99 

override99 
void99 
Init99 
(99 
)99 
{:: #
PostAuthenticateRequest;; 
+=;;  2
&MvcApplication_PostAuthenticateRequest;;! G
;;;G H
base<< 

.<<
 
Init<< 
(<< 
)<< 
;<< 
}== 
	protected@@ 
void@@ +
Application_AcquireRequestState@@ 2
(@@2 3
object@@3 9
sender@@: @
,@@@ A
	EventArgs@@B K
e@@L M
)@@M N
{AA 
tryBB 	
{CC 
varDD 
prinDD 
=DD 
newDD 
GenericPrincipalDD '
(DD' (
newDD( +
IdentityDD, 4
{EE 	
IdFF
 
=FF 
newFF 
GuidFF 
(FF 
SessionFF 
.FF  
	SessionIDFF  )
)FF) *
,FF* +
UrlGG
 
=GG 
RequestGG 
.GG 
RawUrlGG 
,GG 
}II 	
,II	 

newII 
stringII 
[II 
]II 
{II 
}II 
)II 
;II 
ThreadJJ 
.JJ 
CurrentPrincipalJJ 
=JJ  !
prinJJ" &
;JJ& '
}KK 
catchLL 
(LL 
	ExceptionLL 
)LL 
{MM 
}NN 
stringPP 
culturePP 
=PP 
$strPP 
;PP 
ifRR 
(RR	 

!RR
 
stringRR 
.RR 
IsNullOrEmptyRR 
(RR  
RequestRR  '
.RR' (
CookiesRR( /
[RR/ 0
$strRR0 9
]RR9 :
?RR: ;
.RR; <
ValueRR< A
)RRA B
)RRB C
{SS 
cultureTT 
=TT 
RequestTT 
.TT 
CookiesTT !
[TT! "
$strTT" +
]TT+ ,
.TT, -
ValueTT- 2
;TT2 3
}UU 
elseVV 

{WW 
ifXX 

(XX 
RequestXX 
.XX 
UserLanguagesXX !
!=XX" $
nullXX% )
)XX) *
cultureXX+ 2
=XX3 4
RequestXX5 <
.XX< =
UserLanguagesXX= J
[XXJ K
$numXXK L
]XXL M
;XXM N
}YY 
var[[ 	
ci[[
 
=[[ 
new[[ 
CultureInfo[[ 
([[ 
culture[[ &
)[[& '
;[[' (
Thread]] 
.]] 
CurrentThread]] 
.]] 
CurrentUICulture]] +
=]], -
ci]]. 0
;]]0 1
Thread^^ 
.^^ 
CurrentThread^^ 
.^^ 
CurrentCulture^^ )
=^^* +
ci^^, .
;^^. /
}`` 
	protectedbb 
voidbb $
Application_BeginRequestbb +
(bb+ ,
objectbb, 2
senderbb3 9
,bb9 :
	EventArgsbb; D
ebbE F
)bbF G
{cc 
}ee 
privategg 
voidgg 2
&MvcApplication_PostAuthenticateRequestgg 7
(gg7 8
objectgg8 >
sendergg? E
,ggE F
	EventArgsggG P
eggQ R
)ggR S
{hh 
tryii 	
{jj 
varkk 

authCookiekk 
=kk 
HttpContextkk $
.kk$ %
Currentkk% ,
.kk, -
Requestkk- 4
.kk4 5
Cookieskk5 <
[kk< =
FormsAuthenticationkk= P
.kkP Q
FormsCookieNamekkQ `
]kk` a
;kka b
ifll 

(ll 

authCookiell 
==ll 
nullll 
)ll 
{mm 	
returnnn
 
;nn 
}oo 	
varqq 
	encTicketqq 
=qq 

authCookieqq "
.qq" #
Valueqq# (
;qq( )
ifrr 

(rr 
Stringrr 
.rr 
IsNullOrEmptyrr  
(rr  !
	encTicketrr! *
)rr* +
)rr+ ,
{ss 	
returntt
 
;tt 
}uu 	
varww 
ticketww 
=ww 
FormsAuthenticationww (
.ww( )
Decryptww) 0
(ww0 1
	encTicketww1 :
)ww: ;
;ww; <
varyy 
securityUtlitiesyy 
=yy 
newyy "
SecurityUtilitiesyy# 4
(yy4 5
)yy5 6
;yy6 7
varzz 
identityzz 
=zz 
securityUtlitieszz '
.zz' (%
FormsAuthTicketToIdentityzz( A
(zzA B
ticketzzB H
)zzH I
;zzI J
var|| 
	principal|| 
=|| 
new|| 
GenericPrincipal|| ,
(||, -
identity||- 5
,||5 6
identity||7 ?
.||? @
Roles||@ E
)||E F
;||F G
HttpContext~~ 
.~~ 
Current~~ 
.~~ 
User~~  
=~~! "
	principal~~# ,
;~~, -
Thread 
. 
CurrentPrincipal 
=  !
	principal" +
;+ ,
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
)
ÅÅ 
{
ÇÇ 
}
ÑÑ 
}
ÜÜ 
}
áá 
}àà ÃB
LE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\HtmlHelpers\GeneralHelpers.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
HtmlHelpers '
{ 
[ 
OutputCache 
( 
VaryByParam 
= 
$str #
,# $
Duration% -
=. /
$num0 4
)4 5
]5 6
public 
class	 
GeneralHelpers 
{ 
public 

static 
string 
	GetUserId "
(" #
)# $
{ 
if 
(	 

HttpContext
 
. 
Current 
. 
User "
." #
Identity# +
.+ ,
IsAuthenticated, ;
==< >
true? C
)C D
{ 
BayiPuanContext 
db 
= 
new  
BayiPuanContext! 0
(0 1
)1 2
;2 3
var 
user 
= 
db 
. 
Users 
. 
AsNoTracking (
(( )
)) *
.* +
FirstOrDefault+ 9
(9 :
x: ;
=>< >
x? @
.@ A
UserNameA I
==J L
HttpContextM X
.X Y
CurrentY `
.` a
Usera e
.e f
Identityf n
.n o
Nameo s
)s t
;t u
return 
user 
. 
UserId 
. 
ToString #
(# $
)$ %
;% &
} 
return 
null 
; 
} 
public 

static 
string 
GetUserFacility (
(( )
)) *
{ 
if 
(	 

HttpContext
 
. 
Current 
. 
User "
." #
Identity# +
.+ ,
IsAuthenticated, ;
==< >
true? C
)C D
{   
BayiPuanContext!! 
db!! 
=!! 
new!!  
BayiPuanContext!!! 0
(!!0 1
)!!1 2
;!!2 3
var"" 
user"" 
="" 
db"" 
."" 
Users"" 
."" 
AsNoTracking"" (
(""( )
)"") *
.""* +
FirstOrDefault""+ 9
(""9 :
x"": ;
=>""< >
x""? @
.""@ A
UserName""A I
==""J L
HttpContext""M X
.""X Y
Current""Y `
.""` a
User""a e
.""e f
Identity""f n
.""n o
Name""o s
)""s t
;""t u
var## 

facility## 
=## 
db## 
.## 
Sellers## 
.##  
AsNoTracking##  ,
(##, -
)##- .
.##. /
FirstOrDefault##/ =
(##= >
x##> ?
=>##@ B
x##C D
.##D E
SellerId##E M
==##N P
user##Q U
.##U V
SellerId##V ^
)##^ _
;##_ `
return$$ 
facility$$ 
.$$ 

SellerName$$ "
;$$" #
}%% 
return'' 
null'' 
;'' 
}(( 
public)) 

static)) 
decimal)) 
GetRemainingPoint)) +
())+ ,
))), -
{** 
var++ 	
product++
 
=++ 
DependencyResolver++ &
<++& '
IProductService++' 6
>++6 7
.++7 8
Resolve++8 ?
(++? @
)++@ A
;++A B
var,, 	
sale,,
 
=,, 
DependencyResolver,, #
<,,# $
ISaleService,,$ 0
>,,0 1
.,,1 2
Resolve,,2 9
(,,9 :
),,: ;
;,,; <
var-- 	
buyGift--
 
=-- 
DependencyResolver-- &
<--& '
IBuyService--' 2
>--2 3
.--3 4
Resolve--4 ;
(--; <
)--< =
;--= >
var.. 	
gift..
 
=.. 
DependencyResolver.. #
<..# $
IGiftService..$ 0
>..0 1
...1 2
Resolve..2 9
(..9 :
)..: ;
;..; <
var// 	
score//
 
=// 
DependencyResolver// $
<//$ %
IScoreService//% 2
>//2 3
.//3 4
Resolve//4 ;
(//; <
)//< =
;//= >
var00 	

totalPoint00
 
=00 
(00 
from00 
s00 
in00 !
score00" '
.00' (
GetAll00( .
(00. /
)00/ 0
select11 
new11 "
{22 
s33 
.33 
UserId33 "
,33" #
s44 
.44 

ScoreTotal44 &
}55 
)55 
.55 
Where55  
(55  !
p55! "
=>55# %
p55& '
.55' (
UserId55( .
==55/ 1
Convert552 9
.559 :
ToInt3255: A
(55A B
	GetUserId55B K
(55K L
)55L M
)55M N
)55N O
.66 	
GroupBy66	 
(66 
w66 
=>66 
w66 
.66 
UserId66 
)66 
.77 	
Select77	 
(77 
y77 
=>77 
new77 
ProductPoint77 %
{88 	
UserId99
 
=99 
y99 
.99 
Key99 
,99 
SumPoint::
 
=:: 
y:: 
.:: 
Sum:: 
(:: 
x:: 
=>:: 
x::  !
.::! "

ScoreTotal::" ,
)::, -
,::- .
}<< 	
)<<	 

.<<
 
ToList<< 
(<< 
)<< 
;<< 
var>> 	

totalSpent>>
 
=>> 
(>> 
from>> 
b>> 
in>> !
buyGift>>" )
.>>) *
GetAll>>* 0
(>>0 1
)>>1 2
join?? 
g?? 
in?? !
gift??" &
.??& '
GetAll??' -
(??- .
)??. /
on??0 2
b??3 4
.??4 5
GiftId??5 ;
equals??< B
g??C D
.??D E
GiftId??E K
select@@ 
new@@ "
{AA 
bBB 
.BB 
UserIdBB "
,BB" #
bCC 
.CC 

IsApprovedCC &
,CC& '
gDD 
.DD 
	GiftPointDD %
}EE 
)EE 
.EE 
WhereEE  
(EE  !
bEE! "
=>EE# %
bEE& '
.EE' (
UserIdEE( .
==EE/ 1
ConvertEE2 9
.EE9 :
ToInt32EE: A
(EEA B
	GetUserIdEEB K
(EEK L
)EEL M
)EEM N
&&EEO Q
bEER S
.EES T

IsApprovedEET ^
==EE_ a
trueEEb f
)EEf g
.FF 	
GroupByFF	 
(FF 
wFF 
=>FF 
wFF 
.FF 
UserIdFF 
)FF 
.GG 	
SelectGG	 
(GG 
yGG 
=>GG 
newGG 

SpentPointGG #
{HH 	
UserIdII
 
=II 
yII 
.II 
KeyII 
,II 

SpendPointJJ
 
=JJ 
yJJ 
.JJ 
SumJJ 
(JJ 
xJJ 
=>JJ !
xJJ" #
.JJ# $
	GiftPointJJ$ -
)JJ- .
}KK 	
)KK	 

.KK
 
ToListKK 
(KK 
)KK 
;KK 
decimalMM 
remainingPointMM 
=MM 

totalPointMM )
.MM) *
SumMM* -
(MM- .
pMM. /
=>MM/ 1
pMM1 2
.MM2 3
SumPointMM3 ;
)MM; <
-MM= >

totalSpentMM? I
.MMI J
SumMMJ M
(MMM N
sMMN O
=>MMO Q
sMMQ R
.MMR S

SpendPointMMS ]
)MM] ^
;MM^ _
returnNN 
remainingPointNN 
;NN 
}OO 
}PP 
}QQ À
TE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\HtmlHelpers\LanguageSelectorHelper.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
HtmlHelpers '
{		 
public

 

static

 
class

 "
LanguageSelectorHelper

 .
{ 
public 
static 
MvcHtmlString #
LangSelector$ 0
(0 1
this1 5

HtmlHelper6 @
helperA G
)G H
{ 	
var 
languageService 
=  !
DependencyResolver" 4
<4 5
ILanguageService5 E
>E F
.F G
ResolveG N
(N O
)O P
;P Q
var 
langCollection 
=  
languageService! 0
.0 1
GetAll1 7
(7 8
)8 9
;9 :
var 
sb 
= 
new 
StringBuilder $
($ %
)% &
;& '
sb 
. 
Append 
( 
$str 8
)8 9
;9 :
sb 
. 
Append 
( 
$str `
)` a
;a b
sb 
. 
Append 
( 
$str P
)P Q
;Q R
foreach 
( 
var 
item 
in  
langCollection! /
)/ 0
{ 
sb 
. 
Append 
( 
$str B
+C D
itemE I
.I J

LanguageIdJ T
+U V
$strW _
+` a
itemb f
.f g
Codeg k
+l m
$str '
+' (
HttpContext) 4
.4 5
Current5 <
.< =
Request= D
.D E
RawUrlE K
+L M
$strN R
+S T
itemU Y
.Y Z
NameZ ^
+_ `
$stra g
)g h
;h i
sb 
. 
Append 
( 
$str !
)! "
;" #
} 
sb 
. 
Append 
( 
$str 
) 
;  
sb 
. 
Append 
( 
$str 
) 
;  
return 
MvcHtmlString  
.  !
Create! '
(' (
sb( *
.* +
ToString+ 3
(3 4
)4 5
)5 6
;6 7
} 	
}   
}!! Ò
RE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\HtmlHelpers\MyCheckBoxForHelpers.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
HtmlHelpers '
{ 
public		 
static			 
class		  
MyCheckBoxForHelpers		 *
{

 
public 

static 
MvcHtmlString 
MyCheckBoxFor  -
<- .
TModel. 4
>4 5
(5 6
this6 :

HtmlHelper; E
<E F
TModelF L
>L M
helperN T
,T U

ExpressionV `
<` a
Funca e
<e f
TModelf l
,l m
booln r
>r s
>s t

expressionu 
)	 Ä
{ 

TagBuilder 
innerContainer 
=  !
new" %

TagBuilder& 0
(0 1
$str1 6
)6 7
;7 8
innerContainer 
. 
AddCssClass  
(  !
$str! +
)+ ,
;, -
innerContainer 
. 
	InnerHtml 
=  
helper! '
.' (
CheckBoxFor( 3
(3 4

expression4 >
,> ?
new@ C
{D E
@classF L
=M N
$strO ]
}^ _
)_ `
.` a
ToStringa i
(i j
)j k
;k l
StringBuilder 
html 
= 
new 
StringBuilder ,
(, -
)- .
;. /
html 

.
 
Append 
( 
helper 
. 
LabelFor !
(! "

expression" ,
,, -
new. 1
{2 3
@class4 :
=; <
$str= U
}V W
)W X
)X Y
;Y Z
html 

.
 
Append 
( 
innerContainer  
.  !
ToString! )
() *
)* +
)+ ,
;, -

TagBuilder 
outerContainer 
=  !
new" %

TagBuilder& 0
(0 1
$str1 6
)6 7
;7 8
outerContainer 
. 
AddCssClass  
(  !
$str! -
)- .
;. /
outerContainer 
. 
	InnerHtml 
=  
html! %
.% &
ToString& .
(. /
)/ 0
;0 1
return 
MvcHtmlString 
. 
Create !
(! "
outerContainer" 0
.0 1
ToString1 9
(9 :
): ;
); <
;< =
} 
} 
} Ö
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\HtmlHelpers\MyEditorForHelpers.cs
	namespace

 	
BayiPuan


 
.

 
MvcWebUi

 
.

 
HtmlHelpers

 '
{ 
public 

static 
class 
MyEditorForHelpers *
{ 
public 
static 
IHtmlString !
MyEditorFor" -
<- .
TModel. 4
,4 5
TValue6 <
>< =
(= >
this> B

HtmlHelperC M
<M N
TModelN T
>T U

htmlHelperV `
,` a

Expressionb l
<l m
Funcm q
<q r
TModelr x
,x y
TValue	z Ä
>
Ä Å
>
Å Ç

expression
É ç
,
ç é
object
è ï
ViewData
ñ û
,
û ü
bool
† §
disabled
• ≠
=
Æ Ø
false
∞ µ
,
µ ∂
bool
∑ ª
visible
º √
=
ƒ ≈
true
∆  
)
  À
{ 	
var 
member 
= 

expression #
.# $
Body$ (
as) +
MemberExpression, <
;< =
var 
stringLength 
= 
member %
.% &
Member& ,
., -
GetCustomAttributes- @
(@ A
typeofA G
(G H!
StringLengthAttributeH ]
)] ^
,^ _
false` e
)e f
.f g
FirstOrDefaultg u
(u v
)v w
asx z"
StringLengthAttribute	{ ê
;
ê ë 
RouteValueDictionary  
viewData! )
=* +

HtmlHelper, 6
.6 7+
AnonymousObjectToHtmlAttributes7 V
(V W
ViewDataW _
)_ `
;` a 
RouteValueDictionary  
htmlAttributes! /
=0 1

HtmlHelper2 <
.< =+
AnonymousObjectToHtmlAttributes= \
(\ ]
viewData] e
[e f
$strf v
]v w
)w x
;x y
if 
( 
stringLength 
!= 
null  $
)$ %
{ 
htmlAttributes 
. 
Add "
(" #
$str# .
,. /
stringLength0 <
.< =
MaximumLength= J
)J K
;K L
} 
return 

htmlHelper 
. 

TextBoxFor (
(( )

expression) 3
,3 4
htmlAttributes5 C
)C D
;D E
} 	
} 
} øC
OE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Infrastructure\BaseController.cs
	namespace

 	
BayiPuan


 
.

 
MvcWebUi

 
.

 
Infrastructure

 *
{ 
public 
class	 
BaseController 
: 

Controller  *
{ 
	protected 
override 
void 
OnException '
(' (
ExceptionContext( 8
filterContext9 F
)F G
{ 
	Exception 
e 
= 
filterContext !
.! "
	Exception" +
;+ ,
var 	
logger
 
= 
new 
EventLoggerService )
() *
)* +
;+ ,
filterContext 
. 
ExceptionHandled $
=% &
true' +
;+ ,
if 
(	 

e
 
is !
NotificationException $
)$ %
{ 
logger 
. 
Info 
( 
filterContext !
.! "
	Exception" +
.+ ,
Message, 3
)3 4
;4 5
filterContext 
. 
Result 
= 
new "

ViewResult# -
{ 	
TempData
 
= 
new 
TempDataDictionary +
{ 
{ 
string  
.  !
Format! '
(' (
$str( K
,K L

NotifyTypeM W
.W X
ErrorX ]
)] ^
,^ _
e_ `
.` a
Messagea h
}i j
}   
,   
ViewData!!
 
=!! 
new!! 
ViewDataDictionary!! +
(!!+ ,
filterContext!!, 9
.!!9 :
Result!!: @
)!!@ A
}"" 	
;""	 

}## 
else$$ 

if$$ 
($$ 
e$$ 
is$$ 
SecurityException$$ %
)$$% &
{%% 
logger&& 
.&& 
Error&& 
(&& 
filterContext&& "
.&&" #
	Exception&&# ,
.&&, -
Message&&- 4
)&&4 5
;&&5 6
filterContext(( 
.(( 
Result(( 
=(( 
new(( "

ViewResult((# -
(((- .
)((. /
{)) 	
ViewName**
 
=** 
$str** "
,**" #
ViewData++
 
=++ 
new++ 
ViewDataDictionary++ +
(+++ ,
e++, -
)++- .
},, 	
;,,	 

}-- 
else.. 

{// 
logger00 
.00 
Error00 
(00 
filterContext00 "
.00" #
	Exception00# ,
.00, -
Message00- 4
)004 5
;005 6
filterContext22 
.22 
Result22 
=22 
new22 "

ViewResult22# -
(22- .
)22. /
{33 	
ViewName44
 
=44 
$str44 
,44 
ViewData55
 
=55 
new55 
ViewDataDictionary55 +
(55+ ,
e55, -
)55- .
}66 	
;66	 

}77 
}88 
public:: 

virtual:: 
string:: %
RenderPartialViewToString:: 3
(::3 4
)::4 5
{;; 
return<< %
RenderPartialViewToString<< &
(<<& '
null<<' +
,<<+ ,
null<<- 1
)<<1 2
;<<2 3
}== 
public?? 

virtual?? 
string?? %
RenderPartialViewToString?? 3
(??3 4
string??4 :
viewName??; C
)??C D
{@@ 
returnAA %
RenderPartialViewToStringAA &
(AA& '
viewNameAA' /
,AA/ 0
nullAA1 5
)AA5 6
;AA6 7
}BB 
publicDD 

virtualDD 
stringDD %
RenderPartialViewToStringDD 3
(DD3 4
objectDD4 :
modelDD; @
)DD@ A
{EE 
returnFF %
RenderPartialViewToStringFF &
(FF& '
nullFF' +
,FF+ ,
modelFF- 2
)FF2 3
;FF3 4
}GG 
publicII 

virtualII 
stringII %
RenderPartialViewToStringII 3
(II3 4
stringII4 :
viewNameII; C
,IIC D
objectIIE K
modelIIL Q
)IIQ R
{JJ 
ifLL 
(LL	 

stringLL
 
.LL 
IsNullOrEmptyLL 
(LL 
viewNameLL '
)LL' (
)LL( )
viewNameMM 
=MM 
thisMM 
.MM 
ControllerContextMM )
.MM) *
	RouteDataMM* 3
.MM3 4
GetRequiredStringMM4 E
(MME F
$strMMF N
)MMN O
;MMO P
thisOO 

.OO
 
ViewDataOO 
.OO 
ModelOO 
=OO 
modelOO !
;OO! "
usingQQ 
(QQ 
varQQ 
swQQ 
=QQ 
newQQ 
StringWriterQQ &
(QQ& '
)QQ' (
)QQ( )
{RR 
ViewEngineResultSS 

viewResultSS #
=SS$ %
SystemSS& ,
.SS, -
WebSS- 0
.SS0 1
MvcSS1 4
.SS4 5
ViewEnginesSS5 @
.SS@ A
EnginesSSA H
.SSH I
FindPartialViewSSI X
(SSX Y
thisTT 
.TT 
ControllerContextTT "
,TT" #
viewNameTT$ ,
)TT, -
;TT- .
varUU 
viewContextUU 
=UU 
newUU 
ViewContextUU )
(UU) *
thisUU* .
.UU. /
ControllerContextUU/ @
,UU@ A

viewResultUUB L
.UUL M
ViewUUM Q
,UUQ R
thisUUS W
.UUW X
ViewDataUUX `
,UU` a
thisUUb f
.UUf g
TempDataUUg o
,UUo p
swVV 
)VV 
;VV 

viewResultWW 
.WW 
ViewWW 
.WW 
RenderWW 
(WW 
viewContextWW *
,WW* +
swWW, .
)WW. /
;WW/ 0
returnYY 
swYY 
.YY 
GetStringBuilderYY "
(YY" #
)YY# $
.YY$ %
ToStringYY% -
(YY- .
)YY. /
;YY/ 0
}ZZ 
}[[ 
	protected]] 
virtual]] 
void]] 
SuccessNotification]] .
(]]. /
string]]/ 5
message]]6 =
,]]= >
bool]]? C$
persistForTheNextRequest]]D \
=]]] ^
true]]_ c
)]]c d
{^^ 
AddNotification__ 
(__ 

NotifyType__  
.__  !
Success__! (
,__( )
message__* 1
,__1 2$
persistForTheNextRequest__3 K
)__K L
;__L M
}`` 
	protectedbb 
virtualbb 
voidbb 
ErrorNotificationbb ,
(bb, -
stringbb- 3
messagebb4 ;
,bb; <
boolbb= A$
persistForTheNextRequestbbB Z
=bb[ \
truebb] a
)bba b
{cc 
AddNotificationdd 
(dd 

NotifyTypedd  
.dd  !
Errordd! &
,dd& '
messagedd( /
,dd/ 0$
persistForTheNextRequestdd1 I
)ddI J
;ddJ K
}ee 
	protectedgg 
virtualgg 
voidgg 
AddNotificationgg *
(gg* +

NotifyTypegg+ 5
typegg6 :
,gg: ;
stringgg< B
messageggC J
,ggJ K
boolggL P$
persistForTheNextRequestggQ i
)ggi j
{hh 
varii 	
dataKeyii
 
=ii 
$"ii *
NewGenFramework.notifications.ii 4
{ii4 5
typeii5 9
}ii9 :
"ii: ;
;ii; <
ifkk 
(kk	 
$
persistForTheNextRequestkk
 "
)kk" #
TempDatall 
[ll 
dataKeyll 
]ll 
=ll 
messagell #
;ll# $
elsemm 

ViewDatann 
[nn 
dataKeynn 
]nn 
=nn 
messagenn #
;nn# $
}oo 
}pp 
}qq û
XE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Infrastructure\MultipleButtonAttribute.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Infrastructure *
{ 
[ 
AttributeUsage 
( 
AttributeTargets $
.$ %
Method% +
,+ ,
AllowMultiple- :
=; <
false= B
,B C
	InheritedD M
=N O
trueP T
)T U
]U V
public 

class #
MultipleButtonAttribute (
:) *'
ActionNameSelectorAttribute+ F
{		 
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
Argument 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
override 
bool 
IsValidName (
(( )
ControllerContext) :
controllerContext; L
,L M
stringN T

actionNameU _
,_ `

MethodInfoa k

methodInfol v
)v w
{ 	
var 
isValidName 
= 
false #
;# $
var 
keyValue 
= 
$" 
{ 
Name "
}" #
:# $
{$ %
Argument% -
}- .
". /
;/ 0
var 
value 
= 
controllerContext )
.) *

Controller* 4
.4 5
ValueProvider5 B
.B C
GetValueC K
(K L
keyValueL T
)T U
;U V
if 
( 
value 
!= 
null 
) 
{ 
controllerContext !
.! "

Controller" ,
., -
ControllerContext- >
.> ?
	RouteData? H
.H I
ValuesI O
[O P
NameP T
]T U
=V W
ArgumentX `
;` a
isValidName 
= 
true "
;" #
} 
return 
isValidName 
; 
} 	
} 
} ≈
YE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Infrastructure\NinjectControllerFactory.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Infrastructure *
{ 
public		 

class		 $
NinjectControllerFactory		 )
:		* +$
DefaultControllerFactory		, D
{

 
private 
readonly 
IKernel  
_kernel! (
;( )
public $
NinjectControllerFactory '
(' (
)( )
{ 	
_kernel 
= 
new 
StandardKernel (
(( )
new) ,
ResolveModule- :
(: ;
); <
)< =
;= >
} 	
public 
IKernel 
Kernel 
{ 	
get 
{ 
return 
_kernel  
;  !
}" #
} 	
	protected 
override 
IController &!
GetControllerInstance' <
(< =
RequestContext= K
requestContextL Z
,Z [
Type\ `
controllerTypea o
)o p
{ 	
return 
controllerType !
==" $
null% )
?* +
null, 0
:1 2
(3 4
IController4 ?
)? @
_kernel@ G
.G H
GetH K
(K L
controllerTypeL Z
)Z [
;[ \
} 	
} 
} ®

GE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Localize\LanguageWord.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Localize $
{ 
public 

static 
class 
LanguageWord $
{ 
public 
static 
string 
Get  
(  !
string! '
word( ,
,, -
params. 4
object5 ;
[; <
]< =
args> B
)B C
{ 	
if 
( 
args 
!= 
null 
&& 
args  $
.$ %
Length% +
!=, .
$num/ 0
)0 1
return 
new 
LocalizedString *
(* +
string+ 1
.1 2
Format2 8
(8 9
word9 =
,= >
args? C
)C D
)D E
.E F
ToStringF N
(N O
)O P
;P Q
return		 
new		 
LocalizedString		 &
(		& '
word		' +
)		+ ,
.		, -
ToString		- 5
(		5 6
)		6 7
;		7 8
}

 	
} 
} ™
JE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Localize\LocalizedString.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Localize $
{ 
public 

class 
LocalizedString  
:! "
MarshalByRefObject# 5
{		 
private 
const 
string 
CacheNameKey )
=* +
$str, >
;> ?
private 
readonly 
string 
_word  %
;% &
public 
override 
string 
ToString '
(' (
)( )
{ 	
return 
_word 
; 
} 	
public 
LocalizedString 
( 
string %
code& *
)* +
{ 	
var 
languageWordService #
=$ %
DependencyResolver& 8
<8 9 
ILanguageWordService9 M
>M N
.N O
ResolveO V
(V W
)W X
;X Y
var 
languageService 
=  !
DependencyResolver" 4
<4 5
ILanguageService5 E
>E F
.F G
ResolveG N
(N O
)O P
;P Q
var   
culture   
=   
Thread    
.    !
CurrentThread  ! .
.  . /
CurrentUICulture  / ?
.  ? @
Name  @ D
;  D E
if!! 
(!! 
culture!! 
.!! 
Length!! 
<!!  
$num!!! "
)!!" #
culture"" 
="" 
culture"" !
.""! "
Replace""" )
("") *
culture""* 1
,""1 2
culture""3 :
+""; <
$str""= @
+""A B
culture""C J
.""J K
ToUpper""K R
(""R S
)""S T
)""T U
;""U V
var%% 
language%% 
=%% 
languageService%% *
.%%* +
Get%%+ .
(%%. /
culture%%/ 6
)%%6 7
;%%7 8
var&& 
data&& 
=&& 
languageWordService&& *
.&&* +
GetValue&&+ 3
(&&3 4
language&&4 <
.&&< =

LanguageId&&= G
,&&G H
code&&I M
)&&M N
;&&N O
_word(( 
=(( 
data(( 
!=(( 
null((  
?((! "
data((# '
.((' (
Value((( -
:((. /
code((0 4
;((4 5
})) 	
}** 
}++ –
HE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Localize\SetUserLocale.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Localize $
{ 
public 

class 
SetUserLocale 
{ 
public 
static 
void 
SetUserLocales )
() *
bool* .
SetUiCulture/ ;
); <
{ 	
HttpRequest 
Request 
=  !
HttpContext" -
.- .
Current. 5
.5 6
Request6 =
;= >
if 
( 
Request 
. 
UserLanguages %
==& (
null) -
)- .
return 
; 
string 
Lang 
= 
Request !
.! "
UserLanguages" /
[/ 0
$num0 1
]1 2
;2 3
if 
( 
Lang 
!= 
null 
) 
{ 
if 
( 
Lang 
. 

StartsWith #
(# $
$str$ (
)( )
)) *
return 
; 
if 
( 
Lang 
. 
Length 
<  !
$num" #
)# $
Lang 
= 
Lang 
+  !
$str" %
+& '
Lang( ,
., -
ToUpper- 4
(4 5
)5 6
;6 7
try 
{ 
System 
. 
Globalization (
.( )
CultureInfo) 4
Culture5 <
== >
new? B
SystemC I
.I J
GlobalizationJ W
.W X
CultureInfoX c
(c d
Langd h
)h i
;i j
System 
. 
	Threading $
.$ %
Thread% +
.+ ,
CurrentThread, 9
.9 :
CurrentCulture: H
=I J
CultureK R
;R S
if!! 
(!! 
SetUiCulture!! $
)!!$ %
System"" 
."" 
	Threading"" (
.""( )
Thread"") /
.""/ 0
CurrentThread""0 =
.""= >
CurrentUICulture""> N
=""O P
Culture""Q X
;""X Y
}## 
catch$$ 
{%% 
;%% 
}%% 
}&& 
}'' 	
}(( 
})) ú
FE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Localize\WebViewPage.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Localize $
{ 
public 

delegate 
LocalizedString #
	Localizer$ -
(- .
string. 4
	localized5 >
,> ?
params@ F
objectG M
[M N
]N O
argsP T
)T U
;U V
public 

abstract 
class 
WebViewBase %
:& '
WebViewPage( 3
<3 4
dynamic4 ;
>; <
{		 
}

 
public 

abstract 
class 
WebViewBase %
<% &
T& '
>' (
:) *
WebViewPage+ 6
<6 7
T7 8
>8 9
{ 
private 
	Localizer 

_localizer $
;$ %
public 
	Localizer 
Word 
{ 	
get 
{ 
return 

_localizer !
??" $
(% &

_localizer& 0
=1 2
(3 4
word4 8
,8 9

parameters: D
)D E
=>F H
{ 
if 
( 

parameters "
==# %
null& *
||+ -

parameters. 8
.8 9
Length9 ?
==@ B
$numC D
)D E
{ 
return 
new "
LocalizedString# 2
(2 3
word3 7
)7 8
;8 9
} 
return 
new 
LocalizedString .
(. /
string/ 5
.5 6
Format6 <
(< =
word= A
,A B

parametersC M
)M N
)N O
;O P
} 
) 
; 
} 
} 	
} 
} õ
TE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ComplexTypeModels\ViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #
ComplexTypeModels# 4
{ 
public 
class	 
	ViewModel 
{		 
public

 

IEnumerable

 
<

 
ProductPoint

 #
>

# $
totalWon

% -
{

. /
get

0 3
;

3 4
set

5 8
;

8 9
}

: ;
public 

decimal 
remainingScore !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

decimal !
remainingScoreToMoney (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 

IEnumerable 
< 

SpentPoint !
>! "

spentPoint# -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 

IEnumerable 
< 
SalesRanking #
># $
saleRankings% 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
public 

List 
< 
Campaign 
> 
CampaignView &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} Â
SE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\AnswerViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[		 
Table		 
(		 
$str		 
)		 
]		 
[

 
DisplayColumn

 
(

 
$str

 
)

 
]

 
[ 
DisplayName 
( 
$str 
) 
] 
public 
class 
AnswerViewModel 
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str 
, 
AutoGenerateField 0
=1 2
false3 8
)8 9
]9 :
public 
virtual 
int 
AnswerId 
{ 
get  
;  !
set" %
;% &
}' (
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required !
(! "
)" #
]# $
public 
virtual 
int 
KnowledgeTestId "
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 

ForeignKey 
( 
$str 
) 
] 
public 
virtual "
KnowledgeTestViewModel %
KnowledgeTest& 3
{3 4
get5 8
;8 9
set: =
;= >
}? @
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required &
(& '
)' (
]( )
public 
virtual 
int 
UserId 
{ 
get 
; 
set  #
;# $
}% &
[ 

ForeignKey 
( 
$str 
) 
] 
public 
virtual 
UserViewModel 
User !
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 
Display 
( 	
Name	 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 
virtual 
DateTime 

AnswerDate "
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required "
(" #
)# $
]$ %
public 
virtual 
bool 
ValidAnswer 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
}   ’
PE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\BuyViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{		 
[

 
Table

 
(

 	
$str

	 
)

 
]

 
[ 
DisplayColumn 
( 
$str 
) 
] 
[ 
DisplayName 
( 
$str  
)  !
]! "
public 
class	 
BuyViewModel 
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
, 
AutoGenerateField  1
=2 3
false4 9
)9 :
]: ;
public 

virtual 
int 
BuyId 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required '
(' (
)( )
]) *
public 

virtual 
int 
GiftId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
GiftViewModel  
Gift! %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
int 
UserId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
UserViewModel  
User! %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str )
)) *
,* +
Required, 4
(4 5
)5 6
]6 7
public 

virtual 
DateTime 
BuyDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
Display 
( 
Name 
= 
$str )
)) *
,* +
Required, 4
(4 5
)5 6
]6 7
public 

virtual 
int 
	BuyAmount  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 
Display 
( 
Name 
= 
$str #
)# $
,$ %
Required& .
(. /
)/ 0
]0 1
public   

virtual   
bool   

IsApproved   "
{  # $
get  % (
;  ( )
set  * -
;  - .
}  / 0
["" 
Display"" 
("" 
Name"" 
="" 
$str"" #
)""# $
,""$ %
Required""& .
("". /
)""/ 0
]""0 1
public## 

virtual## 
BuyState## 
BuyState## $
{##% &
get##' *
;##* +
set##, /
;##/ 0
}##1 2
}%% 
}&& Ç8
QE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\GiftViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[		 
Table		 
(		 	
$str			 
)		 
]		 
[

 
DisplayColumn

 
(

 
$str

 
)

 
]

  
[ 
DisplayName 
( 
$str 
) 
] 
public 
class	 
GiftViewModel 
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
, 
AutoGenerateField /
=0 1
false2 7
)7 8
]8 9
public 

virtual 
int 
GiftId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
Display 
( 
Name 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 

virtual 
int 

CategoryId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
CategoryViewModel $
Category% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required &
(& '
)' (
]( )
public 

virtual 
int 
BrandId 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
BrandViewModel !
Brand" '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 
Display 
( 
Name 
= 
$str $
)$ %
,% &
Required' /
(/ 0
)0 1
]1 2
public 

virtual 
string 
Usage 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
$str0 i
;i j
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required  (
(( )
)) *
]* +
public 

virtual 
string 
Coverage "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
$str3 N
;N O
[ 
Display 
( 
Name 
= 
$str '
)' (
,( )
Required* 2
(2 3
)3 4
]4 5
public 

virtual 
string 
ValidityPeriod (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
=7 8
$str9 {
;{ |
[ 
Display 
( 
Name 
= 
$str %
)% &
,& '
Required( 0
(0 1
)1 2
]2 3
public   

virtual   
string   
Indivisible   %
{  & '
get  ( +
;  + ,
set  - 0
;  0 1
}  2 3
=  4 5
$str  6 s
;  s t
[!! 
Display!! 
(!! 
Name!! 
=!! 
$str!! +
)!!+ ,
,!!, -
Required!!. 6
(!!6 7
)!!7 8
]!!8 9
public"" 

virtual"" 
string"" 
	Combining"" #
{""$ %
get""& )
;"") *
set""+ .
;"". /
}""0 1
=""2 3
$str""4 U
;""U V
[## 
Display## 
(## 
Name## 
=## 
$str## $
)##$ %
,##% &
Required##' /
(##/ 0
)##0 1
]##1 2
public$$ 

virtual$$ 
string$$ 
	TermOfUse$$ #
{$$$ %
get$$& )
;$$) *
set$$+ .
;$$. /
}$$0 1
=$$2 3
$str$$4 w
;$$w x
[%% 
Display%% 
(%% 
Name%% 
=%% 
$str%% *
)%%* +
,%%+ ,
Required%%- 5
(%%5 6
)%%6 7
]%%7 8
public&& 

virtual&& 
string&& 
Cancellation&& &
{&&' (
get&&) ,
;&&, -
set&&. 1
;&&1 2
}&&3 4
=&&5 6
$str&&7 e
;&&e f
['' 
Display'' 
('' 
Name'' 
='' 
$str'' 
)'' 
,'' 
Required'' '
(''' (
)''( )
]'') *
public(( 

virtual(( 
string(( 
Description(( %
{((& '
get((( +
;((+ ,
set((- 0
;((0 1
}((2 3
[)) 
Display)) 
()) 
Name)) 
=)) 
$str)) 
))) 
,)) 
Required)) %
())% &
)))& '
]))' (
public** 

virtual** 
int** 
	GiftPoint**  
{**! "
get**# &
;**& '
set**( +
;**+ ,
}**- .
[++ 
Display++ 
(++ 
Name++ 
=++ 
$str++ &
)++& '
]++' (
[,, 
DataType,, 
(,, 
DataType,, 
.,, 
Html,, 
),, 
],, 
[-- 
	AllowHtml-- 
]-- 
public.. 

virtual.. 
string.. 
Detail..  
{..! "
get..# &
;..& '
set..( +
;..+ ,
}..- .
[// 
Display// 
(// 
Name// 
=// 
$str// 
)//  
,//  !
Required//" *
(//* +
)//+ ,
]//, -
public00 

virtual00 
bool00 
IsActive00  
{00! "
get00# &
;00& '
set00( +
;00+ ,
}00- .
}33 
}44 ÷
VE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\GN_ReportViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[ 
DisplayColumn 
( 
$str  
)  !
]! "
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

	 
GN_ReportViewModel

 !
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str !
,! "
AutoGenerateField# 4
=5 6
false7 <
)< =
]= >
public 

virtual 
int 
ReportId 
{  !
get" %
;% &
set' *
;* +
}, -
[ 
Display 
( 
Name 
= 
$str !
)! "
," #
Required$ ,
(, -
)- .
]. /
public 

virtual 
string 
ReportTitle %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
string 
	ReportSql #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
Display 
( 
Name 
= 
$str "
)" #
]# $
public 

virtual 
string 
ReportFilter &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 
Display 
( 
Name 
= 
$str )
)) *
]* +
public 

virtual 
string 
ReportAuthorization -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} 
} Ç$
ZE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\KnowledgeTestViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[		 
Table		 
(		 
$str		 
)		 
]		 
[

 
DisplayColumn

 
(

 
$str

 
)

 
]

 
[ 
DisplayName 
( 
$str 
) 
] 
public 
class "
KnowledgeTestViewModel #
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str $
,$ %
AutoGenerateField& 7
=8 9
false: ?
)? @
]@ A
public 
virtual 
int 
KnowledgeTestId "
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required !
(! "
)" #
]# $
public 
virtual 
string 
Question 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required #
(# $
)$ %
]% &
public 
virtual 
string 
Answer1 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required #
(# $
)$ %
]% &
public 
virtual 
string 
Answer2 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required #
(# $
)$ %
]% &
public 
virtual 
string 
Answer3 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required #
(# $
)$ %
]% &
public 
virtual 
string 
Answer4 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required &
(& '
)' (
]( )
public 
virtual 
string 
ValidAnswerType %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 	
Name	 
= 
$str  
)  !
,! "
Required# +
(+ ,
), -
]- .
public 
virtual 
decimal 
Point 
{ 
get !
;! "
set# &
;& '
}( )
[   
Display   
(   	
Name  	 
=   
$str   
)   
,   
Required   "
(  " #
)  # $
]  $ %
public!! 
virtual!! 
DateTime!! 
KnowledgeDate!! %
{!!% &
get!!' *
;!!* +
set!!, /
;!!/ 0
}!!1 2
["" 
Display"" 
("" 	
Name""	 
="" 
$str"" 
)"" 
,"" 
Required"" &
(""& '
)""' (
]""( )
public## 
virtual## 
bool## 
IsActive## 
{## 
get## !
;##! "
set### &
;##& '
}##( )
}%% 
}&& ì
RE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\MyNewViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[		 
DisplayColumn		 
(		 
$str		 
)		 
]		 
[

 
DisplayName

 
(

 
$str

 
)

 
]

 
public 
class	 
MyNewViewModel 
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
,  
AutoGenerateField! 2
=3 4
false5 :
): ;
]; <
public 

virtual 
int 
NewsId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required '
(' (
)( )
]) *
public 

virtual 
string 
NewsName "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str 
) 
] 
[ 
DataType 
( 
DataType 
. 
Upload 
) 
] 
public 

virtual 
byte 
[ 
] 
	NewsImage #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str $
)$ %
]% &
[ 
	MaxLength 
( 
$num 
) 
] 
public 

virtual 
string 
NewsImageExt &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required &
(& '
)' (
]( )
public 

virtual 
string 
Description %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str  
)  !
,! "
Required# +
(+ ,
), -
]- .
public 

virtual 
NewsType 
NewsType $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
bool 
IsActive  
{! "
get# &
;& '
set( +
;+ ,
}- .
}!! 
}"" ≥
VE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\MyProductViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
]  
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

	 
MyProductViewModel

 !
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str $
,$ %
AutoGenerateField& 7
=8 9
false: ?
)? @
]@ A
public 

virtual 
int 
MyProductId "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 
Display 
( 
Name 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 

virtual 
string 
ProductName %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str 
) 
] 
[ 
DataType 
( 
DataType 
. 
Upload 
) 
] 
public 

virtual 
byte 
[ 
] 
MyProductImage (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str $
)$ %
]% &
[ 
	MaxLength 
( 
$num 
) 
] 
public 

virtual 
string 
MyProductImageExt +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
[ 
Display 
( 
Name 
= 
$str !
)! "
," #
Required$ ,
(, -
)- .
]. /
public 

virtual 
string 
Description %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
bool 
IsActive  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} Û4
[E:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\NotApproveSaleViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[		 
DisplayColumn		 
(		 
$str		 
)		 
]		 
[

 
DisplayName

 
(

 
$str

 
)

 
]

  
public 
class	 #
NotApproveSaleViewModel &
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
,  
AutoGenerateField! 2
=3 4
false5 :
): ;
]; <
public 

virtual 
int 
SaleId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required  (
(( )
)) *
]* +
public 

virtual 
int 

CustomerId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
CustomerViewModel $
Customer% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
string 
	InvoiceNo #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
Display 
( 
Name 
= 
$str #
)# $
,$ %
Required& .
(. /
)/ 0
]0 1
public 

virtual 
decimal 
InvoiceTotal '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str $
)$ %
,% &
Required' /
(/ 0
)0 1
]1 2
[ 
DataType 
( 
DataType 
. 
Upload 
) 
] 
public 

virtual 
byte 
[ 
] 
InvoiceImage &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str J
)J K
]K L
[ 
	MaxLength 
( 
$num 
) 
] 
public   

virtual   
string   
InvoiceImageExt   )
{  * +
get  , /
;  / 0
set  1 4
;  4 5
}  6 7
[!! 
Display!! 
(!! 
Name!! 
=!! 
$str!! 
)!! 
,!! 
Required!! %
(!!% &
)!!& '
]!!' (
public"" 

virtual"" 
int"" 
	ProductId""  
{""! "
get""# &
;""& '
set""( +
;""+ ,
}""- .
[## 

ForeignKey## 
(## 
$str## 
)## 
]## 
public$$ 

virtual$$ 
ProductViewModel$$ #
Product$$$ +
{$$, -
get$$. 1
;$$1 2
set$$3 6
;$$6 7
}$$8 9
[%% 
Display%% 
(%% 
Name%% 
=%% 
$str%% #
)%%# $
,%%$ %
Required%%& .
(%%. /
)%%/ 0
]%%0 1
public&& 

virtual&& 
int&& 
AmountOfSales&& $
{&&% &
get&&' *
;&&* +
set&&, /
;&&/ 0
}&&1 2
['' 
Display'' 
('' 
Name'' 
='' 
$str'' 
)'' 
,'' 
Required'' '
(''' (
)''( )
]'') *
public(( 

virtual(( 
int(( 
UserId(( 
{(( 
get((  #
;((# $
set((% (
;((( )
}((* +
[)) 

ForeignKey)) 
()) 
$str)) 
))) 
])) 
public** 

virtual** 
UserViewModel**  
User**! %
{**& '
get**( +
;**+ ,
set**- 0
;**0 1
}**2 3
[++ 
Display++ 
(++ 
Name++ 
=++ 
$str++ #
)++# $
,++$ %
Required++& .
(++. /
)++/ 0
]++0 1
public,, 

virtual,, 
DateTime,, 
InvoiceDate,, '
{,,( )
get,,* -
;,,- .
set,,/ 2
;,,2 3
},,4 5
[-- 
Display-- 
(-- 
Name-- 
=-- 
$str-- #
)--# $
,--$ %
Required--& .
(--. /
)--/ 0
]--0 1
public.. 

bool.. 
NotApproved.. 
{.. 
get.. !
;..! "
set..# &
;..& '
}..( )
[// 
Display// 
(// 
Name// 
=// 
$str// +
)//+ ,
,//, -
Required//- 5
(//5 6
)//6 7
]//7 8
[00 
	MaxLength00 
(00 
$num00 
)00 
]00 
public11 

virtual11 
string11 
Reason11  
{11! "
get11# &
;11& '
set11( +
;11+ ,
}11- .
}33 
}44 à
RE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\BrandViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 
$str 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
] 
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

 
BrandViewModel

 
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str 
, 
AutoGenerateField /
=0 1
false2 7
)7 8
]8 9
public 
virtual 
int 
BrandId 
{ 
get 
;  
set! $
;$ %
}& '
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required &
(& '
)' (
]( )
public 
virtual 
string 
	BrandName 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 	
Name	 
= 
$str 
) 
] 
[ 
DataType 	
(	 

DataType
 
. 
Upload 
) 
] 
public 
virtual 
byte 
[ 
] 

BrandImage  
{  !
get" %
;% &
set' *
;* +
}, -
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 	
Name	 
= 
$str  
)  !
]! "
[ 
	MaxLength 

(
 
$num 
) 
] 
public 
virtual 
string 
BrandImageExt #
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} æ
UE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\CampaignViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[ 
DisplayColumn 
( 
$str 
)  
]  !
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

	 
CampaignViewModel

  
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str #
,# $
AutoGenerateField% 6
=7 8
false9 >
)> ?
]? @
public 

virtual 
int 

CampaignId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 
Display 
( 
Name 
= 
$str "
)" #
,# $
Required% -
(- .
). /
]/ 0
public 

virtual 
string 
CampaignName &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str 
) 
] 
[ 
DataType 
( 
DataType 
. 
Upload 
) 
] 
public 

virtual 
byte 
[ 
] 
CampaignImage '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str $
)$ %
]% &
[ 
	MaxLength 
( 
$num 
) 
] 
public 

virtual 
string 
CampaignImageExt *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
} Â
UE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\CategoryViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[		 
DisplayColumn		 
(		 
$str		 
)		  
]		  !
[

 
DisplayName

 
(

 
$str

 
)

 
]

 
public 
class	 
CategoryViewModel  
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str #
,# $
AutoGenerateField% 6
=7 8
false9 >
)> ?
]? @
public 

virtual 
int 

CategoryId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 
Display 
( 
Name 
= 
$str "
)" #
,# $
Required% -
(- .
). /
]/ 0
public 

virtual 
string 
CategoryName &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} ’
QE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\CityViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
] 
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

	 
CityViewModel

 
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
,  
AutoGenerateField! 2
=3 4
false5 :
): ;
]; <
public 

virtual 
int 
CityId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
string 
CityName "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ·
UE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\CustomerViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[		 
Table		 
(		 	
$str			 
)		 
]		 
[

 
DisplayColumn

 
(

 
$str

 
)

  
]

  !
[ 
DisplayName 
( 
$str 
) 
] 
public 
class	 
CustomerViewModel  
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str #
,# $
AutoGenerateField% 6
=7 8
false9 >
)> ?
]? @
public 

virtual 
int 

CustomerId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 
Display 
( 
Name 
= 
$str "
)" #
,# $
Required% -
(- .
). /
]/ 0
public 

virtual 
string 
CustomerName &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 
Display 
( 
Name 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 

virtual 
string 
TaxNo 
{  !
get" %
;% &
set' *
;* +
}, -
[ 
Display 
( 
Name 
= 
$str #
)# $
,$ %
Required& .
(. /
)/ 0
]0 1
public 

virtual 
string 
TaxAdministration +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
[ 
Display 
( 
Name 
= 
$str &
)& '
,' (
Required) 1
(1 2
)2 3
]3 4
public 

virtual 
string  
RelationalPersonName .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
[ 
Display 
( 
Name 
= 
$str )
)) *
,* +
Required, 4
(4 5
)5 6
]6 7
public 

virtual 
string #
RelationalPersonSurname 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
[ 
Display 
( 
Name 
= 
$str *
)* +
,+ ,
Required- 5
(5 6
)6 7
]7 8
public 

virtual 
string 
MobilePhone %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
}## 
}$$ π
UE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\LanguageViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 
$str 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
] 
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

 
LanguageViewModel

 
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str 
,  
AutoGenerateField! 2
=3 4
false5 :
): ;
]; <
public 
virtual 
int 

LanguageId 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required !
(! "
)" #
]# $
public 
virtual 
string 
Name 
{ 
get 
;  
set! $
;$ %
}& '
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required !
(! "
)" #
]# $
public 
virtual 
string 
Code 
{ 
get 
;  
set! $
;$ %
}& '
} 
} À
YE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\LanguageWordViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 
$str 
) 
] 
[		 
DisplayColumn		 
(		 
$str		 !
)		! "
]		" #
[

 
DisplayName

 
(

 
$str

 
)

 
]

 
public 
class !
LanguageWordViewModel "
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str 
, 
AutoGenerateField *
=+ ,
false- 2
)2 3
]3 4
public 
virtual 
int 
Id 
{ 
get 
; 
set 
;  
}! "
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required '
(' (
)( )
]) *
public 
virtual 
int 

LanguageId 
{ 
get "
;" #
set$ '
;' (
}) *
[ 

ForeignKey 
( 
$str 
) 
] 
public 
virtual 
LanguageViewModel  
Language! )
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required !
(! "
)" #
]# $
public 
virtual 
string 
Code 
{ 
get 
;  
set! $
;$ %
}& '
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required "
(" #
)# $
]$ %
public 
virtual 
string 
Value 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ·&
TE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\ProductViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
]  
[ 
DisplayName 
( 
$str 
) 
] 
public		 
class			 
ProductViewModel		 
{

 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
, 
AutoGenerateField 0
=1 2
false3 8
)8 9
]9 :
public 

virtual 
int 
	ProductId  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
string 
ProductCode %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str $
)$ %
,% &
Required' /
(/ 0
)0 1
]1 2
public 

virtual 
string 
ProductShortCode *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
[ 
Display 
( 
Name 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 

virtual 
string 
ProductName %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required &
(& '
)' (
]( )
public 

virtual 
int 

UnitTypeId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
UnitTypeViewModel $
UnitType% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 
Display 
( 
Name 
= 
$str "
)" #
,# $
Required% -
(- .
). /
]/ 0
public 

virtual 
int 
StockAmount "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 
Display 
( 
Name 
= 
$str (
)( )
,) *
Required+ 3
(3 4
)4 5
]5 6
public 

virtual 
int  
RemainingStockAmount +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
[ 
Display 
( 
Name 
= 
$str *
)* +
,+ ,
Required- 5
(5 6
)6 7
]7 8
public 

virtual 
int 
CriticalStockAmount *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required %
(% &
)& '
]' (
public   

virtual   
decimal   
Point    
{  ! "
get  # &
;  & '
set  ( +
;  + ,
}  - .
[!! 
Display!! 
(!! 
Name!! 
=!! 
$str!! )
)!!) *
,!!* +
Required!!, 4
(!!4 5
)!!5 6
]!!6 7
public"" 

virtual"" 
decimal"" 
PointToMoney"" '
{""( )
get""* -
;""- .
set""/ 2
;""2 3
}""4 5
}$$ 
}%% Î
]E:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\RelationalPersonViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 
$str 
) 
] 
[ 
DisplayColumn 
( 
$str %
)% &
]& '
[		 
DisplayName		 
(		 
$str		 
)		  
]		  !
public

 
class

 %
RelationalPersonViewModel

 &
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str '
,' (
AutoGenerateField) :
=; <
false= B
)B C
]C D
public 
virtual 
int 
RelationalPersonId %
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 
Display 
( 	
Name	 
= 
$str &
)& '
,' (
Required) 1
(1 2
)2 3
]3 4
public 
virtual 
string  
RelationalPersonName *
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
[ 
Display 
( 	
Name	 
= 
$str )
)) *
,* +
Required, 4
(4 5
)5 6
]6 7
public 
virtual 
string #
RelationalPersonSurname -
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required  (
(( )
)) *
]* +
public 
virtual 
string 
MobilePhone !
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} ¡
QE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\RoleViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 
$str 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
] 
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

 
RoleViewModel

 
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str 
, 
AutoGenerateField .
=/ 0
false1 6
)6 7
]7 8
public 
virtual 
int 
RoleId 
{ 
get 
; 
set  #
;# $
}% &
[ 
Display 
( 	
Name	 
= 
$str 
) 
, 
Required %
(% &
)& '
]' (
public 
virtual 
string 
RoleName 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ¶1
XE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\ApproveSaleViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[		 
Table		 
(		 	
$str			 
)		 
]		 
[

 
DisplayColumn

 
(

 
$str

 
)

 
]

 
[ 
DisplayName 
( 
$str 
) 
] 
public 
class	  
ApproveSaleViewModel #
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
, 
AutoGenerateField  1
=2 3
false4 9
)9 :
]: ;
public 

virtual 
int 
SaleId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required  (
(( )
)) *
]* +
public 

virtual 
int 

CustomerId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
CustomerViewModel $
Customer% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
string 
	InvoiceNo #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
Display 
( 
Name 
= 
$str #
)# $
,$ %
Required& .
(. /
)/ 0
]0 1
public 

virtual 
decimal 
InvoiceTotal '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str $
)$ %
,% &
Required' /
(/ 0
)0 1
]1 2
[ 
DataType 
( 
DataType 
. 
Upload 
) 
] 
public 

virtual 
byte 
[ 
] 
InvoiceImage &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str J
)J K
]K L
[   
	MaxLength   
(   
$num   
)   
]   
public!! 

virtual!! 
string!! 
InvoiceImageExt!! )
{!!* +
get!!, /
;!!/ 0
set!!1 4
;!!4 5
}!!6 7
["" 
Display"" 
("" 
Name"" 
="" 
$str"" 
)"" 
,"" 
Required"" %
(""% &
)""& '
]""' (
public## 

virtual## 
int## 
	ProductId##  
{##! "
get### &
;##& '
set##( +
;##+ ,
}##- .
[$$ 

ForeignKey$$ 
($$ 
$str$$ 
)$$ 
]$$ 
public%% 

virtual%% 
ProductViewModel%% #
Product%%$ +
{%%, -
get%%. 1
;%%1 2
set%%3 6
;%%6 7
}%%8 9
[&& 
Display&& 
(&& 
Name&& 
=&& 
$str&& #
)&&# $
,&&$ %
Required&&& .
(&&. /
)&&/ 0
]&&0 1
public'' 

virtual'' 
int'' 
AmountOfSales'' $
{''% &
get''' *
;''* +
set'', /
;''/ 0
}''1 2
[(( 
Display(( 
((( 
Name(( 
=(( 
$str(( 
)(( 
,(( 
Required(( '
(((' (
)((( )
](() *
public)) 

virtual)) 
int)) 
UserId)) 
{)) 
get))  #
;))# $
set))% (
;))( )
}))* +
[** 

ForeignKey** 
(** 
$str** 
)** 
]** 
public++ 

virtual++ 
UserViewModel++  
User++! %
{++& '
get++( +
;+++ ,
set++- 0
;++0 1
}++2 3
[,, 
Display,, 
(,, 
Name,, 
=,, 
$str,, #
),,# $
,,,$ %
Required,,& .
(,,. /
),,/ 0
],,0 1
public-- 

virtual-- 
DateTime-- 
InvoiceDate-- '
{--( )
get--* -
;--- .
set--/ 2
;--2 3
}--4 5
[.. 
Display.. 
(.. 
Name.. 
=.. 
$str.. #
)..# $
,..$ %
Required..% -
(..- .
)... /
]../ 0
public// 

virtual// 
bool// 

IsApproved// "
{//# $
get//% (
;//( )
set//* -
;//- .
}/// 0
}22 
}33 ∑)
QE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\SaleViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[		 
Table		 
(		 	
$str			 
)		 
]		 
[

 
DisplayColumn

 
(

 
$str

 
)

 
]

 
[ 
DisplayName 
( 
$str 
) 
] 
public 
class	 
SaleViewModel 
: 
IEntity $
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
, 
AutoGenerateField  1
=2 3
false4 9
)9 :
]: ;
public 

virtual 
int 
SaleId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required  (
(( )
)) *
]* +
public 

virtual 
int 

CustomerId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
CustomerViewModel $
Customer% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
string 
	InvoiceNo #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
Display 
( 
Name 
= 
$str #
)# $
,$ %
Required& .
(. /
)/ 0
]0 1
public 

virtual 
decimal 
InvoiceTotal '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 
ScaffoldColumn 
( 
false 
) 
] 
[ 
Display 
( 
Name 
= 
$str $
)$ %
,% &
Required' /
(/ 0
)0 1
]1 2
[ 
DataType 
( 
DataType 
. 
Upload 
) 
] 
public 

virtual 
byte 
[ 
] 
InvoiceImage &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 
ScaffoldColumn 
( 
false 
) 
] 
[   
Display   
(   
Name   
=   
$str   J
)  J K
]  K L
[!! 
	MaxLength!! 
(!! 
$num!! 
)!! 
]!! 
public"" 

virtual"" 
string"" 
InvoiceImageExt"" )
{""* +
get"", /
;""/ 0
set""1 4
;""4 5
}""6 7
[## 
Display## 
(## 
Name## 
=## 
$str## 
)## 
,## 
Required## %
(##% &
)##& '
]##' (
public$$ 

virtual$$ 
int$$ 
	ProductId$$  
{$$! "
get$$# &
;$$& '
set$$( +
;$$+ ,
}$$- .
[%% 

ForeignKey%% 
(%% 
$str%% 
)%% 
]%% 
public&& 

virtual&& 
ProductViewModel&& #
Product&&$ +
{&&, -
get&&. 1
;&&1 2
set&&3 6
;&&6 7
}&&8 9
['' 
Display'' 
('' 
Name'' 
='' 
$str'' #
)''# $
,''$ %
Required''& .
(''. /
)''/ 0
]''0 1
public(( 

virtual(( 
int(( 
AmountOfSales(( $
{((% &
get((' *
;((* +
set((, /
;((/ 0
}((1 2
[-- 
Display-- 
(-- 
Name-- 
=-- 
$str-- #
)--# $
,--$ %
Required--& .
(--. /
)--/ 0
]--0 1
public.. 

virtual.. 
DateTime.. 
InvoiceDate.. '
{..( )
get..* -
;..- .
set../ 2
;..2 3
}..4 5
}// 
}00 ‰
RE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\ScoreViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[		 
DisplayColumn		 
(		 
$str		 
)		 
]		 
[

 
DisplayName

 
(

 
$str

 
)

 
]

 
public 
class	 
ScoreViewModel 
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str  
,  !
AutoGenerateField" 3
=4 5
false6 ;
); <
]< =
public 

virtual 
int 
ScoreId 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 
Display 
( 
Name 
= 
$str $
)$ %
,% &
Required' /
(/ 0
)0 1
]1 2
public 

virtual 
decimal 

ScoreTotal %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
	ScoreType 
	ScoreType &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
int 
UserId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
UserViewModel  
User! %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
} ˝
SE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\SellerViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
] 
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

	 
SellerViewModel

 
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str !
,! "
AutoGenerateField# 4
=5 6
false7 <
)< =
]= >
public 

virtual 
int 
SellerId 
{  !
get" %
;% &
set' *
;* +
}, -
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
int 

UserTypeId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
UserTypeViewModel $
UserType% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 
Display 
( 
Name 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 

virtual 
string 

SellerName $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required &
(& '
)' (
]( )
public 

virtual 
int 
CityId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
CityViewModel  
City! %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
Display 
( 
Name 
= 
$str 
)  
,  !
Required" *
(* +
)+ ,
], -
public 

virtual 
string 

SellerCode $
{% &
get' *
;* +
set, /
;/ 0
}1 2
}!! 
}"" Î
XE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\TopCategoryViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 	
$str	 
) 
] 
[ 
DisplayColumn 
( 
$str 
)  
]  !
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

	  
TopCategoryViewModel

 #
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str #
,# $
AutoGenerateField% 6
=7 8
false9 >
)> ?
]? @
public 

virtual 
int 

CategoryId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 
Display 
( 
Name 
= 
$str "
)" #
,# $
Required% -
(- .
). /
]/ 0
public 

virtual 
string 
CategoryName &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} —
UE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\UnitTypeViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 
$str 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
] 
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

 
UnitTypeViewModel

 
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str 
,  
AutoGenerateField! 2
=3 4
false5 :
): ;
]; <
public 
virtual 
int 

UnitTypeId 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
Display 
( 	
Name	 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 
virtual 
string 
UnitTypeName "
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ˘
UE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\UserRoleViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[		 
Table		 
(		 
$str		 
)		 
]		 
[

 
DisplayColumn

 
(

 
$str

 
)

 
]

 
[ 
DisplayName 
( 
$str 
) 
] 
public 
class 
UserRoleViewModel 
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption 1
.1 2
Identity2 :
): ;
]; <
[ 
Display 

(
 
Name 
= 
$str 
,  
AutoGenerateField! 2
=3 4
false5 :
): ;
]; <
public 
virtual	 
int 

UserRoleId 
{  !
get" %
;% &
set' *
;* +
}, -
[ 
Display 

(
 
Name 
= 
$str 
) 
, 
Required #
(# $
)$ %
]% &
public 
virtual	 
int 
UserId 
{ 
get !
;! "
set# &
;& '
}( )
[ 

ForeignKey 
( 
$str 
) 
] 
public 
virtual	 
UserViewModel 
User #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
Display 

(
 
Name 
= 
$str 
) 
, 
Required #
(# $
)$ %
]% &
public 
virtual	 
int 
RoleId 
{ 
get !
;! "
set# &
;& '
}( )
[ 

ForeignKey 
( 
$str 
) 
] 
public 
virtual	 
RoleViewModel 
Role #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} —
UE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\UserTypeViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[ 
Table 
( 
$str 
) 
] 
[ 
DisplayColumn 
( 
$str 
) 
] 
[		 
DisplayName		 
(		 
$str		 
)		 
]		 
public

 
class

 
UserTypeViewModel

 
{ 
[ 
Key 
, 
DatabaseGenerated 
( #
DatabaseGeneratedOption /
./ 0
Identity0 8
)8 9
]9 :
[ 
Display 
( 	
Name	 
= 
$str 
,  
AutoGenerateField! 2
=3 4
false5 :
): ;
]; <
public 
virtual 
int 

UserTypeId 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
Display 
( 	
Name	 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 
virtual 
string 
UserTypeName "
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ∂-
QE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Models\ViewModels\UserViewModel.cs
	namespace 	
BayiPuan
 
. 
MvcWebUi 
. 
Models "
." #

ViewModels# -
{ 
[		 
Table		 
(		 	
$str			 
)		 
]		 
[

 
DisplayColumn

 
(

 
$str

 
)

 
]

 
[ 
DisplayName 
( 
$str 
) 
] 
public 
class	 
UserViewModel 
{ 
[ 
Key 
, 	
DatabaseGenerated
 
( #
DatabaseGeneratedOption 3
.3 4
Identity4 <
)< =
]= >
[ 
Display 
( 
Name 
= 
$str 
,  
AutoGenerateField! 2
=3 4
false5 :
): ;
]; <
public 

virtual 
int 
UserId 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
Display 
( 
Name 
= 
$str 
) 
,  
Required! )
() *
)* +
]+ ,
public 

virtual 
int 

UserTypeId !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 

ForeignKey 
( 
$str 
) 
] 
public 

virtual 
UserTypeViewModel $
UserType% -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 
Display 
( 
Name 
= 
$str #
)# $
,$ %
Required& .
(. /
)/ 0
]0 1
public 

virtual 
string 
UserName "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required #
(# $
)$ %
]% &
public 

virtual 
string 
	FirstName #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required &
(& '
)' (
]( )
public 

virtual 
string 
LastName "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 
Display 
( 
Name 
= 
$str 
) 
, 
Required  (
(( )
)) *
]* +
public 

virtual 
string 
Email 
{  !
get" %
;% &
set' *
;* +
}, -
[ 
Display 
( 
Name 
= 
$str "
)" #
,# $
Required% -
(- .
). /
]/ 0
public 

virtual 
string 
MobilePhone %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[   
Display   
(   
Name   
=   
$str   "
)  " #
,  # $
Required  % -
(  - .
)  . /
]  / 0
public!! 

virtual!! 
DateTime!! 
	BirthDate!! %
{!!& '
get!!( +
;!!+ ,
set!!- 0
;!!0 1
}!!2 3
["" 
Display"" 
("" 
Name"" 
="" 
$str"" 
)"" 
,"" 
Required"" &
(""& '
)""' (
]""( )
public## 

virtual## 
bool## 
State## 
{## 
get##  #
;### $
set##% (
;##( )
}##* +
[$$ 
Display$$ 
($$ 
Name$$ 
=$$ 
$str$$ 
)$$ 
]$$ 
public%% 

virtual%% 
bool%% 
	Agreement%% !
{%%" #
get%%$ '
;%%' (
set%%) ,
;%%, -
}%%. /
[&& 
Display&& 
(&& 
Name&& 
=&& 
$str&& 
)&& 
,&& 
Required&& %
(&&% &
)&&& '
]&&' (
public'' 

virtual'' 
int'' 
SellerId'' 
{''  !
get''" %
;''% &
set''' *
;''* +
}'', -
[(( 

ForeignKey(( 
((( 
$str(( 
)(( 
](( 
public)) 

virtual)) 
SellerViewModel)) "
Seller))# )
{))* +
get)), /
;))/ 0
set))1 4
;))4 5
}))6 7
[++ 
Display++ 
(++ 
Name++ 
=++ 
$str++ 
)++ 
]++  
public,, 

virtual,, 
bool,, 
Contact,, 
{,,  !
get,," %
;,,% &
set,,' *
;,,* +
},,, -
}.. 
}// ©
IE:\src\NewGenSource\BayiPuan\BayiPuan.MvcWebUi\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str ,
), -
]- .
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[ 
assembly 	
:	 
!
AssemblyConfiguration  
(  !
$str! #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str .
). /
]/ 0
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 

ExceptionLogAspect 
( 
typeof $
($ %
DatabaseLogger% 3
)3 4
,4 5 
AttributeTargetTypes6 J
=K L
$strM n
)n o
]o p
[ 
assembly 	
:	 

	LogAspect 
( 
typeof 
( 
DatabaseLogger *
)* +
,+ , 
AttributeTargetTypes- A
=B C
$strD e
)e f
]f g
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[&& 
assembly&& 	
:&&	 

AssemblyVersion&& 
(&& 
$str&& $
)&&$ %
]&&% &
['' 
assembly'' 	
:''	 

AssemblyFileVersion'' 
('' 
$str'' (
)''( )
]'') *